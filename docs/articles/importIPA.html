<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to use Ingenuity IPA enrichment results • multienrichjam</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use Ingenuity IPA enrichment results">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multienrichjam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.110.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/importClusterProfiler.html">Multienrichment with clusterProfiler</a></li>
    <li><a class="dropdown-item" href="../articles/importIPA.html">How to use Ingenuity IPA enrichment results</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Explanation</h6></li>
    <li><a class="dropdown-item" href="../articles/MemPlotConcepts.html">Mem Plot Concepts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/jmw86069/multienrichjam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="importIPA_files/kePrint-0.0.1/kePrint.js"></script><link href="importIPA_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to use Ingenuity IPA enrichment results</h1>
            
      
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/vignettes/importIPA.Rmd" class="external-link"><code>vignettes/importIPA.Rmd</code></a></small>
      <div class="d-none name"><code>importIPA.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jmw86069.github.io/multienrichjam/">multienrichjam</a></span><span class="op">)</span>;</span>
<span><span class="co">#&gt; </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jmw86069.github.io/jamba/" class="external-link">jamba</a></span><span class="op">)</span>;</span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jmw86069.github.io/colorjam/" class="external-link">colorjam</a></span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"stringsAsFactors"</span><span class="op">=</span><span class="cn">FALSE</span>, <span class="st">"warn"</span><span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>;</span></code></pre></div>
<div class="section level2">
<h2 id="import-ingenuity-ipa-data">Import Ingenuity IPA data<a class="anchor" aria-label="anchor" href="#import-ingenuity-ipa-data"></a>
</h2>
<p>This document describes steps recommended for using Ingenuity Pathway
Analysis (IPA) enrichment data.</p>
<p>Ingenuity IPA enrichment results should be exported from the IPA
app:</p>
<ul>
<li><p>Open an IPA pathway analysis result.</p></li>
<li><p>Click <code>"Export All"</code> at the top-right of the menu
bar.</p></li>
<li>
<p>Choose either “Text .txt” or “Excel”.</p>
<ul>
<li>The Excel file must be<code>.xlsx</code> format.</li>
</ul>
</li>
<li><p>Save each enrichment result to a separate file.</p></li>
</ul>
<p>This workflow demonstrates the import process using two IPA
enrichment files used by <a href="https://doi.org/10.1016/j.jaci.2018.11.043" class="external-link">Reese et al 2019</a>
<a href="https://doi.org/10.1016/j.jaci.2018.11.043" class="external-link uri">https://doi.org/10.1016/j.jaci.2018.11.043</a> to compare
enrichment results in newborns to older children.</p>
<div class="section level3">
<h3 id="import-ipa-data">Import IPA data<a class="anchor" aria-label="anchor" href="#import-ipa-data"></a>
</h3>
<p>To import an IPA text file, use <code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code>.
It works the same when importing Excel <code>.xlsx</code> format.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newborn_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>   <span class="st">"Newborns-IPA.txt"</span>,</span>
<span>   package<span class="op">=</span><span class="st">"multienrichjam"</span><span class="op">)</span>;</span>
<span><span class="va">newborn_dfl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importIPAenrichment.html">importIPAenrichment</a></span><span class="op">(</span><span class="va">newborn_txt</span><span class="op">)</span>;</span></code></pre></div>
<p>The result is a <code>list</code>, named by the IPA analysis. Each
element contains one <code>data.frame</code> with analysis results.
Shown below is a summary of results, with number of rows and columns,
created with <code><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">jamba::sdim()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">sdim</a></span><span class="op">(</span><span class="va">newborn_dfl</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;                            rows cols      class</span></span>
<span><span class="co">#&gt; Canonical Pathways          113    8 data.frame</span></span>
<span><span class="co">#&gt; Upstream Regulators         117    7 data.frame</span></span>
<span><span class="co">#&gt; Diseases and Bio Functions  444    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Functions                15    8 data.frame</span></span>
<span><span class="co">#&gt; Networks                      8    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Lists                    19    7 data.frame</span></span>
<span><span class="co">#&gt; Analysis Ready Molecules     41    3 data.frame</span></span></code></pre></div>
<p>In <code>multienrichjam</code>, you may want to analyze multiple IPA
analyses. The example below uses <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to import
multiple IPA files.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newborn_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>   <span class="st">"Newborns-IPA.txt"</span>,</span>
<span>   package<span class="op">=</span><span class="st">"multienrichjam"</span><span class="op">)</span>;</span>
<span><span class="va">olderchildren_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>   <span class="st">"OlderChildren-IPA.txt"</span>,</span>
<span>   package<span class="op">=</span><span class="st">"multienrichjam"</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">ipa_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Newborns<span class="op">=</span><span class="va">newborn_txt</span>,</span>
<span>   OlderChildren<span class="op">=</span><span class="va">olderchildren_txt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ipa_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ipa_files</span>, <span class="va">importIPAenrichment</span><span class="op">)</span>;</span></code></pre></div>
<p>A summary of the list of lists is shown below, using
<code><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">jamba::ssdim()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">ssdim</a></span><span class="op">(</span><span class="va">ipa_l</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; $Newborns</span></span>
<span><span class="co">#&gt;                            rows cols      class</span></span>
<span><span class="co">#&gt; Canonical Pathways          113    8 data.frame</span></span>
<span><span class="co">#&gt; Upstream Regulators         117    7 data.frame</span></span>
<span><span class="co">#&gt; Diseases and Bio Functions  444    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Functions                15    8 data.frame</span></span>
<span><span class="co">#&gt; Networks                      8    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Lists                    19    7 data.frame</span></span>
<span><span class="co">#&gt; Analysis Ready Molecules     41    3 data.frame</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OlderChildren</span></span>
<span><span class="co">#&gt;                            rows cols      class</span></span>
<span><span class="co">#&gt; Canonical Pathways          237    8 data.frame</span></span>
<span><span class="co">#&gt; Upstream Regulators         338    8 data.frame</span></span>
<span><span class="co">#&gt; Diseases and Bio Functions  500    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Functions               118    8 data.frame</span></span>
<span><span class="co">#&gt; Networks                     10    8 data.frame</span></span>
<span><span class="co">#&gt; Tox Lists                    36    7 data.frame</span></span>
<span><span class="co">#&gt; Analysis Ready Molecules    162    3 data.frame</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyze-ipa-enrichments-from-one-enrichment-test">Analyze IPA enrichments from one enrichment test<a class="anchor" aria-label="anchor" href="#analyze-ipa-enrichments-from-one-enrichment-test"></a>
</h3>
<p>IPA performs multiple types of analyis, and we recommend using one
type for multienrichjam, starting with “Canonical Pathways”.</p>
<p>Other data available for use:</p>
<ul>
<li>
<strong>“Canonical Pathways:</strong>: IPA curated pathways (most
common*).</li>
<li>
<strong>“Upstream Regulators”</strong>: IPA curated regulators that
are predicted to have ‘upstream’ effects in cell signaling.</li>
<li>
<strong>“Diseases and Bio Functions”</strong>: IPA curated
disease-associated pathways, which include category and sub-category
annotations.</li>
<li>
<strong>“Tox Functions”</strong>: IPA curated toxicity-associated
pathways, which also include category and sub-category annotations.</li>
</ul>
<p><strong>“Analysis Ready Molecules”</strong>: is a
<code>data.frame</code> that contains the IPA gene cross-reference,
which stores what <em>you</em> called a gene, and what <em>IPA</em>
recognized for their analysis.</p>
<ul>
<li>The default <code>revert_ipa_xref=TRUE</code> will convert IPA gene
symbol to <em>your</em> gene symbol as provided to IPA.</li>
<li>If you provided microarray or platform identifiers, such as
Affymetrix <code>'1007_s_at'</code> or Agilent
<code>'ID A_14_P109686'</code>, you may try
<code>revert_ipa_xref=FALSE</code>, which will retain the IPA gene
symbol.</li>
</ul>
<p>Extract ‘Canonical Pathways’ from each IPA result:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Take only the Ingenuity Canonical Pathways</span></span>
<span><span class="va">enrichList_canonical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ipa_l</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">i</span><span class="op">[[</span><span class="st">"Canonical Pathways"</span><span class="op">]</span><span class="op">]</span>;</span>
<span><span class="op">}</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">sdim</a></span><span class="op">(</span><span class="va">enrichList_canonical</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;               rows cols      class</span></span>
<span><span class="co">#&gt; Newborns       113    8 data.frame</span></span>
<span><span class="co">#&gt; OlderChildren  237    8 data.frame</span></span></code></pre></div>
<div class="section level4">
<h4 id="convert-to-enrichresult-optional">Convert to enrichResult (optional)<a class="anchor" aria-label="anchor" href="#convert-to-enrichresult-optional"></a>
</h4>
<p>Each <code>data.frame</code> can be converted to
<code>enrichResult</code>. It is not strictly necessary, but may be
useful to use with functions related to <code>clusterProfiler</code>,
for example <code><a href="https://rdrr.io/pkg/ggtangle/man/cnetplot.html" class="external-link">ggtangle::cnetplot()</a></code>.</p>
<p>This option may be useful to review the conversion.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Convert data.frame to enrichResult</span></span>
<span><span class="co">## multienrichjam::enrichDF2enrichResult</span></span>
<span><span class="va">er_canonical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">enrichList_canonical</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="fu"><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>      keyColname<span class="op">=</span><span class="st">"Name"</span>,</span>
<span>      pvalueColname<span class="op">=</span><span class="st">"P-value"</span>,</span>
<span>      geneColname<span class="op">=</span><span class="st">"geneNames"</span>,</span>
<span>      geneRatioColname<span class="op">=</span><span class="st">"Ratio"</span>,</span>
<span>      pvalueCutoff<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">sdim</a></span><span class="op">(</span><span class="va">er_canonical</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;               rows cols        class</span></span>
<span><span class="co">#&gt; Newborns       113   12 enrichResult</span></span>
<span><span class="co">#&gt; OlderChildren  237   12 enrichResult</span></span>
<span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/kable_coloring.html" class="external-link">kable_coloring</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">er_canonical</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   caption<span class="op">=</span><span class="st">"Top 10 rows of enrichment data"</span>,</span>
<span>   row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/column_spec.html" class="external-link">column_spec</a></span><span class="op">(</span>column<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">er_canonical</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      border_left<span class="op">=</span><span class="st">"1px solid #DDDDDD"</span>,</span>
<span>      extra_css<span class="op">=</span><span class="st">"white-space: nowrap;"</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Top 10 rows of enrichment data
</caption>
<thead><tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:left;">
Ingenuity Canonical Pathways
</th>
<th style="text-align:right;">
-log(p-value)
</th>
<th style="text-align:right;">
zScore
</th>
<th style="text-align:right;">
GeneRatio
</th>
<th style="text-align:left;">
geneID
</th>
<th style="text-align:right;">
pvalue
</th>
<th style="text-align:left;">
geneNames.ipa
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:right;">
p.adjust
</th>
<th style="text-align:right;">
Count
</th>
<th style="text-align:right;">
setSize
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Role of Macrophages, Fibroblasts and Endothelial Cells in Rheumatoid
Arthritis
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Role of Macrophages, Fibroblasts and Endothelial Cells in Rheumatoid
Arthritis
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.405
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00321
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
TNFSF13B
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3935501
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
TNFSF13B
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Role of Macrophages, Fibroblasts and Endothelial Cells in Rheumatoid
Arthritis
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3935501
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
312
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Neuroinflammation Signaling Pathway
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Neuroinflammation Signaling Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.406
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00322
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
CASP8
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3926449
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
CASP8
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Neuroinflammation Signaling Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3926449
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
311
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Sirtuin Signaling Pathway
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Sirtuin Signaling Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.428
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00344
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
HIST1H1D
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3732502
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
HIST1H1D
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Sirtuin Signaling Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3732502
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
291
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
G-Protein Coupled Receptor Signaling
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
G-Protein Coupled Receptor Signaling
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.447
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00362
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
PRKAR2B
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3572728
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
PRKAR2B
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
G-Protein Coupled Receptor Signaling
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3572728
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
276
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Protein Ubiquitination Pathway
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Protein Ubiquitination Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.461
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00377
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
TAP2
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3459394
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
TAP2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Protein Ubiquitination Pathway
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3459394
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
265
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Signaling by Rho Family GTPases
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Signaling by Rho Family GTPases
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.478
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
NaN
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.00397
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
RDX
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3326596
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
RDX
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Signaling by Rho Family GTPases
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
0.3326596
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
252
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="multienrichmap-to-create-mem">multiEnrichMap() to create ‘Mem’<a class="anchor" aria-label="anchor" href="#multienrichmap-to-create-mem"></a>
</h2>
<p>Now given a list of <code>data.frame</code> results, we can run
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mem_canonical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiEnrichMap.html">multiEnrichMap</a></span><span class="op">(</span><span class="va">er_canonical</span>,</span>
<span>   enrichBaseline<span class="op">=</span><span class="fl">1</span>,</span>
<span>   p_cutoff<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>   topEnrichN<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Output is a <code>list</code> containing summary results.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://jmw86069.github.io/jamba/reference/kable_coloring.html" class="external-link">kable_coloring</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://jmw86069.github.io/jamba/reference/sdim.html" class="external-link">sdim</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span>,</span>
<span>   caption<span class="op">=</span><span class="st">"sdim(mem_canonical)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/column_spec.html" class="external-link">column_spec</a></span><span class="op">(</span>column<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>      border_left<span class="op">=</span><span class="st">"1px solid #DDDDDD"</span>,</span>
<span>      extra_css<span class="op">=</span><span class="st">"white-space: nowrap;"</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
sdim(mem_canonical)
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
rows
</th>
<th style="text-align:left;">
cols
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
class_v2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichList
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
list
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichLabels
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
character
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
colorV
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
character
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
geneHitList
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
list
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
geneHitIM
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
68
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
memIM
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
22
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
geneIM
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
22
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichIM
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
multiEnrichDF
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
data.frame
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
multiEnrichResult
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
13
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichResult
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
thresholds
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
6
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
list
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
headers
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
9
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
list
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichIMcolors
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichIMdirection
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
enrichIMgeneCount
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
11
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
geneIMcolors
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
22
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
geneIMdirection
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
22
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
2
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
matrix
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
array
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
.__classVersion__
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
1
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;border-left:1px solid #DDDDDD;white-space: nowrap;">
Versions
</td>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
NA
</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="prepare_folio-to-create-memplotfolio">prepare_folio() to create ‘MemPlotFolio’<a class="anchor" aria-label="anchor" href="#prepare_folio-to-create-memplotfolio"></a>
</h3>
<p>The next step is to prepare the “Mem Plot Folio”, which performs key
pathway clustering to inform downstream visualizations.</p>
<ul>
<li>
<code><a href="../reference/mem_plot_folio.html">prepare_folio()</a></code> prepares a ‘MemPlotFolio’ object</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> prepares <em>and plots</em>
‘MemPlotFolio’ as multi-page output.</li>
</ul>
<p>The plot data is created and stored in the ‘MemPlotFolio’ object, and
can be plotted directly using:</p>
<ul>
<li>
<code>EnrichmentHeatmap()</code>: pathway by enrichment, showing
enrichment P-values</li>
<li>
<code>GenePathHeatmap()</code>: genes by pathway, to define pathway
clusters</li>
<li>
<code>CnetCollapsed()</code>: Concept network (Cnet) collapsed by
pathway cluster</li>
<li>
<code>CnetExemplar()</code>: Cnet with one exemplar pathway per
cluster</li>
<li>
<code>CnetCollapsed()</code>: Cnet showing all pathways in one
cluster</li>
</ul>
<p>The example below shows the first four plots from
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem_plot_folio.html">mem_plot_folio</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   pathway_column_split<span class="op">=</span><span class="fl">4</span>,</span>
<span>   column_cex<span class="op">=</span><span class="fl">0.4</span>, row_cex<span class="op">=</span><span class="fl">0.4</span>,</span>
<span>   row_names_max_width<span class="op">=</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>   column_names_max_height<span class="op">=</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">2.5</span>,</span>
<span>   label_factor_l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nodeType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Set<span class="op">=</span><span class="fl">0.7</span>, Gene<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   do_which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>   main<span class="op">=</span><span class="st">"Canonical Pathways"</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem-folio-1.png" alt="Mem plot folio showing the first four plots" width="768" style="display: block; margin: auto;"><img src="importIPA_files/figure-html/mem-folio-2.png" alt="Mem plot folio showing the first four plots" width="768" style="display: block; margin: auto;"><img src="importIPA_files/figure-html/mem-folio-3.png" alt="Mem plot folio showing the first four plots" width="768" style="display: block; margin: auto;"><img src="importIPA_files/figure-html/mem-folio-4.png" alt="Mem plot folio showing the first four plots" width="768" style="display: block; margin: auto;"></p>
<p>The object <code>Mpf</code> is a <code>'MemPlotFolio'</code> object
containing graphical objects. By default all plots in
<code>do_which</code> are plotted, however they can be plotted
individually:</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-mem-plots">Customizing Mem Plots<a class="anchor" aria-label="anchor" href="#customizing-mem-plots"></a>
</h2>
<div class="section level3">
<h3 id="cnet-collapsed-plot">Cnet Collapsed Plot<a class="anchor" aria-label="anchor" href="#cnet-collapsed-plot"></a>
</h3>
<p>The Cnet Collapsed Plot is often the focus of manuscript figures. The
typical workflow is demonstrated below, using
<code>CnetCollapsed()</code> on the <code>MemPlotFolio</code>
object.</p>
<p>Note that ‘…’ extra arguments are passed to <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code>
for custom plotting options.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the data</span></span>
<span><span class="va">Mpf4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem_plot_folio.html">prepare_folio</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   do_which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the cnet</span></span>
<span><span class="va">cnet</span> <span class="op">&lt;-</span> <span class="fu">CnetCollapsed</span><span class="op">(</span><span class="va">Mpf4</span>,</span>
<span>   type<span class="op">=</span><span class="st">"set"</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   label_factor_l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nodeType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gene<span class="op">=</span><span class="fl">2</span>, Set<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/cnet-collapsed-1.png" alt="Cnet collapsed network extracted from mem_plot_folio() to use for custom figures." width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>   </span>
<span><span class="co">## jam_graph()</span></span>
<span><span class="co"># jam_igraph(cnet)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="enrichment-p-value-heatmap">Enrichment P-value Heatmap<a class="anchor" aria-label="anchor" href="#enrichment-p-value-heatmap"></a>
</h3>
<p>The recommended way to create an enrichment heatmap is to use
<code>EnrichmentHeatmap(Mpf)</code> with the <code>'MemPlotFolio'</code>
object. Customization should be done via <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code>,
for example changes to pathway clustering, and even custom font
sizes.</p>
<p>Additional options for a enrichment heatmap are described in the
internal function <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">EnrichmentHeatmap</span><span class="op">(</span><span class="va">Mpf</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/enrich-hm-mpf-1.png" alt="Enrichment heatmap shown using the MemPlotFolio object as input." width="960" style="display: block; margin: auto;"></p>
<p>Note that the Mem object can be plotted directly as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   p_cutoff<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/enrich-hm-1.png" alt="Enrichment heatmap shown as a dotplot to indicate the number of genes involved." width="960" style="display: block; margin: auto;"></p>
<p>The same data can be plotted as a heatmap.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   style<span class="op">=</span><span class="st">"heatmap"</span>,</span>
<span>   p_cutoff<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/enrich-hm-1-1.png" alt="Enrichment heatmap showing the heatmap style, without dot plot." width="960" style="display: block; margin: auto;"></p>
<p>Argument <code>color_by_column=TRUE</code> applies the color gradient
to each column, using <code>colorV</code> colors defined in from
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">memhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   style<span class="op">=</span><span class="st">"heatmap"</span>,</span>
<span>   color_by_column<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/enrich-hm-2-1.png" alt="Enrichment heatmap, colorized by column, showing an alternative style." width="960" style="display: block; margin: auto;"><img src="importIPA_files/figure-html/enrich-hm-2-2.png" alt="Enrichment heatmap, colorized by column, showing an alternative style." width="960" style="display: block; margin: auto;"></p>
<p>Any of these custom options can be passed to
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code>, so that the enrichment heatmap will
follow that custom style.</p>
</div>
<div class="section level3">
<h3 id="gene-pathway-heatmap">Gene-Pathway Heatmap<a class="anchor" aria-label="anchor" href="#gene-pathway-heatmap"></a>
</h3>
<p>The gene-pathway heatmap is the critical step in downstream analysis,
and is visualized with <code>GenePathHeatmap(Mpf)</code> using the
‘MemPlotFolio’ object.</p>
<p>Additional options for the gene-pathway heatmap are described in the
internal function <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>.</p>
<ul>
<li>Colors across the top of the heatmap indicate enrichment
P-values.</li>
<li>Colors on the left of the heatmap indicate which genes were present
in each enrichment test.</li>
<li>When directional gene hits are provided, the left of the heatmap
will also indicate directionality.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm_drawn</span> <span class="op">&lt;-</span> <span class="fu">GenePathHeatmap</span><span class="op">(</span><span class="va">Mpf</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem-hm-mpf-1.png" alt="Gene-pathway heatmap drawn specifically with mem_gene_path_heatmap()." width="960" style="display: block; margin: auto;"></p>
<p>You can pull out pathway clusters using <code>Clusters(Mpf)</code>,
and gene clusters using <code>GeneClusters(Mpf)</code>.</p>
<p>Alternatively, since <code>hm_drawn</code> is also a ComplexHeatmap
object, the row and column order can be interrogated using
<code><a href="https://jmw86069.github.io/jamba/reference/heatmap_column_order.html" class="external-link">jamba::heatmap_column_order()</a></code> for example.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jmw86069.github.io/jamba/reference/heatmap_column_order.html" class="external-link">heatmap_column_order</a></span><span class="op">(</span><span class="va">hm_drawn</span><span class="op">)</span>;</span>
<span><span class="va">hm_sets</span>;</span>
<span><span class="co">#&gt; $A</span></span>
<span><span class="co">#&gt;   Gluconeogenesis I        Glycolysis I </span></span>
<span><span class="co">#&gt; "Gluconeogenesis I"      "Glycolysis I" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $B</span></span>
<span><span class="co">#&gt;   Protein Kinase A Signaling </span></span>
<span><span class="co">#&gt; "Protein Kinase A Signaling" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $C</span></span>
<span><span class="co">#&gt;           Glioma Signaling   Growth Hormone Signaling </span></span>
<span><span class="co">#&gt;         "Glioma Signaling" "Growth Hormone Signaling" </span></span>
<span><span class="co">#&gt;        Hepatic Cholestasis    Fc Epsilon RI Signaling </span></span>
<span><span class="co">#&gt;      "Hepatic Cholestasis"  "Fc Epsilon RI Signaling" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $D</span></span>
<span><span class="co">#&gt;     mTOR Signaling     ERK5 Signaling    HIPPO signaling   p70S6K Signaling </span></span>
<span><span class="co">#&gt;   "mTOR Signaling"   "ERK5 Signaling"  "HIPPO signaling" "p70S6K Signaling"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="full-cnet-plot">Full Cnet plot<a class="anchor" aria-label="anchor" href="#full-cnet-plot"></a>
</h3>
<p>The complete Concept network (Cnet) plot shows every pathway-gene
relationship, and is performed using <code><a href="../reference/mem2cnet.html">mem2cnet()</a></code>.</p>
<p>Note that the pathways can be subset using <code>[</code> bracket
notation if relevant.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem2cnet.html">mem2cnet</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_par.html" class="external-link">with_par</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span>, <span class="op">{</span></span>
<span>   <span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">cnet</span>,</span>
<span>      use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>      node_factor<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>      vertex.label.cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>;</span>
<span>   <span class="fu"><a href="../reference/mem_legend.html">mem_legend</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span>;</span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/cnet-plot-1-1.png" alt="Full Cnet plot, for all pathways and genes." width="768" style="display: block; margin: auto;"></p>
<p>Extract the largest connected subnetwork.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnet_largest_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_igraph_components.html">subset_igraph_components</a></span><span class="op">(</span><span class="va">cnet</span>, keep<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">cnet_largest_sub</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   label_factor<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/cnet-plot-2-1.png" alt="Cnet plot showing the largest connected sub-network." width="768" style="display: block; margin: auto;"></p>
<div class="section level5">
<h5 id="subset-cnet-by-cluster">Subset Cnet by Cluster<a class="anchor" aria-label="anchor" href="#subset-cnet-by-cluster"></a>
</h5>
<p>Subset the pathway nodes with <code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code>, using
<code>hm_sets</code> defined above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnet_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph</a></span><span class="op">(</span><span class="va">cnet</span>,</span>
<span>   repulse<span class="op">=</span><span class="fl">3.5</span>,</span>
<span>   includeSets<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">hm_sets</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">cnet_sub</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">1</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   label_dist_factor<span class="op">=</span><span class="fl">3</span>,</span>
<span>   label_factor<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="../reference/mem_legend.html">mem_legend</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/cnet-plot-1-custom-1.png" alt="Cnet plot showing a specific Cnet cluster." width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level5">
<h5 id="subset-cnet-options">Subset Cnet Options<a class="anchor" aria-label="anchor" href="#subset-cnet-options"></a>
</h5>
<p>Subset the pathway nodes with <code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code>, using
a custom subset of pathways.</p>
<p>Alternatively, subset by other network attributes:</p>
<ul>
<li>
<code>minSetDegree=6</code>: pathways with at least 6 genes</li>
<li>
<code>minGeneDegree=2</code>: genes present in 2 or more pathways
(not used here).</li>
</ul>
<p>Other useful defaults:</p>
<ul>
<li>
<code>remove_singlets=TRUE</code>: remove singlet nodes with no
connections.</li>
<li>
<code>force_relayout=TRUE</code>: re-calculated the layout.</li>
<li>
<code>do_reorder=TRUE</code>: re-order nodes by color.</li>
<li>
<code>spread_labels=TRUE</code>: re-position labels away from
incoming edges</li>
<li>
<code>remove_blanks=FALSE</code>: optionally remove blank colors
from pie nodes.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnet3</span> <span class="op">&lt;-</span> <span class="fu">multienrichjam</span><span class="fu">::</span><span class="fu"><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph</a></span><span class="op">(</span><span class="va">cnet</span>,</span>
<span>   repulse<span class="op">=</span><span class="fl">5</span>,</span>
<span>   minSetDegree<span class="op">=</span><span class="fl">6</span>,</span>
<span>   minGeneDegree<span class="op">=</span><span class="fl">1</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">cnet3</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="../reference/mem_legend.html">mem_legend</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="importIPA_files/figure-html/subnet-1.png" alt="Subset Cnet plot using a specific set of pathways." width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="multi-enrichment-map">Multi-Enrichment Map<a class="anchor" aria-label="anchor" href="#multi-enrichment-map"></a>
</h3>
<p>The “Multi Enrichment Map” itself can be view using
<code><a href="../reference/mem2emap.html">mem2emap()</a></code>.</p>
<p>This network connects pathways when they meet a Jaccard overlap
coefficient threshold based upon the shared genes between the
pathways.</p>
<p>The default <code>0.2</code> is stored in the ‘Mem’ object
<code>mem_canonical</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">emap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem2emap.html">mem2emap</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">emap</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"overlap=0.2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem-plot-1-1.png" alt="Multi-enrichment network creating using mem2emap(), using the default overlap threshold 0.2." width="960" style="display: block; margin: auto;"></p>
<p>You can provide the Jaccard overlap threshold directly, with argument
<code>overlap</code>. Values should be between 0 and 1.</p>
<p>A reasonable threshold can be estimated with
<code><a href="../reference/mem_find_overlap.html">mem_find_overlap()</a></code>, which determines an intermediate level
of connectivity, and should be a solid starting point for future
adjustments.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">use_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem_find_overlap.html">mem_find_overlap</a></span><span class="op">(</span><span class="va">mem_canonical</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">emap2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mem2emap.html">mem2emap</a></span><span class="op">(</span><span class="va">mem_canonical</span>,</span>
<span>   overlap<span class="op">=</span><span class="va">use_overlap</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">emap2</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">3</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"overlap="</span>, <span class="va">use_overlap</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem-plot-1b-1.png" alt="Multi-enrichment network shown after using alternative overlap threshold." width="960" style="display: block; margin: auto;"></p>
<p>Notice there are distinct subnetworks, called “components”, which are
not connected to each other.</p>
<p>You can pull out a component with
<code><a href="../reference/subset_igraph_components.html">subset_igraph_components()</a></code>. Components are ordered by size,
largest to smallest, so you can keep the largest using argument
<code>keep=1</code>, or the second largest with <code>keep=2</code>, and
so on.</p>
<p>We also call two other helper functions:</p>
<ol style="list-style-type: decimal">
<li>
<p><code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code></p>
<ul>
<li>removes blank colors from multi-color nodes, such as pie nodes, or
colored rectangle nodes.</li>
<li>It helps show only the remaining colors without the whitespace.</li>
</ul>
</li>
<li>
<p><code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code></p>
<ul>
<li>Fruchterman-Reingold layout, with argument <code>repulse</code> used
to adjust the spacing between nodes.</li>
<li>Also updates other useful attributes, and spreads the node labels to
reduce label overlaps.</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## You can alternatively pull out any other component</span></span>
<span><span class="va">g_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_igraph_components.html">subset_igraph_components</a></span><span class="op">(</span><span class="va">emap2</span>, keep<span class="op">=</span><span class="fl">1</span><span class="op">)</span>;</span>
<span></span>
<span><span class="co">## Re-apply network layout, and remove blank colors</span></span>
<span><span class="va">g_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relayout_with_qfr.html">relayout_with_qfr</a></span><span class="op">(</span>repulse<span class="op">=</span><span class="fl">3.5</span>,</span>
<span>   <span class="fu"><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks</a></span><span class="op">(</span><span class="va">g_sub</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot</span></span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">g_sub</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">3</span>,</span>
<span>   label_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem-plot-2-1.png" alt="Network plot showing the largest connected sub-network of the multi-enrichment network." width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="jam_igraph-to-plot-igraph">jam_igraph() to plot igraph<a class="anchor" aria-label="anchor" href="#jam_igraph-to-plot-igraph"></a>
</h2>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> is a customized
<code>igraph::plot()</code>, with benefits:</p>
<ul>
<li><p><code>edge_bundling="connections"</code> (default) improves the
rendering of edges by bundling edges from node clusters, so they are
drawn with a bezier curve</p></li>
<li><p><code>use_shadowText=TRUE</code> (optional) will draw labels with
a contrasting border to improve legibility of text labels</p></li>
<li><p><code>rescale=FALSE</code> (default) keeps the network layout
aspect ratio instead of scaling the coordinates to fit the size. of the
plot window. It also properly scales the node and edge sizes.</p></li>
<li>
<p>convenient resizing:</p>
<ul>
<li>
<code>label_factor</code>: adjusts <code>label.cex</code> by a
multiplier</li>
<li>
<code>node_factor</code>: adjusts <code>node.size</code> by a
multiplier</li>
<li>
<code>edge_factor</code>: adjusts <code>edge.width</code> by a
multiplier</li>
<li>
<code>label_dist_factor</code> re-scales the <code>label.dist</code>
values by a multiplier</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="simple-resizing">Simple resizing<a class="anchor" aria-label="anchor" href="#simple-resizing"></a>
</h3>
<p>Consider the following changes, demonstrated below:</p>
<ul>
<li>
<code>node_factor=2</code>: nodes 2x larger</li>
<li>
<code>edge_factor=2</code>: edges 2x wider</li>
<li>
<code>label_factor=1.2</code>: labels 20% larger</li>
<li>
<code>use_shadowText=TRUE</code>: shadow text labels</li>
<li>
<code>label_dist_factor=5</code>: label distance 5x farther from
node center</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">cnet3</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   edge_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   label_factor<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>   label_dist_factor<span class="op">=</span><span class="fl">5</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/jam-igraph-1-1.png" alt="Network plot created using jam_igraph() as an enhanced alternative to the default igraph plot function." width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="colored-edges">Colored edges<a class="anchor" aria-label="anchor" href="#colored-edges"></a>
</h3>
<p>Edges can be colorized using the colors of the connecting nodes, a
visual enhancement inspired by the Gephi network visualization tool.
This process is performed using <code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="fu"><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes</a></span><span class="op">(</span><span class="va">cnet3</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span>
<span>   edge_bundling<span class="op">=</span><span class="st">"connections"</span>,</span>
<span>   <span class="co"># edge_factor=2,</span></span>
<span>   <span class="co"># node_factor=2,</span></span>
<span>   label_factor<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>   label_dist_factor<span class="op">=</span><span class="fl">5</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="importIPA_files/figure-html/jam-igraph-2-1.png" alt="Network plot is shown using edges colorized based upon the colors for the connected nodes." width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="shinycat-for-custom-cnet-layout">ShinyCat for Custom Cnet Layout<a class="anchor" aria-label="anchor" href="#shinycat-for-custom-cnet-layout"></a>
</h2>
<p>The R-shiny Cnet Adjustment Tool <strong>ShinyCat</strong> is
intended to help polish the Cnet plot layout when making a final
figure.</p>
<p>The R-shiny app uses several functions:</p>
<ul>
<li>
<code><a href="../reference/nudge_igraph_node.html">nudge_igraph_node()</a></code>: mode individual nodes</li>
<li>
<code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code>: adjust spacing, position,
rotation of a nodeset</li>
<li>
<code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code>: sort nodes in a group by
color</li>
<li>
<code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code>: arrage labels radially away
from incoming edges</li>
<li>
<code><a href="../reference/bulk_cnet_adjustments.html">bulk_cnet_adjustments()</a></code>: several operations applied in
bulk</li>
</ul>
<blockquote>
<p>Make sure to assign the output to a variable, or to click “Save
RData” from within the R-shiny app. For example:</p>
</blockquote>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/launch_shinycat.html">launch_shinycat</a></span><span class="op">(</span>g<span class="op">=</span><span class="va">cnet</span><span class="op">)</span></span></code></pre></div>
<p>The output is stored in an <code>environment</code> called
<code>output_env</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># obtain the output data</span></span>
<span><span class="va">adj_cnet</span> <span class="op">&lt;-</span> <span class="va">output_env</span><span class="op">$</span><span class="va">adj_cnet</span>;</span></code></pre></div>
<p>Then the new Cnet plot can be plotted, for example:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># jam_graph</span></span>
<span><span class="fu"><a href="../reference/jam_igraph.html">jam_igraph</a></span><span class="op">(</span><span class="va">adj_cnet</span>,</span>
<span>   node_factor<span class="op">=</span><span class="fl">2</span>,</span>
<span>   use_shadowText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   label_factor_l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nodeType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gene<span class="op">=</span><span class="fl">2</span>, Set<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="shinycat-screenshot">ShinyCat Screenshot<a class="anchor" aria-label="anchor" href="#shinycat-screenshot"></a>
</h3>
<p>An example of ShinyCat in action is shown below.</p>
<p><img src="shinycat-2.png" alt="Screenshot of ShinyCat in action, with a Cnet network plot in the center, and several inputs on the left to adjust the layout." width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
