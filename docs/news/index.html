<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Changelog • multienrichjam</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-news">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multienrichjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.87.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/multienrichjam/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.87.900" id="multienrichjam-0087900">multienrichjam 0.0.87.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0087900"></a></h2>
<p>The next update will likely use <code>Mem</code> S4 object instead of <code>list</code>, although the plan is to allow convenient conversion to <code>list</code> for legacy compatibility. The S4 functions and methods should be more convenient in long term, and will be Bioconductor-compliant.</p>
<div class="section level3">
<h3 id="new-functions-0-0-87-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-87-900"></a></h3>
<ul><li>
<p><code><a href="../reference/add_pathway_direction.html">add_pathway_direction()</a></code></p>
<ul><li>Adds column to <code>enrichResult</code> indicating the directionality, using the IPA Activation z-score calculation (refs in help doc). It requires <code>gene_hits</code> as a numeric vector named by gene symbol.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-87-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-87-900"></a></h3>
<ul><li>
<p><code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code>, affecting <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code>, <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>now applies logic for <code>descriptionGrep</code>, <code>nameGrep</code>, and <code>subsetSets</code> using OR logic, so any combination of matching results will be retained.</li>
<li>Help docs have been updated.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-0-0-87-900">other changes<a class="anchor" aria-label="anchor" href="#other-changes-0-0-87-900"></a></h3>
<ul><li>
<p><code>.onLoad()</code></p>
<ul><li>Minor change, it now checks whether the new <code>igraph</code> shapes already exist before adding, mostly useful when reloading this package in a live R session, which should be rare.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.86.900" id="multienrichjam-0086900">multienrichjam 0.0.86.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0086900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-86-900">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-86-900"></a></h3>
<ul><li>
<p><code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code>, <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code>, <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>Weird rare scenario that appears limited to custom enrichment data where input data contains multiple P-value columns, none of which match the defaults for argument <code>sortColnames</code> in <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code>.</li>
<li>First bug: The <code>sortColnames</code> argument was not evaluated with <code><a href="../reference/find_colname.html">find_colname()</a></code>, which is intended to match the patterns to actual data. This decision was probably to avoid handling the optional prefix <code>"-"</code> to reverse sort by colname.</li>
<li>Second bug: The <code>sortColnames</code> should really only use <code>pvalueColname</code> then reverse order for <code>countColname</code>.</li>
<li>End result: When <code>sortColname</code> matched no existing columns, the data was still sorted using <code><a href="https://rdrr.io/pkg/jamba/man/mixedSortDF.html" class="external-link">jamba::mixedSortDF()</a></code>. It found no matching colnames so by default it sorted starting with the first column. This is incorrect, and caused the bug.</li>
<li>New argument default: <code>sortColname=NULL</code> will use <code>pvalueColname</code> then reverse order of <code>countColname</code>. Alternatively <code>sortColname=FALSE</code> causes no sort to be performed, using data in the order it was provided. Finally, if <code>sortColname</code> is defined, and its values do not match existing colnames, no sort is performed.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-86-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-86-900"></a></h3>
<ul><li>
<p><code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>Minor change to silence the text output when <code>enrichIM</code> is entirely NA, which can occur when the input data does not contain any significantly enriched pathway results. This outcome causes <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code> but should not otherwise print output unless <code>verbose=TRUE</code>.</li>
</ul></li>
<li>
<p><code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code></p>
<ul><li>Both now use <code><a href="https://rdrr.io/pkg/jamba/man/gsubs.html" class="external-link">jamba::gsubs()</a></code> instead of the “temporary” internal function by the same name.</li>
</ul></li>
<li><p><code><a href="https://rdrr.io/pkg/jamba/man/gsubs.html" class="external-link">gsubs()</a></code> is removed, renamed <code><a href="../reference/gsubs_remove.html">gsubs_remove()</a></code> in favor of <code><a href="https://rdrr.io/pkg/jamba/man/gsubs.html" class="external-link">jamba::gsubs()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-0-0-86-900">other changes<a class="anchor" aria-label="anchor" href="#other-changes-0-0-86-900"></a></h3>
<p>Two functions are no longer imported, instead they are both called using the package prefix. It only affects <code><a href="../reference/grid_with_title.html">grid_with_title()</a></code> which is no longer used by default.</p>
<ul><li><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">ComplexHeatmap::draw()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/jamba/man/nameVector.html" class="external-link">jamba::nameVector()</a></code></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.85.900" id="multienrichjam-0085900">multienrichjam 0.0.85.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0085900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-85-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-85-900"></a></h3>
<ul><li>
<p><code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code></p>
<ul><li>
<p>New argument <code>revert_ipa_xref=TRUE</code> changes the default behavior (for the better) such that the resulting gene symbols associated with IPA pathway enrichment will match the input gene symbols, instead of using the customized IPA symbols.</p>
<ul><li>The situation does not have an ideal solution. Ultimately, IPA provides results which do not completely represent the input data. When two genes are combined to one entity by IPA, they only retain one gene symbol in <code>"Analysis Ready Molecules"</code>, and so there is no recorded association of all entities which were combined. Sometimes the combined symbol is <code>"HSPA1A/HSPA1B"</code> which can be separated… but they do not indicate which symbol(s) the user provided, they only record one. Some entities are called <code>"NBPF10 (includes others)"</code> and which appears to include <code>'NBPF10"</code> and <code>"NBPF19"</code>, possibly others.</li>
</ul></li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.84.900" id="multienrichjam-0084900">multienrichjam 0.0.84.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0084900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-84-900">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-84-900"></a></h3>
<ul><li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>Finally “fixed” the full bug, sometimes causing point hull to fail. Sometimes <code><a href="https://rdrr.io/pkg/alphahull/man/ahull.html" class="external-link">alphahull::ahull()</a></code> would return weird results with small <code>alpha</code> values: individual points, segments, or multiple disconnected polygons.</li>
<li>Now <code><a href="../reference/make_point_hull.html">make_point_hull()</a></code> calls <code><a href="../reference/get_hull_data.html">get_hull_data()</a></code> which performs additional validation checks: Confirms there is actually a polygon; confirms each point in the <code>edges</code> are used exactly twice; confirms that all edge points are used in a continuous polygon, not two separate polygons.</li>
<li>The default value for <code>max_iterations=100</code> is vastly increased, since many of these weird cases were caused by having coordinate ranges orders of magnitude higher than <code>alpha=0.1</code> and so 10 iterations would not be enough to avoid these weird situations.</li>
<li>Also when <code><a href="../reference/make_point_hull.html">make_point_hull()</a></code> does not find a suitable solution after <code>max_iterations</code> tries, it returns <code>NULL</code> instead of proceeding to process the inadequate/empty polygon coordinate data. Hopefully this will allow weird cases to be skipped rather than throwing an obscure error.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.83.900" id="multienrichjam-0083900">multienrichjam 0.0.83.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0083900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-83-900">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-83-900"></a></h3>
<ul><li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>One of the more obscure bugs, caused by creating a point hull with only two points, where the two points apparently resided at exactly the wrong angle. Only apparently occurred when the two points were within 3 degrees of some “evil angle” - resolved when points were rotated more than 3 degrees from this “evil angle”. Typically, a point hull is not possible with two points, since it does not create a polygon, so the workaround was to add a third point (recycling the first point) adding amount of noise to create a polygon. Except for some reason even <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code> was not adding <em>enough</em> or the right kind of noise. No random value should ever exactly, reproducible, reside on the line. There must be some rounding that takes place in an internal function. Nonetheless, the “fix” for this purpose was to add more than one dummy point.</li>
</ul></li>
<li>
<p><code><a href="../reference/list2im.html">list2im()</a></code></p>
<ul><li>Another bizarre “bug” was caused by some unconfirmed R function that appears to change <code>options("warn")</code> to <code>options("warn"=2)</code>
</li>
<li>and then does not change it back! Probably related to RMarkdown knitting, since it seems to occur when the knitting is interrupted. To be fair, warnings should be resolved in Jam packages, that’s true. But they should not impose an error.</li>
<li>Filed under: “Things that worked just two minutes ago, but now cause an error for no reason.”</li>
<li>Added workaround for random but painful issue when <code>options("warn"=2)</code> which forces warnings to errors. No idea what made that setting, but it caused <code><a href="../reference/list2im.html">list2im()</a></code> to fail due to implicit conversion of <code>empty</code> to whatever datatype was defined in the input matrix. In future this function may change, but for now this change keeps it working.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.82.900" id="multienrichjam-0082900">multienrichjam 0.0.82.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0082900"></a></h2>
<ul><li>
<p><code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>now <code>geneHitIM</code> and <code>geneHitList</code> are equivalent as input, either or both can be provided. The incidence matrix with values c(0, 1) are stored as <code>geneIM</code>, and if there are any other numeric values those values are stored in <code>geneIMdirection</code>. It does not (yet) verify that all genes involved in enrichment are also present in the <code>geneIM</code> and <code>geneIMdirection</code> matrices.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code></p>
<ul><li>New argument <code>gene_annotations</code> allows display of the <code>mem$geneIM</code> (gene hits per enrichment) and <code>mem$geneIMdirection</code> (gene direction of change) as annotations alongside the gene axis of the heatmap. By default, when <code>mem$geneIMdirection</code> is available, both are shown, otherwise only <code>geneIM</code> is shown. It can now be hidden.</li>
<li>New argument <code>simple_anno_size</code> to control the size of heatmap annotations.</li>
<li>New argument <code>annotation_suffix</code> to add optional suffix to the gene annotation labels, helpful to indicate the unit. For example <code>im</code> data has default suffix <code>"hit"</code>, while <code>direction</code> uses <code>"dir"</code>.</li>
<li>When <code>mem$geneIMdirection</code> is present, it is now used by default during clustering. Values are multiplied by <code>mem$geneIM</code> and any <code>NA</code> values in <code>mem$geneIMdirection</code> are replaced with <code>1</code> in order to maintain the <code>mem$geneIM</code> value. They are considered <code>unknown direction</code> in that sense.</li>
</ul></li>
</ul></div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.81.900" id="multienrichjam-0081900">multienrichjam 0.0.81.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0081900"></a></h2>
<ul><li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> and <code><a href="../reference/jam_igraph_arrows.html">jam_igraph_arrows()</a></code></p>
<ul><li>fixed bug when plotting directed edges with arrows, the arrow head width (<code>h.lwd</code>) was not properly expanded to the number of arrows, causing arrow heads to appear “twisted”.</li>
<li>changed default obscure option <code>sh.adj=1</code> which draws straight edges to the base of the arrow head, not to the arrow tip. It allows the arrow tip to be a point without needing to equal the edge line width.</li>
</ul></li>
</ul></div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.80.900" id="multienrichjam-0080900">multienrichjam 0.0.80.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0080900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-80-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-80-900"></a></h3>
<ul><li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>Silenced some default verbose output.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.79.900" id="multienrichjam-0079900">multienrichjam 0.0.79.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0079900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-79-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-79-900"></a></h3>
<ul><li>
<p><code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code></p>
<ul><li>argument <code>nodeSortBy=c("x", "y")</code> changed to <code>nodeSortBy=c("x", "-y")</code>, consistent with top-to-bottom sorting on the y-axis. This change indirectly affects <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> default output.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.78.900" id="multienrichjam-0078900">multienrichjam 0.0.78.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0078900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-78-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-78-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code></p>
<ul><li>The bivariate color scale was too pale for lower significance P-values, so the colors were encoded to have higher color saturation at the low end. The intermediate colors are improved, see <code><a href="../reference/colorRamp2D.html">colorRamp2D()</a></code> changes below.</li>
</ul></li>
<li>
<p><code><a href="../reference/colorRamp2D.html">colorRamp2D()</a></code></p>
<ul><li>The blue-yellow color blending by default in <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2()</a></code> was still producing grey, despite using the “LAB” (or “LUV”, “XYZ”) color models. This is usually a symptom of using RGB color space, blending “blue” with “red/green” (yellow) produces “red/green/blue” (grey), and not usually seen when using “LUV” which is a 360-degree hue radial color wheel. It is probably still converted to RGB before blending, then back to LUV.</li>
<li>The default argument was changed to <code>use_model="sRGB"</code> which produces a somewhat green color when blending blue and gold. The red-gold blending is improved as well, producing a more saturated orange color. End result: The intermediate directional colors are more recognizable as partly up (orange) or partly down (green).</li>
<li>TODO: This color legend needs x-axis labels, showing z-score values.</li>
</ul></li>
<li>
<p><code><a href="../reference/make_legend_bivariate.html">make_legend_bivariate()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">*</span> finally displays the x<span class="sc">-</span>axis label and numerical units,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>by default <span class="st">`</span><span class="at">"z-score"</span><span class="st">`</span>.</span></code></pre></div>
</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-78-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-78-900"></a></h3>
<ul><li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code>,<code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code></p>
<ul><li>error occurred when attributes in <code>list</code> form were entirely <code>NA</code>, one section did not use <code><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist()</a></code> properly. The bug was fixed.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.77.900" id="multienrichjam-0077900">multienrichjam 0.0.77.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0077900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-77-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-77-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> and <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> threw errors</p>
<ul><li>using <code>pathway_column_split</code> when there was only one column (one enrichment), this error is corrected.</li>
<li>Further, passing <code>cluster_rows</code> as a <code>function</code> caused the resulting <code>Heatmap</code> object not to store the <code>obj</code> with the dendrogram/hclust, instead it stored the function. This error was also corrected.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.76.900" id="multienrichjam-0076900">multienrichjam 0.0.76.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0076900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-76-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-76-900"></a></h3>
<p>The theme of this update is “Customizing mark.groups labeling”. Useful with <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> when supplying a <code>list</code> of node groups or communities via <code>mark.groups</code>, with labels defined in <code>names(mark.groups)</code>. The labels are automatically placed outside the mark polygon, and can be adjusted in size with <code>mark.cex</code>, and position with <code>mark.x.nudge</code>, <code>mark.y.nudge</code>.</p>
<ul><li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>new arguments: <code>label.cex</code>, <code>label.x.nudge</code>, <code>label.y.nudge</code> to customize the label font size, and label placement, when <code>label</code> is provided.</li>
</ul></li>
<li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> new arguments:</p>
<ul><li>
<code>mark.cex</code> passed to <code><a href="../reference/make_point_hull.html">make_point_hull()</a></code> as <code>label.cex</code>
</li>
<li>
<code>mark.x.nudge</code> passed to <code><a href="../reference/make_point_hull.html">make_point_hull()</a></code> as <code>label.x.nudge</code>
</li>
<li>
<code>mark.y.nudge</code> passed to <code><a href="../reference/make_point_hull.html">make_point_hull()</a></code> as <code>label.y.nudge</code>
</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="major-changes-to-existing-functions-0-0-76-900">major changes to existing functions<a class="anchor" aria-label="anchor" href="#major-changes-to-existing-functions-0-0-76-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code></p>
<ul><li>New default creates the gene-pathway incidence matrix heatmap data first, which serves as the basis for all other plots.</li>
<li>Impact on <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>, now inherits this clustering defined using the gene-pathway incidence matrix and only when called by <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code>. This change is the primary motivation for the update, so that the enrichment heatmap clustering is informed and driven by gene content, and no longer reflects only the enrichment P-values.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-to-existing-functions-0-0-76-900">other changes to existing functions<a class="anchor" aria-label="anchor" href="#other-changes-to-existing-functions-0-0-76-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code></p>
<ul><li>default <code>point_size_min=1</code> changed to <code>point_size_min=2</code> so the smallest points are still clearly visible, including the fill color.</li>
<li>default <code>p_cutoff=1e-6</code> changed to <code>p_cutoff=1e-10</code>
</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code></p>
<ul><li>default <code>p_cutoff=1e-6</code> changed to <code>p_cutoff=1e-10</code>
</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-76-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-76-900"></a></h3>
<ul><li>
<p><code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>Edge case where <code>geneHitList</code> could be supplied as a <code>list</code> of signed values, a directional hit list as used in <code><a href="https://rdrr.io/pkg/venndir/man/venndir.html" class="external-link">venndir::venndir()</a></code>. It did not get recognized, and was converted using the <code>numeric</code> values rather than using the names of the values.</li>
<li>The preferred option is to supply <code>geneHitIM</code> for signed data, however it now works with a signed hit <code>list</code> as well.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.75.900" id="multienrichjam-0075900">multienrichjam 0.0.75.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0075900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-75-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-75-900"></a></h3>
<ul><li>
<p><code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code></p>
<ul><li>New arguments to handle forward-slash delimited gene symbols used by IPA to indicate two or more genes they consider to be one biomolecule for the purpose of pathway enrichment. The forward-slash “/” is also the delimiter user in <code>clusterProfiler</code> object <code>enrichResult</code> which causes these genes to break that compatibility. The new arguments represent a workaround to handle IPA data, so that downstream functions do not require changes.</li>
<li>
<code>convert_ipa_slash=TRUE</code> enables the workaround, which converts forward-slash “/” to another delimiter.</li>
<li>
<code>ipa_slash_sep=":"</code> defines the alternate delimiter to use, the default <code>":"</code> was chosed because it does not interfere with other common delimiters used in gene symbols, and does not cause problems with regular expressions, which would have been a risk with using <code>"|"</code>.</li>
</ul></li>
<li>
<p><code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> was throwing an error when <code>size2</code> was not already defined in <code>igraph</code> vertex attributes. When there is no <code>size2</code> it now calls <code>default_igraph_values()$vertex$size2</code> to use the appropriate default value.</p>
<ul><li>other related errors are now caught and avoided, relating to steps that avoid updating empty entries in <code>list</code> vertex attributes, now it properly ignores pie attributes which were previously empty, and only updates entries with non-zero results.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code></p>
<ul><li>Fixed longstanding errors when trying to split the heatmap by row or column into more pieces than the data will allow. The current workaround is almost complete, covers obvious cases where the requested number is higher than the number of columns or rows. It does not determine if there can only be one or two clusters but there are more columns or rows present. In future.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-0-0-75-900">other changes<a class="anchor" aria-label="anchor" href="#other-changes-0-0-75-900"></a></h3>
<ul><li>moved <code><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code> to a separate R file, for future maintenance.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.74.900" id="multienrichjam-0074900">multienrichjam 0.0.74.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0074900"></a></h2>
<div class="section level3">
<h3 id="updates-to-existing-functions-0-0-74-900">updates to existing functions<a class="anchor" aria-label="anchor" href="#updates-to-existing-functions-0-0-74-900"></a></h3>
<ul><li>
<p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code></p>
<ul><li>argument docs were updated</li>
<li>default colors in <code>col</code> were defined with more saturated default colors: <code>c("blue", "grey80", "firebrick3")</code>
</li>
<li>argument default changed to <code>col_l_max=80</code> to accommodate higher <code>"grey80"</code> middle color.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_legend.html">mem_legend()</a></code></p>
<ul><li>new argument <code>pt.lwd=2</code> to control line width of open circles, used when <code>do_direction=TRUE</code>. The previous alternative was to define <code>par(lwd=2)</code> prior to calling <code><a href="../reference/mem_legend.html">mem_legend()</a></code>, then setting <code>par(lwd=1)</code> afterwards.</li>
<li>
<code>directional_colors</code> use the same default colors used by <code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code>; and now includes <code>"no change"</code> as a specific legend entry.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.73.900" id="multienrichjam-0073900">multienrichjam 0.0.73.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0073900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-73-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-73-900"></a></h3>
<ul><li>
<p>Fixed errors rendering <code>igraph</code> nodes with <code>shape="circle"</code> only when called by <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code>, and only with newer versions of <code>igraph</code> R package that expect the new attribute <code>vertex.frame.width</code> (not <code>vertex.frame.lwd</code> as I had hoped).</p>
<ul><li>
<code><a href="../reference/default_igraph_values.html">default_igraph_values()</a></code> now defines <code>vertex.frame.width</code> and <code>vertex.frame.lwd</code>.</li>
<li>Note: <code>vertex.frame.lwd</code> is very likely to be removed from this package altogether, for compliance with <code>igraph</code>. However, I will do proper testing before making the change.</li>
</ul></li>
<li><p>Bug in <code><a href="../reference/rank_mem_clusters.html">rank_mem_clusters()</a></code> which created a <code>data.frame</code>, and did not specify <code>stringsAsFactos=FALSE</code>, is fixed. Possibly similar bugs in other functions.</p></li>
<li><p>Bug in <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> and <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> when enrichment only involves one gene, causing the <code>row_split</code> and <code>row_title</code> values to be incorrect. It is not a useful workflow, but the functions should handle the error edge case.</p></li>
<li><p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code> now checks input argument <code>cnet</code> and <code>hitim</code> to make sure they are non-empty before processing. In theory it should not happen, but apparently it does when enrichment results are sparse or possibly empty.</p></li>
<li><p><code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code> internal function uses proper <code>igraph::shapes(shape)</code> instead of previously internal <code>list</code> object <code>igraph:::.igraph.shapes[[shape]]</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.72.900" id="multienrichjam-0072900">multienrichjam 0.0.72.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0072900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-72-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-72-900"></a></h3>
<ul><li>
<p><code><a href="../reference/subset_mem.html">subset_mem()</a></code></p>
<ul><li>convenience function to subset an entire <code>mem</code> object by sets (pathways) or genes. It will subset all internal incidence matrix objects for consistency.</li>
<li>This approach will become the preferred approach to display a specific set of pathways in a Cnet plot, by calling <code><a href="../reference/subset_mem.html">subset_mem()</a></code> then <code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code>.</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> currently subsets <code>mem</code> data internally, but for consistency may call <code><a href="../reference/subset_mem.html">subset_mem()</a></code> instead. The arguments are designed to be very similar.</li>
</ul></li>
<li>
<p><code><a href="../reference/get_igraph_layout.html">get_igraph_layout()</a></code></p>
<ul><li>simple helper function to retrieve or define layout coordinates for an <code>igraph</code> object. Because there is some logic to the process, it makes sense to put into its own function.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-72-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-72-900"></a></h3>
<ul><li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code>, <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code></p>
<ul><li>
<p>recognizes new <code>igraph</code> attributes: <code>vertex.label.fontsize</code>, <code>edge.label.fontsize</code>.</p>
<ul><li>These are not standard <code>igraph</code> attributes and will not be honored by default <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code> functions.</li>
<li>When <code>vertex.label.fontsize</code> is specified as a font size in points, this font size is used with no modification by <code>vertex.label.cex</code>.</li>
<li>When any <code>vertex.label.fontsize</code> value is <code>NA</code>, the default behavior is used to calculate font size, which uses <code>vertex.label.cex</code>. Therefore the <code>vertex.label.fontsize</code> can be defined for a single node, as long as all other node values are <code>NA</code>, and only the one node font size will be adjusted to this specific fontsize.</li>
<li>The <code>igraph</code> labels are drawn using <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>, and the final exact font size is calculated for nodes: <code>par("ps") * par("cex") * vertex.label.cex</code> and for edges: <code>par("ps") * par("cex") * edge.label.cex</code>
</li>
</ul></li>
<li><p>new argument <code>label_fontsize_l</code> used to apply specific <code>vertex.label.fontsize</code> based upon node attribute values. For example <code>label_fontsize_l=list(nodeType=c(Gene=10, Set=14))</code> will define Gene nodes with fontsize 10, Set nodes with fontsize 14.</p></li>
</ul></li>
<li>
<p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code></p>
<ul><li>when <code>frame_blank=NULL</code> is passed as an argument, it is interpreted as <code>frame_blank=NA</code> which uses no <code>frame.color</code> for blank nodes.</li>
</ul></li>
<li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code>, <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code></p>
<ul><li>The following change was made to default behavior, so any method that reorders igraph nodes by color/border/name will be affected. Nodes will by default be sorted left-right when the nodes in a nodeset have less than 25% the x-span (width) compared to y-span (height), otherwise nodes will be sorted top-bottom. The direction along each axis respects the original argument <code>nodeSortBy</code>, to allow specific order based upon the data, or the natural order per the locale.</li>
<li>new arguments <code>orderByAspect</code> and <code>aspectThreshold</code> control when to sort left-right or top-bottom.</li>
<li>When the nodeset coordinate aspect ratio is taller (25% higher y-span than x-span) the nodes are sorted top-bottom, otherwise nodes are sorted left-right.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-72-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-72-900"></a></h3>
<ul><li><p><code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code> threw an error for certain custom input that did not meet expected constraints. The function was updated to prevent these errors and to be more robust to this type of issue.</p></li>
<li>
<p><code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> is called when rendering <code>shape="jampie"</code> nodes.</p>
<ul><li>Previously when <code>frame.lwd=0</code> and <code>frame.color="black"</code> a small black border was drawn around the node. The new behavior when <code>frame.lwd=0</code> is to replace the color with <code>NA</code> so no outer border is drawn.</li>
</ul></li>
<li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code>, <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code></p>
<ul><li>Fixed bug where <code>nodesets</code> argument was not always matched due to truncating the nodeset label to 25 characters. Now the nodeset label is not truncated.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.71.900" id="multienrichjam-0071900">multienrichjam 0.0.71.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0071900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-71-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-71-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code></p>
<ul><li>After gene-pathway heatmap clustering, a collapsed Cnet <code>igraph</code> is created using pathway column clusters. The pathway cluster nodes are colorized based upon the proportion of each enrichment in that cluster, however it uses <code>mem$enrichIMcolors</code> by default. This function now applies statistical thresholds <code>p_cutoff</code> and <code>min_set_ct_each</code> prior to this step so the resulting colors will reflect those thresholds.</li>
<li>Help documentation was updated to include this information.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.70.900" id="multienrichjam-0070900">multienrichjam 0.0.70.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0070900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-70-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-70-900"></a></h3>
<ul><li>
<p><code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code></p>
<ul><li>Rare scenario using jampie nodes, when vertex.pie.lty is not defined, the default was not properly expanded to vcount, causing error <code>"subscript out of bounds"</code> when referencing <code>vertex.pie.lty[[i]]</code>.</li>
<li>Error above is caused by missing node attribute <code>"pie"</code>, which are now filled in with uniform values of 1 based upon <code>lengths(vertex.pie.color)</code>. This scenario usually occurs when trying to create pie nodes outside the “typical” scenarios, for example manually assigning attributes and not populating all the necessary values.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.69.900" id="multienrichjam-0069900">multienrichjam 0.0.69.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0069900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-69-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-69-900"></a></h3>
<ul><li><p><code><a href="../reference/color_edges_by_nodegroups.html">color_edges_by_nodegroups()</a></code></p></li>
<li>
<p><code><a href="../reference/communities2nodegroups.html">communities2nodegroups()</a></code>, <code><a href="../reference/nodegroups2communities.html">nodegroups2communities()</a></code></p>
<ul><li>conversion functions that help interconvert between <code>igraph</code> <code>communities</code> objects, and <code>nodegroups</code> which is a <code>list</code> of node names.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem2emap.html">mem2emap()</a></code></p>
<ul><li>replacement for <code><a href="../reference/enrichMapJam.html">enrichMapJam()</a></code>
</li>
<li>converts <code>mem</code> output to an <code>igraph</code> object with multienrichment features, such as <code>pie</code> nodes with appropriate color fill, <code>pie.border</code> colored by direction when <code>enrichIMdirection</code> is defined.</li>
<li>by default, the resulting network has community detection called, then visualized with boundaries around the various nodes.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-69-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-69-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>, <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code></p>
<ul><li>Updated to pass <code>raster_device</code> to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> to work around temporary error when the <code>"magick"</code> package is not available, <code>use_raster=TRUE</code>, which causes an error during rasterization. The error is resolved when changing from default raster device to <code>raster_device="agg_png"</code>, although this change requires the <code>"ragg"</code> R package is installed. So the change tests if <code>"ragg"</code> is available, and if so it passes <code>raster_device="agg_png"</code>. The change should not affect any other scenarios.</li>
</ul></li>
<li>
<p><code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code></p>
<ul><li>New argument <code>bundle_self=FALSE</code> changes previous default behavior by not bundling nodes that connect from and to the same nodegroups. Previously, nodes connecting within the same nodegroup would bundle through the center point of the cluster, which does minimize the busy edge lines, but makes it difficult to follow any paths.</li>
</ul></li>
<li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>new arguments <code>label</code>, <code>label_preset</code>, <code>label_adj_preset</code> are ussed to define optional label to appear outside the resulting hull. The label is intended to be used for network communities, to allow a label associated with each community when relevant.</li>
<li>Label placement is experimental and could change in future.</li>
<li>Labels are placed relative to the center of the layout, using the angle from layout center to hull center. Labels are placed outside the rectangular bounding box of the point hull, with text aligned to the outer edge based upon the nearest 45 degree angle from layout center to hull center.</li>
</ul></li>
<li><p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code> default <code>frame_lwd=0.2</code> changed from <code>frame_lwd=1</code>.</p></li>
<li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code>, <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code></p>
<ul><li>new argument <code>bundle_self=FALSE</code> passed to <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code> and ultimately to <code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code>. When TRUE any edges that connect from and to the same nodegroup will be bundled through the nodegroup center. The default FALSE does not bundle within nodegroup, so edges are only bundled when connecting two different nodegroups.</li>
</ul></li>
<li><p><code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code> now handles various combinations of missing <code>pie.lwd</code> and <code>frame.lwd</code> more gracefully.</p></li>
<li><p><code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code> uses smaller node size by default.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.68.910" id="multienrichjam-0068910">multienrichjam 0.0.68.910<a class="anchor" aria-label="anchor" href="#multienrichjam-0068910"></a></h2>
<p>It turns out that <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code> only properly closes the polygon when it has a color fill with non-zero alpha transparency. In this case, the final “closed” corner is correctly extended to complete the sharp corner edge using line join <code>par("ljoin")</code>. With no color fill, or with completely transparent color fill, the final corner is not completed, the lines are “ended” using <code>par("lend")</code>, and therefore there is no sharp corner. The workaround is to apply a color with alpha transparency 1 (on scale of 0 to 255), which causes the border to be drawn completely. However, some rare graphical output devices do not support alpha transparency, so there is the chance of rendering unintended opaque color fill. The situation should only affect node shapes <code>"pie"</code> and <code>"jampie"</code>, which are designed to draw the outer border then inner border, so the impact should be minimal. Shape <code>"coloredrectangle"</code> actually calls <code><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">graphics::symbols()</a></code> which avoids this issue. However, cases where outer border is expected to be drawn after the inner border, it has small risk of rendering the fill color fully opaque, covering the inner border. One day I probably need to replace <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code> with a custom function <code>polygon_with_borders()</code> that can handle inner and outer border properly.</p>
<div class="section level3">
<h3 id="updates-to-existing-functions-0-0-68-910">updates to existing functions<a class="anchor" aria-label="anchor" href="#updates-to-existing-functions-0-0-68-910"></a></h3>
<ul><li>
<code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> which is used to render <code>igraph</code> nodes <code>shape="jampie"</code> was modified to use <code>col="#FFFFFF01"</code> for color fill of polygon outer borders.</li>
<li>
<code><a href="../reference/adjust_polygon_border.html">adjust_polygon_border()</a></code> examples were modified to show the effect of using <code>col=NA</code> to <code>col="#FFFFFF01"</code> on polygon border rendering.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-68-910">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-68-910"></a></h3>
<ul><li>
<code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> and <code><a href="../reference/shape.coloredrectangle.plot.html">shape.coloredrectangle.plot()</a></code> were updated to force <code>stringsAsFactors=FALSE</code> when creating <code>data.frame</code> objects, fixing weird color glitch in the examples for <code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.68.900" id="multienrichjam-0068900">multienrichjam 0.0.68.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0068900"></a></h2>
<div class="section level3">
<h3 id="notable-release-notes-0-0-68-900">Notable release notes<a class="anchor" aria-label="anchor" href="#notable-release-notes-0-0-68-900"></a></h3>
<ul><li>
<p><code>igraph</code> nodes with <code>shape="pie"</code> and <code>shape="jampie"</code></p>
<ul><li><p>New attributes <code>vertex.frame.lwd</code> and <code>vertex.pie.lwd</code> to customize the respective line widths of node borders. These attributes require using <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> for <code>shape="pie"</code>, or require using <code>vertex.shape="jampie"</code> with <code>igraph::plot()</code>.</p></li>
<li><p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> is now recommended as a more complete replacement for <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>.</p></li>
<li><p><code>shape="jampie"</code> no longer uses <code>par("lwd")</code>, which was global change that affected all nodes, edges, and plot features.</p></li>
<li><p>Pie wedges use “inner borders” for each node, so adjacent wedge borders will not overlap. Note that inner border slightly overlaps the interior node fill color, to maintain consistent node sizes.</p></li>
<li><p><code>frame.color</code> uses “outer borders” for each node, so these borders will not overlap inner pie wedge borders. Nodes are slightly adjusted smaller to maintain consistent node sizes, by default.</p></li>
<li><p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code> has slightly different logic for pie and frame colors, and now assigns <code>pie.lwd</code> and <code>frame.lwd</code>.</p></li>
<li><p><code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> no longer changes single-color <code>shape="pie"</code> nodes to <code>shape="circle"</code> by default.</p></li>
<li>
<p><strong>Changes suggested</strong>:</p>
<ul><li>Prefer <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> over <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> or <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>.</li>
<li>Previous use of <code>par("lwd")</code> should be removed, and replaced with <code>vertex.pie.lwd</code> and <code>frame.lwd</code>.</li>
<li>Previously, single-color <code>shape="pie"</code> or <code>shape="jampie"</code> nodes were changed to <code>shape="circle"</code> by <code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code>, however they now stay <code>shape="pie"</code> in order to maintain control of line widths. The <code>igraph</code> nodes <code>shape="circle"</code> do not respect line width <code>lwd</code>.</li>
<li>Use of <code>shape="circle"</code> should be changed to <code>vertex.shape="pie"</code> or <code>vertex.shape="jampie"</code>, this change affects <code>nodeType="Gene"</code> moreso than <code>nodeType="Set"</code>.</li>
</ul></li>
<li>
<p>Edges are now clipped to the outer border of nodes, which helps when using transparent node fill, or when using edge arrows.</p>
<ul><li>With transparent nodes, the edge was previously shown connected to the center of each node (without clipping); similarly, edge arrows connected to the center of each node, effectively invisible and certainly not useful. However, cnet plots do not use edge arrows.</li>
<li>Most edges appear identical to previous rendering, however the control points used during bundling are used to determine where the edge connects to each node border. Thus, when edges converge on one node, bundled edges appear to “merge together” at one point connecting to the node. Previously nodes entered from multiple angles, since they connected to the interior center of the node, and showed somewhat more spacing based upon the number of edges.</li>
<li>Future options may include retaining some edge spacing based upon the intermediate edge curvature of each edge, instead of using the same control point for all edges, so the connection point on the central node will be slightly spaced out.</li>
</ul></li>
</ul></li>
<li>
<p><code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code> and <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> changed some default sizes. The new defaults should work well without adjustment.</p>
<ul><li>
<p>Node sizes are 4x larger than before, because when calling downstream functions we found ourselves always scaling nodes 4x larger.</p>
<ul><li>The defaults: <code>categorySize=20</code>, <code>geneSize=10</code> are exactly 4x larger.</li>
<li>
<strong>Changes required</strong>: Change previous <code>node_factor=4</code> to <code>node_factor=1</code> for reproducibility; or when calling <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> use arguments <code>memIM2cnet(..., categorySize=5, geneSize=2.5)</code>.</li>
</ul></li>
<li>
<p>node label sizes also have new defaults, similarly because we most often applied <code>label_factor=1.3</code> by default.</p>
<ul><li>The defaults: <code>categoryCex=1.2</code>, <code>geneCex=0.9</code> are adjusted from previous <code>categoryCex=0.9</code>, <code>geneCex=0.7</code>.</li>
<li>
<strong>Changes required</strong>: Change <code>label_factor</code> or <code>label_factor_l</code> to 1, or change the call <code>memIM2cnet(..., categoryCex=0.9, geneCex=0.7)</code>.</li>
</ul></li>
</ul></li>
<li>
<p>igraph defaults were changed when using <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> for plotting:</p>
<ul><li>
<code>vertex.label.family</code> changed from <code>"serif"</code> to <code>"sans"</code>.</li>
<li>
<code>vertex.pie.border</code> changed to <code>"grey30"</code>, the <code>igraph</code> default values were identical to <code>vertex.pie.color</code> and therefore not visible.</li>
<li>
<code>vertex.frame.lwd</code> set to 1, although this value is ignored by <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code> since it only uses <code>par("lwd")</code> for all lines.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-dependencies-0-0-68-900">changes to dependencies<a class="anchor" aria-label="anchor" href="#changes-to-dependencies-0-0-68-900"></a></h3>
<ul><li>
<code>arules</code> was removed as a dependency, as two functions that used its class <code>"transactions"</code> were rewritten to remove the requirement. The previous version of those functions are internal and renamed from: <code><a href="../reference/im2list.html">im2list()</a></code> to <code><a href="../reference/im2list_dep.html">im2list_dep()</a></code>; and <code><a href="../reference/imSigned2list.html">imSigned2list()</a></code> to <code><a href="../reference/imSigned2list_dep.html">imSigned2list_dep()</a></code>. The replacement functions should return identical data.</li>
<li>
<code>bezier</code> was added as dependency to generate edge bundling curves, in head-to-head tests, it out-performed <code><a href="https://rdrr.io/r/graphics/xspline.html" class="external-link">graphics::xspline()</a></code>, and produced identical results to internal function <code>ggforce::bezierPath()</code>. Since <code>bezier</code> has no dependencies, this addition should feel small.</li>
<li>
<code>jamba</code> was bumped to version <code>0.0.88.900</code> for an important fix to <code><a href="https://rdrr.io/pkg/jamba/man/mixedSort.html" class="external-link">mixedSort()</a></code>.</li>
<li>
<code>colorjam</code> was bumped to version <code>0.0.23.900</code> for consistency.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-68-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-68-900"></a></h3>
<ul><li>
<p><code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code></p>
<ul><li>When nodesets are not matched in the data, it prints a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning()</a></code> then returns the input graph without change. Previously it called <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code>, which is problematic for relevant workflows.</li>
</ul></li>
<li>
<p><code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code></p>
<ul><li>default argument changed to <code>pie_to_circle=FALSE</code> so single-item nodes <code>shape="pie"</code> are no longer converted to <code>shape="circle"</code>, since <code>"jampie"</code> nodes are rendered much better. Haha.</li>
</ul></li>
<li>
<p><code><a href="../reference/drawEllipse.html">drawEllipse()</a></code></p>
<ul><li>now accepts vectorized input and processes accordingly.</li>
<li>New examples show the varied features, many of which are not used for <code>igraph</code> node shape=“ellipse”, but they could be used in future.</li>
</ul></li>
<li>
<p><code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code>, <code><a href="../reference/shape.coloredrectangle.plot.html">shape.coloredrectangle.plot()</a></code></p>
<ul><li>
<p>These functions draw custom <code>igraph</code> node shapes.</p>
<ul><li>
<code>shape="jampie"</code> draws a pie node shape with more features than vanilla igraph pie shape. Each pie wedge is color filled with <code>pie.color</code>, with new optional inner border <code>pie.border</code>, <code>pie.lwd</code>. The pie node overall can have an outer border defined by <code>frame.color</code> and <code>frame.lwd</code>. Also, pie nodes with only one color are rendered as a circle, with no tiny internal line.</li>
<li>
<code>shape="coloredrectangle"</code> draws a series of square boxes with color fill <code>coloredrect.color</code>, and optional inner border <code>coloredrect.border</code>. The node overall can have an outer border defined by <code>frame.color</code>, and <code>frame.lwd</code>.</li>
</ul></li>
<li><p>Both functions now use inner and outer borders via <code><a href="../reference/adjust_polygon_border.html">adjust_polygon_border()</a></code>, so the various borders no longer overlap. Previously, pie nodes drew each wedge with default <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code>, which allows adjacent borders to overlap 100%.</p></li>
<li><p>Note that nodes are resized internally so the rendered node size is equal across all nodes even when the line widths (lwd) vary.</p></li>
<li><p>There are some idiosyncracies from calling <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code> to render pie wedges, since it does not by default allow vectorized plotting of multiple polygons with different line widths. Therefore <code>shape="jampie"</code> renders line widths in subsets with identical line widths for vectorized plotting, which is 10-100x faster than plotting each pie node individually as done by <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>. The main potential issue would be seen with partially overlapping nodes, with the potential to display inconsistent overlap order.</p></li>
<li><p>It seems hopeless to evaluate ggraph/tidygraph to render visualizations, in part due to visualization and rendering details. Also, ggraph/tidygraph does not store nor recognize many <code>igraph</code> visualization details in the <code>igraph</code> object, instead they must be encoded as <code>ggplot2</code> visualization options and settings. Using that ecosystem would also require creating new ggplot2 node geom types, and edge bundling functions.</p></li>
</ul></li>
<li>
<p><code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code></p>
<ul><li><p>This update represents a substantial refactor of logic.</p></li>
<li>
<p>Edge bundles can be “invalid”, which causes edges to be drawn as linear edges between nodes. The criteria were based upon a series of test cases which were all so common that they warranted being fixed.</p>
<ul><li>Bundling usually occurs along the line between two nodegroup center points, calculated as mean node coordinates in each nodegroup. Sometimes the configuration of the center points, or the line itself, cause edge bundling to become unnecessary or ineffective.</li>
<li>Co-linear control points: When the edge and control points are co-linear (along the same line), the edge is drawn as a line. The criteria uses correlation above 0.99 for node and control points of each edge. This criteria affects indiviual edges, so nodes in the same nodegroup may be rendered differently based upon the specific position. The problem is clear when one control point appears beyond the path between two nodes. For non-linear edges, the path would curve around to the far side of the node. For linear edges, it appears as a line that extends beyond one node with optional arrow pointing backward. The solution effectively draws the same edge, except clips the edge at the first node boundary.</li>
<li>Both nodegroups contain only one node: with only one node in each group, there is nothing to “bundle”.</li>
<li>Both nodegroups have identical center points, within some small tolerance as a small percentage (0.5%) of the overall layout range.</li>
<li>When one nodegroup contains only one node, and the other nodegroup center point sits inside the node boundary, there is no bundling. Note this criteria is dependent upon node size during rendering. The problem is the edge spline control point is inside the node, so the spline would curve inside the node boundary, then point back out to the node border from the inside. Instead, the edge is drawn as a straight line to the node boundary from the outside. This situation occurs when one nodegroup fully surrounds a central node, so edges are drawn directly to the central node.</li>
</ul></li>
<li>
<p>Edge bundling “midpoint” represents the position along the line between two nodegroups.</p>
<ul><li>When one nodegroup contains only one node, this line is clipped to the node boundary, so the midpoint is defined beginning at the outer edge of the node, toward the center of the other nodegroup.</li>
<li>Note that when both nodegroups contain only one node, edge bundling is already invalid (see above).</li>
<li>Note than when the other nodegroup center sits inside the node boundary, the edge bundling is also invalid.</li>
<li>Therefore this situation only occurs when one nodegroup center is already outside the border of the single-node nodegroup.</li>
</ul></li>
<li><p>Edges are properly clipped using the relevant <code>igraph</code> shape clip function. See <code><a href="https://r.igraph.org/reference/shapes.html" class="external-link">igraph::shapes()</a></code>, and <code>igraph::shapes("circle")$clip</code> for specific examples.</p></li>
<li><p>Edge labels are rendered along edges as follows: Linear edges are encoded with three coordinates: start, middle, end. Spline edges are encoded using default <code><a href="https://rdrr.io/r/graphics/xspline.html" class="external-link">graphics::xspline()</a></code> which returns 100 points by default. Edge labels are placed using the coordinate most distant from the start and end node. For linear edges, the middle coordinate is used, for splines a point very near the middle of the edge is used.</p></li>
</ul></li>
<li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code></p>
<ul><li><p>This function is intended as an enhanced drop-in replacement for <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>. It was updated to fulfill previously un-implemented features, so fulfill the promise of being a replacement.</p></li>
<li>
<p>New arguments, formally passed to internal <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code>:</p>
<ul><li>
<code>mark.groups</code>, <code>mark.shape</code>, <code>mark.col</code>, <code>mark.border</code>, <code>mark.expand</code>, <code>mark.lwd</code>, <code>mark.lty</code>, <code>mark.smooth</code> - arguments to enable and customize the rendering of nodes within clusters or groups.</li>
<li>Note the new options: <code>mark.lwd</code>, <code>mark.lty</code> for each group border; <code>mark.smooth</code> to control whether the group polygon is smoothed; <code>mark.alpha</code> to control alpha transparency of fill colors when not already defined.</li>
<li>
<code>mark.expand</code> is now expected to be provided as a fraction of plot layout range, which is very close to default behavior in <code>igraph</code> since the default <code>rescale=TRUE</code> forced all layout ranges between <code>c(-1, 1)</code>.</li>
</ul></li>
<li><p><code>edge_bundling</code> new option <code>"default"</code> will try to detect the most appropriate bunding method, based upon whether <code>nodegroups</code>, <code>mark.groups</code> are defined, otherwise it chooses <code>"connections"</code>.</p></li>
<li><p>Edge labels are now rendered for straight edges and edge bundled edges.</p></li>
<li><p>Edge labels can now accept multiple <code>"edge.family"</code> values, in the unlikely event of multiple fonts on the same plot. This scenario will cause an error with <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>.</p></li>
<li><p>Edges are properly clipped based upon the <code>igraph</code> node shape.</p></li>
<li><p>Internal adjustments to <code>node_factor</code>, <code>edge_factor</code>, <code>node_factor_l</code>, <code>edge_factor_l</code>, <code>label_factor</code>, <code>label_factor_l</code>, <code>label_dist_factor</code>, and <code>label_dist_factor_l</code> were adjusted to be applied more consistently.</p></li>
<li><p>Undefined layout is now properly calculated dynamically and passed to the internal rendering function <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code>, so the values for <code>xlim</code>,<code>ylim</code> are now properly calculated.</p></li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-68-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-68-900"></a></h3>
<ul><li><p><code><a href="../reference/make_cnet_test.html">make_cnet_test()</a></code> to create Cnet plot <code>igraph</code> data for testing.</p></li>
<li>
<p><code><a href="../reference/adjust_polygon_border.html">adjust_polygon_border()</a></code> defines inner and outer borders for polygons.</p>
<ul><li>Using inner borders allows adjacent polygons to have their borders visible beside each other, without overlap.</li>
<li>Using an outer border allows the display of a border around a collection of polygons without overlapping their inner borders.</li>
<li>Borders can be layered inside or outside existing borders.</li>
<li>There are extensive examples showing various combinations of borders.</li>
</ul></li>
<li>
<p><code><a href="../reference/shape.jampie.plot.html">shape.jampie.clip()</a></code>, <code><a href="../reference/shape.coloredrectangle.plot.html">shape.coloredrectangle.clip()</a></code></p>
<ul><li>Invisible to the user, however they are called for igraph shapes <code>"jampie"</code> and <code>"coloredrectangle"</code>, respectively.</li>
<li>These functions now properly clip edges to the outer border of each node, including optional inner and outer borders.</li>
</ul></li>
<li>
<p><code><a href="../reference/shape.ellipse.clip.html">shape.ellipse.clip()</a></code></p>
<ul><li>calculates the optional rotation and size of the ellipse and adjusts the edge endpoints accordingly.</li>
</ul></li>
<li>
<p><code><a href="../reference/parse_igraph_plot_params.html">parse_igraph_plot_params()</a></code></p>
<ul><li>reproduces an internal <code>igraph</code> function, which cannot be called by CRAN-approved R packages.</li>
</ul></li>
<li>
<p><code><a href="../reference/default_igraph_values.html">default_igraph_values()</a></code></p>
<ul><li>reproduces internal <code>igraph</code> package data in a function call, for CRAN compliance.</li>
</ul></li>
<li>
<p><code><a href="../reference/jam_igraph_arrows.html">jam_igraph_arrows()</a></code></p>
<ul><li>Mimics and extends internal <code>igraph:::igraph.Arrows()</code> for CRAN compliance.</li>
<li>It also optionally only renders edge arrows, useful when an edge bundling function renders edges itself.</li>
</ul></li>
<li>
<p><code><a href="../reference/get_igraph_arrow_mode.html">get_igraph_arrow_mode()</a></code></p>
<ul><li>Another mimic of internal <code>igraph:::i.get.arrow.mode()</code> for CRAN compliance.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.67.900" id="multienrichjam-0067900">multienrichjam 0.0.67.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0067900"></a></h2>
<ul><li>
<p>added packages to Suggests to support new functions for node layout, and creation of more “correct” alpha hull polygons around points.</p>
<ul><li>
<code>alphahull</code> - best implementation of alpha hull. However, it also requires <code>sp</code> package, a heavy install which not advised because it is being retired in 2023 in favor of <code>sf</code>. Slight risk that the <code>alphahull</code> package is removed from CRAN if it is not updated.</li>
</ul></li>
<li>
<p>Added to Depends</p>
<ul><li>
<code>sf</code> - lightweight replacement of <code>sp</code> that provides useful geometric functions. It is added primarily because it improves rendering pie node borders, which are resized by the exact line width determined at the time of plotting pie nodes.</li>
</ul></li>
</ul><div class="section level3">
<h3 id="new-functions-0-0-67-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-67-900"></a></h3>
<ul><li>
<p><code><a href="../reference/make_point_hull.html">make_point_hull()</a></code></p>
<ul><li>This function is in active development, and is not yet used in other functions, but will be used in the next version.</li>
<li>takes set of points, makes an alpha hull using <code><a href="https://rdrr.io/pkg/alphahull/man/ashape.html" class="external-link">alphahull::ashape()</a></code>, then expands using <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_buffer()</a></code>.</li>
<li>If <code>alphahull</code> is not available, it uses <code><a href="https://rdrr.io/r/grDevices/chull.html" class="external-link">grDevices::chull()</a></code> which does not produce the “ideal” shape but has no additional R depedencies. It is also identical to output from <code>igraph</code> and <code>sf</code> packages for point hulls, so it has strong precedent.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-67-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-67-900"></a></h3>
<ul><li>
<p><code><a href="../reference/get_cnet_nodeset.html">get_cnet_nodeset()</a></code></p>
<ul><li>Refactored for greater speed, in test cases with 585 nodes, previous output took 1.28 seconds, the new output takes 0.025 seconds, 50x speed increase. This function is called in numerous places in this package, so this improvement will also positively affect all sorts of other functions.</li>
</ul></li>
<li>
<p><code><a href="../reference/colors_from_list.html">colors_from_list()</a></code></p>
<ul><li>The sort algorithm was improved in cases where the color order were ambiguous, but including names in the tiebreak, before using <code>H,C,L</code> values.</li>
<li>Note: This function is used by <code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code> when <code>colorV</code> is not explicitly provided, by detecting the probable order of colors based upon order of colors in multi-color nodes.</li>
</ul></li>
<li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code></p>
<ul><li>The sort order was updated to be more efficient, and to use better logic when following <code>colorV</code> or when defining <code>colorV</code> ad hoc.</li>
<li>When sorting by <code>"color"</code> the order will be defined by <code>colorV</code> whenever colors are aligned by <code>colorV</code>, otherwise colors are generally sorted by hue <code>"H"</code> in HCL space.</li>
<li>Examples were added to show clearly the different options for ordering, including visual examples of the <code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> rendering of pie nodes.</li>
</ul></li>
<li>
<p><code><a href="../reference/jam_mypie.html">jam_mypie()</a></code></p>
<ul><li><p>Visual examples are in <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code>, since the <code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> function is internal to the igraph plotting scheme.</p></li>
<li><p>This function draws pie nodes in vectorized fashion, properly drawing each set of pie polygons per node, then the appropriate borders defined by <code>pie.border</code> and <code>frame.color</code>.</p></li>
<li><p><code>pie.border</code> has the option to be drawn inside the border of the polygon, so that adjacent Venn wedges will have the entire outer border color visible without overlapping the adjacent Venn wedge. To enable, set: <code>options("inner_pie_border"=TRUE)</code></p></li>
<li><p><code>frame.color</code> also has the option to be drawn in a manner that does not overlap <code>pie.border</code>, it will be drawn just outside the <code>pie.border</code>.</p></li>
<li><p>In cases where <code>frame.color</code> is not drawn, the <code>pie.border</code> radius is adjusted to exactly the line width of the <code>frame.color</code> border, so nodes will always be exactly the same sizes with or without the <code>frame.border</code>.</p></li>
<li><p>In most cases there should either be <code>pie.border</code> <em>or</em> <code>frame.color</code>, however it is possible at some point that <code>frame.color</code> and <code>pie.border</code> will both need to be applied, and this function can handle it.</p></li>
<li>
<p>Note this process now draws three layers of polygons:</p>
<ol style="list-style-type: decimal"><li>each <code>pie.color</code> wedge fill color and no border</li>
<li>each <code>pie.border</code> wedge border color with no fill</li>
<li>overall <code>frame.color</code> border color with no fill</li>
</ol></li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.66.900" id="multienrichjam-0066900">multienrichjam 0.0.66.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0066900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-66-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-66-900"></a></h3>
<ul><li><p>changed to remove calls to <code><a href="https://rdrr.io/pkg/matrixStats/man/rowRanges.html" class="external-link">matrixStats::rowMaxs()</a></code> and <code><a href="https://rdrr.io/pkg/matrixStats/man/rowRanges.html" class="external-link">matrixStats::rowMins()</a></code> to use base functions instead. This change was due to several R crashes that appear to be bugs somewhere in the upstream packages, that also occurred on Mac OSX, and on linux, but in both scenarios involved R-3.6.1 which is not likely to gain support traction with other package authors. Understandable.</p></li>
<li>
<p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> fixed potential bug:</p>
<ul><li>When <code>row_split</code> is passed via <code>...</code> to the underlying <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>, it was not aligned to the order of <code>rownames(matrix)</code> to be displayed in the heatmap, therefore the rows were split in the wrong visual order.</li>
<li>
<code>row_split</code> is now a formal argument, and when supplied as a vector, the <code>names(row_split)</code> are used to align <code>rownames(matrix)</code> appropriately.</li>
</ul></li>
<li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code></p>
<ul><li>new argument <code>nodesets</code> to define a subset of nodes for which the reordering will be applied, which may be helpful when nodes in a nodeset are horizontal or vertical. In future, this option may be applied based upon the aspect ratio of nodes in a nodeset, or so that the <code>nodeSortBy</code> can be defined as a <code>list</code> named by <code>nodesets</code>. It gets complicated.</li>
<li>more output when <code>verbose=TRUE</code>
</li>
<li>minor added checks for layout, ensuring matrix input for layout will match <code>rownames(layout)</code> to <code>V(g)$name</code>, just in case the order is not identical.</li>
</ul></li>
<li>
<p><code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code></p>
<ul><li>reverted apparent regression which did not pass <code>...</code> to child function <code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code>, therefore the <code>colorV</code> color order was not properly used when called in this manner.</li>
</ul></li>
<li>
<p><code>rotate_igraph_nodes()</code></p>
<ul><li>Change default argument from <code>center="origin"</code> to <code>center="median"</code>. Rare change to argument default, justified by the change being fairly benign. Also the new default is more consistent with expectations, that nodes would be “rotated in place”. Practical outcome is the same, nodes are rotated exactly as before, but the coordinate range is more likely to remain consistent, when input layout is not already centered at coordinates <code>c(0, 0)</code>.</li>
<li>new argument <code>verbose=FALSE</code>
</li>
<li>minor added checks for layout, ensuring matrix input for layout will match <code>rownames(layout)</code> to <code>V(g)$name</code>, just in case the order is not identical.</li>
</ul></li>
<li>
<p><code><a href="../reference/rotate_coordinates.html">rotate_coordinates()</a></code></p>
<ul><li>Change default argument from <code>center="origin"</code> to <code>center="median"</code>. Rare change to argument default, justified by the change being fairly benign. Also the new default is more consistent with expectations, that coordinates would be “rotated in place”. Practical outcome is the same, points are rotated exactly as before, but the coordinate range is more likely to remain consistent, especially when input layout is not already centered at coordinates <code>c(0, 0)</code>.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.65.900" id="multienrichjam-0065900">multienrichjam 0.0.65.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0065900"></a></h2>
<p>Numerous changes were made to functions in order to improve the overall Cnet plot layout experience. New functions were developed offline that focus on layout specific to Cnet plots, useful for bipartite graphs in general.</p>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-65-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-65-900"></a></h3>
<ul><li>
<p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> and <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code></p>
<ul><li>new argument <code>plot_grid=FALSE</code> which optionally plots a grey grid in the background, with units equal to “percentage” across the layout coordinate range. This option is intended to help when manually adjusting node and node_set positions with <code><a href="../reference/nudge_igraph_node.html">nudge_igraph_node()</a></code> and <code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code>, both of which take units <code>x,y</code> in the form of fraction of the overall layout dimensions.</li>
</ul></li>
<li>
<p><code><a href="../reference/nudge_igraph_node.html">nudge_igraph_node()</a></code></p>
<ul><li>new argument <code>nodes_xy</code> is intended to help enter adjustments when many nodes need to be nudged. The <code>list</code> is named by node (e.g. by gene), and contains x,y coordinate adjustments. It is completely equivalent to entering <code>node</code>, <code>x</code>, <code>y</code> as three independent vectors, but may be easier to use.</li>
<li>argument default changed from <code>use_grep=TRUE</code> to <code>use_grep=FALSE</code>, because nudging a node <code>"A"</code> should not also nudge every node that contains an <code>"a"</code> or <code>"A"</code>. This rare change in default argument value seems more helpful to avoid erroneous moves by default.</li>
</ul></li>
<li>
<p><code><a href="../reference/layout_with_qfr.html">layout_with_qfr()</a></code></p>
<ul><li>new argument <code>constrain</code> which takes a <code>character</code> vector of node names, then ensures those node coordinate positions are properly configured in <code>constraints</code> so they do not move during iterative layout.</li>
<li>new default behavior is to define <code>init</code> using the current graph layout stored in <code>igraph::graph_attr(g, "layout")</code>, instead of using a random circular initial layout.</li>
</ul></li>
<li>
<p><code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> internal function <code>inner_pie_border</code></p>
<ul><li>new experimental argument <code>inner_pie_border</code> is intended to draw the pie wedge border on the inside of the pie wedge shape, so it does not directly overlap the border of an adjacent pie wedge shape. I could not find a polygon function in R that can draw borders on the inside edge of the polygon, which is surprising considering the considerable effort to draw GIS world maps in R. Any adjacent borders are directly overwritten, with no option for borders to be displayed side-by-side along the polygon edge. Seems like an opportunity for someone.</li>
<li>nonetheless this capability is not yet implemented, but the framework is in place to be released soon.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_legend.html">mem_legend()</a></code></p>
<ul><li>new arguments <code>do_directional</code>, <code>directional_column</code>, and <code>directional_colors</code> are intended to add new directional circles indicating up- and down-regulation.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-65-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-65-900"></a></h3>
<ul><li>
<code><a href="../reference/plot_layout_scale.html">plot_layout_scale()</a></code> plots a grey grid background to an igraph plot indicating percentage units across the range of layout coordinates.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.64.900" id="multienrichjam-0064900">multienrichjam 0.0.64.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0064900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-64-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-64-900"></a></h3>
<ul><li><p><code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> argument <code>sortAttributes</code> now includes <code>"frame.color"</code> in order to include <code>"pie.border"</code> for pie shape nodes, and <code>"frame.color"</code> for nodes overall.</p></li>
<li>
<p><code><a href="../reference/list2im.html">list2im()</a></code> and <code><a href="../reference/list2imSigned.html">list2imSigned()</a></code></p>
<ul><li>new argument <code>emptyValue</code> to control how empty incidence entries should appear, either as zero <code>0</code>, or as <code>NA</code>. This update fixes rare issue where missing enrichment P-values were reported as zero <code>0</code> instead of <code>1</code> by default.</li>
<li>These functions appear in <code>venndir</code> package, however we do not want to make this package dependent upon <code>venndir</code> just yet, so they remain here for now. In <code>venndir</code> these functions are named: <code><a href="https://rdrr.io/pkg/venndir/man/list2im_opt.html" class="external-link">venndir::list2im_opt()</a></code> and <code><a href="https://rdrr.io/pkg/venndir/man/list2im_value.html" class="external-link">venndir::list2im_value()</a></code>.</li>
</ul></li>
<li><p><code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code> now uses <code>sortAttributes=NULL</code> default, when it is NULL it uses defaults from <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code>. Previously there was inconsistent defaults between the two functions.</p></li>
<li>
<p><code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> and <code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code></p>
<ul><li>new arguments <code>geneIMdirection</code>, <code>enrichIMdirection</code> are used to call new function <code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code> to colorize node borders by default when data is available.</li>
</ul></li>
<li><p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> now calls <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> and no longer edits colors itself, those steps are performed by <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code>; no longer calls <code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code>.</p></li>
<li>
<p><code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code></p>
<ul><li>now applies exact <code>colorV</code> colors to <code>geneIMcolors</code> without calling <code><a href="https://rdrr.io/pkg/colorjam/man/matrix2heatColors.html" class="external-link">colorjam::matrix2heatColors()</a></code> since that process returned slightly darker colors by default, and for little benefit.</li>
<li>new argument <code>geneHitIM</code> intended to allow directional hit matrix to be supplied, thus enabling other features as described above, specifically colorized border on Cnet <code>igraph</code> plots.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-64-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-64-900"></a></h3>
<ul><li>
<p><code><a href="../reference/apply_cnet_direction.html">apply_cnet_direction()</a></code></p>
<ul><li>colorizes node border, pie.border, coloredrect.border based upon directionality, using <code>geneIMdirection</code> and <code>enrichIMdirection</code> when available.</li>
</ul></li>
<li><p><code><a href="../reference/reorderIgraphNodes.html">reorder_igraph_nodes()</a></code> is step one in migrating function names away from camelCase, toward snake_case. Not really a new function, but a new function name.</p></li>
<li><p><code><a href="../reference/memIM2cnet.html">mem2cnet()</a></code> is a similar rename of <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> which mostly takes <code>mem</code> as input instead of <code>memIM</code> anyway.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.63.900" id="multienrichjam-0063900">multienrichjam 0.0.63.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0063900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-63-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-63-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code></p>
<ul><li>The attribute <code>"caption"</code> is formatted more cleanly.</li>
<li>New returned attribute <code>"draw_caption"</code> which is a function that draws the caption in the bottom-right corner of the heatmap, mainly because this location is least likely to overlap other heatmap labels. The location and style can be customized as needed.</li>
</ul></li>
<li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code></p>
<ul><li>argument <code>sortAttributes</code> was updated to include <code>"pie.border"</code> in the default sort order, for future when Cnet nodes also include border color with the direction of change.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.62.900" id="multienrichjam-0062900">multienrichjam 0.0.62.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0062900"></a></h2>
<div class="section level3">
<h3 id="changes-0-0-62-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-62-900"></a></h3>
<ul><li><p>bumped dependency on <code>jamba</code> to 0.0.87.900 to pick up all the recent updates.</p></li>
<li>
<p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code></p>
<ul><li>new argument <code>cluster_rows</code> to control row clustering, specifically to allow no row clustering.</li>
<li>new argument <code>do_plot=TRUE</code> to honor <code>do_plot=FALSE</code> from <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code>
</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code></p>
<ul><li>Now generates its own caption that includes relevant clustering and filtering parameters used, helpful to reproduce the original result. Caption is returned as <code>attr(hm, "caption")</code>.</li>
</ul></li>
<li>
<p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code></p>
<ul><li>passes <code>do_plot</code> to <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code>
</li>
<li>uses <code>caption</code> generated by <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> and returns both the gene-pathway heatmap <code>gp_hm</code> and the caption <code>gp_hm_caption</code>. The caption is relevant because the parameters define the clusters represented in subsequent Cnet plots.</li>
</ul></li>
<li>
<p><code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code></p>
<ul><li>new argument <code>remove_blank_colnames=TRUE</code>, same as previous behavior, with new option to disable this behavior and keep columns with all values in <code>c(NA, "")</code>. We found <code>zScore</code> is sometimes reported as entirely <code>NA</code> but may be useful to keep, for consistency with other enrichment results.</li>
</ul></li>
<li><p><code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> no longer includes <code>...</code> when calling <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines()</a></code>, which should silence a fair number of harmless but annoying warning messages. We don’t need a warning message for everything, tysm.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-62-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-62-900"></a></h3>
<ul><li>
<p><code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> somehow broke in a recent <code>igraph</code> update, apparently the return type is no longer coerced to <code>character</code> vector, so needs to be converted directly.</p>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> and <code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code> were impacted as well.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> was modified to call <code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code>, then failing that call, will return the full <code>cnet_collapsed</code> graph without subset. Messages are printed for review.</li>
</ul></li>
<li><p><code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> initial work on allowing custom midpoints within node groups, which would allow defining a custom midpoint in x,y coordinates, which may or may not be between the two sets of nodes. Implementation is not in place yet, but in progress.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.61.900" id="multienrichjam-0061900">multienrichjam 0.0.61.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0061900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-61-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-61-900"></a></h3>
<ul><li><p><code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> was updated to improve the consistency of sorting by different node properties, specifically to allow sorting by node fill, and node border color(s).</p></li>
<li>
<p><code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code> is the function used to render node <code>shape="pie"</code> by <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code>, is an optimized, vectorized method to render nodes in one shot, rather than drawing each in a <code>for()</code> loop by default.</p>
<ul><li><p>Drawing even 20 or more <code>pie</code> nodes is substantially faster using <code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code> compared to default <code>igraph</code> function.</p></li>
<li><p>Speed was improved, the method of converting list of polygon coordinates to numeric vectors spaced by <code>NA</code> was much improved.</p></li>
<li><p>It can render <code>pie.border</code> for each pie wedge of each node with <code>shape="pie"</code> or <code>shape="jampie"</code>. Note that the outer line may be covered by subsequent <code>frame.color</code>. Attribute <code>pie.border</code> is expected to be a <code>list</code> where <code>lengths(pie.border)</code> are equal to <code>lengths(pie)</code>.</p></li>
<li><p>It can render <code>frame.color</code> around the full circle of each node with <code>shape="pie"</code> or <code>shape="jampie"</code>. This line may cover the <code>pie.border</code> if also drawn. Attribute <code>frame.color</code> is expected to have length equal to <code>igraph::vcount(g)</code> which is the total number of nodes, one <code>frame.color</code> value per node.</p></li>
<li>
<p>It is recommended to use one style or the other for each node:</p>
<ol style="list-style-type: decimal"><li>
<code>pie.border=NA</code>, and <code>frame.color="red"</code>
</li>
<li>
<code>pie.border=c("red", "gold")</code>, and <code>frame.color=NA</code>
</li>
</ol></li>
</ul></li>
<li><p>Internal function <code><a href="../reference/jam_mypie.html">jam_mypie()</a></code> is called by <code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code>, and was updated to handle <code>frame.color</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.60.900" id="multienrichjam-0060900">multienrichjam 0.0.60.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0060900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-60-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-60-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> default arguments changed:</p>
<ul><li>
<code>min_set_ct=1</code>, previously was 2</li>
<li>
<code>min_gene_ct=1</code>, previously was 2</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="minor-bug-fixes-0-0-60-900">minor bug fixes<a class="anchor" aria-label="anchor" href="#minor-bug-fixes-0-0-60-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> was not verifying <code>names(geneHitList)</code> also matched <code>names(enrichList)</code>, therefore a mismatch could cause downstream errors in <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> related functions. This issue now only uses <code>geneHitList</code> with names that match.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.59.900" id="multienrichjam-0059900">multienrichjam 0.0.59.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0059900"></a></h2>
<ul><li>added <code>amap</code> package as dependency, it provides <code><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">amap::hcluster()</a></code>.</li>
</ul><div class="section level3">
<h3 id="changes-to-existing-functions-0-0-59-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-59-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> verbosity was reduced when <code>verbose=FALSE</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-enhancements-0-0-59-900">bug fixes, enhancements<a class="anchor" aria-label="anchor" href="#bug-fixes-enhancements-0-0-59-900"></a></h3>
<ul><li><p><code>mem_gene_pathway_heatmap()</code> now honors <code>p_floor</code> when defining the incidence matrix values to be used in clustering the weighted and combined enrichment and heatmap gene-pathway incidence matrix data.</p></li>
<li>
<p><code>mem_gene_pathway_heatmap()</code> was throwing an error when supplying <code>column_split</code> and the default <code>cluster_columns=TRUE</code>.</p>
<ul><li>The error was caused by creating a dendrogram for <code>cluster_columns</code> then supplying <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> with a <code>character</code> vector <code>column_split</code>, and a dendrogram/hclust for <code>cluster_columns</code>. Instead it allows passing a <code>function</code> to <code>cluster_columns</code>, which also requires using custom data, since the data used for clustering is a weighted combination of the enrichment P-values across the top of the heatmap, and the data inside the heatmap.</li>
<li>The new default when <code>row_split</code> or <code>column_split</code> are <code>character</code> will be to define <code>cluster_rows</code> or <code>cluster_columns</code>, respectively, to a <code>function</code> that calls <code><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">amap::hcluster()</a></code> on the combined and weighted heatmap and respective annotation data matrices.</li>
</ul></li>
<li><p><code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> was not properly defining gene row cluster names for <code>mem_gene_pathway_heatmap()</code>, leaving them empty by default instead of assigning from <code>letters</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.58.900" id="multienrichjam-0058900">multienrichjam 0.0.58.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0058900"></a></h2>
<ul><li>bumped dependency to <code>jamba (&gt;= 0.0.84.900)</code> to retire <code><a href="https://rdrr.io/pkg/jamba/man/call_fn_ellipsis.html" class="external-link">call_fn_ellipsis()</a></code>
</li>
</ul><div class="section level3">
<h3 id="changes-to-existing-functions-0-0-58-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-58-900"></a></h3>
<ul><li>
<p><code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> were updated:</p>
<ul><li>
<code>nameColname</code> is handled properly, without relying upon <code>"Name"</code> colname, and without relying upon <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code> of the enrichment <code>data.frame</code>.</li>
<li>Now the subset operations use values in the <code>nameColname</code>.</li>
<li>Also the rows in each enrichment <code>data.frame</code> with values in <code>nameColname</code> are subset using <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code>, which means in some rare cases multiple rows might be returned, if the input enrichment data has the same name in <code>nameColname</code> for multiple rows. This change is intentional, in order to retain all rows with matching names, not just the first that occurs.</li>
</ul></li>
<li>
<p><code><a href="../reference/enrichList2geneHitList.html">enrichList2geneHitList()</a></code>:</p>
<ul><li>argument <code>geneDelim</code> has a default value, consistent with <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>
</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-58-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-58-900"></a></h3>
<ul><li>
<code><a href="../reference/enrichList2IM.html">enrichList2IM()</a></code> will return data with zero rows without error, although it usually occurs because of an error somewhere else (for example input data).</li>
</ul></div>
<div class="section level3">
<h3 id="functions-removed-0-0-58-900">functions removed<a class="anchor" aria-label="anchor" href="#functions-removed-0-0-58-900"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/pkg/jamba/man/call_fn_ellipsis.html" class="external-link">call_fn_ellipsis()</a></code> was moved to the jamba package version <code>0.0.84.900</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.57.900" id="multienrichjam-0057900">multienrichjam 0.0.57.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0057900"></a></h2>
<ul><li>Issue <a href="http://github.com/jmw86069/multienrichjam/issues/6" class="external-link">#6</a> reported an error when using a series of enrichments where only a subset contain a z-score column name for <code>directionColname</code>. Related, the current approach ignored the <code>directionColname</code> when all values were NA. Both situations have been corrected, to allow flexible mish-mash of NA and non-NA values, and presence/absence of <code>directionColname</code> in each enrichment input. Also related, <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> was by default no enabling the directionality via <code>mem_enrichment_heatmap(mem, apply_direction=TRUE)</code>, therefore there is a new argument to <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> default <code>apply_direction=NULL</code> which will auto-detect whether there is directional non-zero and non-NA values that can be used in the heatmap. Also, <code>apply_direction</code> can be defined on its own to force the issue.</li>
</ul></div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.56.900" id="multienrichjam-0056900">multienrichjam 0.0.56.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0056900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-56-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-56-900"></a></h3>
<ul><li>
<p>Issue <a href="http://github.com/jmw86069/multienrichjam/issues/7" class="external-link">#7</a> reported an error, traced back to the vignette. The error was caused by passing arguments to <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> by overloading <code>...</code>, when not all arguments were valid in <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>. The fix:</p>
<ul><li>new function <code><a href="https://rdrr.io/pkg/jamba/man/call_fn_ellipsis.html" class="external-link">call_fn_ellipsis()</a></code> which passes arguments including <code>...</code> to another function, and when that function arguments do not allow <code>...</code> then it limits the arguments in <code>...</code> to those arguments accepted by the other function.</li>
<li>Instead of: <code>x &lt;- some_function(a=1, b=2, ...)</code>
</li>
<li>Use: <code>x &lt;- call_fn_ellipsis(some_function, a=1, b=2, ...)</code>
</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> and <code>mem_gene_pathway_heatmap()</code> were updated to use <code><a href="https://rdrr.io/pkg/jamba/man/call_fn_ellipsis.html" class="external-link">call_fn_ellipsis()</a></code>.</li>
</ul></li>
<li><p>Another error was noted during the vignette workflow, that the <code>directionColname</code> was being populated even when no enrichment data contained non-NA values, which was inconsistent with <code><a href="../reference/find_colname.html">find_colname()</a></code> in function <code>enrich2IM()</code>. This situation was corrected by requiring only one enrichment result to contain a non-NA value in this column.</p></li>
<li><p><code><a href="../reference/enrichList2df.html">enrichList2df()</a></code>, <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>, <code><a href="../reference/enrichList2IM.html">enrichList2IM()</a></code> were updated to call <code><a href="../reference/find_colname.html">find_colname()</a></code> with the list of <code>enrichResult</code> objects.</p></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-56-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-56-900"></a></h3>
<ul><li>
<code><a href="../reference/find_colname.html">find_colname()</a></code> can accept a <code>list</code> object, which is expected to contain a list of <code>data.frame</code> and/or <code>enrichResult</code> objects. An <code>enrichResult</code> is converted to <code>data.frame</code> by <code>enrichResult@result</code>, all other objects must contain <code>colnames(x)</code>. When <code>require_non_na=TRUE</code> it will test each object, and return <code>max</code> unique entries that match <code>pattern</code>. The entries should all contain the same matching colnames for most purposes in <code>multienrichjam</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.55.900" id="multienrichjam-0055900">multienrichjam 0.0.55.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0055900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-55-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-55-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> was incorrectly populating empty gene counts with default <code>1</code> instead of <code>0</code>. The effect is mainly during filtering by gene count, where the minimum is usually never below <code>1</code>, however it can cause issues in point sizing particularly in <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code>. The previous default <code>1</code> is a remnant of using this function to generate a matrix of enrichment P-values.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-55-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-55-900"></a></h3>
<ul><li>
<code><a href="../reference/enrichList2IM.html">enrichList2IM()</a></code> argument default was changed to <code>emptyValue=NA</code> so in the absence of data to populate into the incidence matrix, the default cell value will be <code>NA</code> to indicate there is no available data.</li>
<li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> was updated to supply a specific <code>emptyValue</code> for all calls to <code><a href="../reference/enrichList2IM.html">enrichList2IM()</a></code>.</li>
<li>
<code><a href="../reference/cell_fun_bivariate.html">cell_fun_bivariate()</a></code> new argument <code>type</code> is intended to allow re-using this same function for univariate color functions, so heatmaps features can be made consistently, specifically for dotplot or normal heatmap output, and optionally labeling cells with statistical values.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> is updated to share common heatmap code for bivariate and univariate color gradients. One by-product is that output cannot be raster format, which is typically not an issue for pathway enrichment, since pathways should not represent more than 1,000 or so pathways. In that event, output should probably be rasterized (PNG, JPG) instead of vector graphics (PDF, SVG).</li>
<li>
<code><a href="../reference/make_legend_bivariate.html">make_legend_bivariate()</a></code> new argument <code>digits</code> used to prevent displaying weird labels like <code>5.9999999998</code> and instead will display <code>6</code>.</li>
<li>
<code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> default argument was changed to <code>edge_bundling="connections"</code> which will enable edge bundling by default. It can be disabled with <code>edge_bundling="none"</code>, although it is only active when there are edge connections that can be bundled.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.54.900" id="multienrichjam-0054900">multienrichjam 0.0.54.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0054900"></a></h2>
<div class="section level3">
<h3 id="updates-to-existing-functions-0-0-54-900">updates to existing functions<a class="anchor" aria-label="anchor" href="#updates-to-existing-functions-0-0-54-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> was updated to customize directional information in heatmaps. Cell labels are optionally displayed, defined by <code>show</code>, to display one or more of <code>z-score</code>, <code>-log10pvalue</code>, and <code>gene count</code>. Argument <code>sets</code> was updated to handle presence of <code>enrichIM</code> and <code>enrichIMgeneCount</code> and <code>enrichIMdirection</code> - as well as future measurements with prefix <code>enrichIM</code>. New argument <code>min_count</code> applies the gene count filter to the dot plot output heatmap.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.53.900" id="multienrichjam-0053900">multienrichjam 0.0.53.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0053900"></a></h2>
<p>This update mainly focuses on implementing directionality when available in the pathway enrichment data during <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>.</p>
<div class="section level3">
<h3 id="new-functions-0-0-53-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-53-900"></a></h3>
<ul><li>
<code><a href="../reference/colorRamp2D.html">colorRamp2D()</a></code> - implements bivariate color scale, in this case for enrichment <code>-log10pvalue</code> for color intensity, and <code>z-score</code> for color hue directionality: blue “inhibited”, gold “neutral”, and red “activated”.</li>
<li>
<code><a href="../reference/display_colorRamp2D.html">display_colorRamp2D()</a></code> - display the color ramp defined by <code><a href="../reference/colorRamp2D.html">colorRamp2D()</a></code>
</li>
<li>
<code><a href="../reference/cell_fun_bivariate.html">cell_fun_bivariate()</a></code> - define a heatmap cell function that uses the color defined by <code><a href="../reference/colorRamp2D.html">colorRamp2D()</a></code>, optionally plots circle points, and optional text labels</li>
<li>
<code><a href="../reference/make_legend_bivariate.html">make_legend_bivariate()</a></code> - creates a 2-D color ramp legend suitable for <code>ComplexHeatmap::draw(..., annotation_legend_list=x)</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-53-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-53-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> new argument <code>apply_direction=TRUE</code> will enable bivariate colors, where color intensity is defined by the enrichment -log10 P-value, and color hue is defined by z-score direction:</p>
<ul><li>blue = “inhibition” with z-score &lt;= -2</li>
<li>gold = “no direction” with z-score &gt; -2 and x score &lt; 2</li>
<li>red = “activation” with z-score &gt;= 2</li>
</ul></li>
</ul><p>Points are sized by number of genes.</p>
</div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.52.900" id="multienrichjam-0052900">multienrichjam 0.0.52.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0052900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-52-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-52-900"></a></h3>
<p>Moved some functions into their own .R file for better organization:</p>
<ul><li><p><code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> new arguments <code>directionColname</code> to define an optional column name that contains <code>numeric</code> values indicating direction of pathway enrichment. These values are often in the form of an <code>"Activation z-score"</code>, as is the case with IPA “Upstream Regulators”. Argument <code>direction_cutoff</code> refers to the absolute value required for direction be given a “sign” up or down.</p></li>
<li><p><code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> new argument <code>directionColname</code> used to determine directionality of pathway enrichment, useful for things like <code>"Activation z-score"</code>, as returned by IPA “Upstream Regulators”. Output included <code>mem$enrichIMdirection</code> which contains the <code>numeric</code> values, where <code>NA</code> values are substituted with <code>0</code> zero. These values will be used in near future, likely in <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> to indicate predicted direction of impact on particular pathways. Argument <code>direction_cutoff</code> is passed to <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> for optional filtering to require at least one pathway to contain an absolute direction score at or above this threshold. The IPA z-score recommends a threshold z=score &gt;= 2 for “activation” or “inhibition”. Note that many pathways have no z-score, so applying this threshold will remove those pathways from downstream analysis.</p></li>
<li><p><code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> new argument <code>apply_direction</code> and <code>direction_cutoff</code> determine whether to indicate direction if it exists, and optionally applies a threshold. Still in testing currently. Note that applying this cutoff will hide pathways whose <code>numeric</code> direction is below the threshold. New argument <code>gene_count_max</code> to apply a max gene count threshold for the point size for the dot plot format. New argument <code>legend_height</code> to control the heatmap legend color bar height.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.51.900" id="multienrichjam-0051900">multienrichjam 0.0.51.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0051900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-51-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-51-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> will now hide all but the main enrichment colors in color legends when there are more than 8 combinations, to prevent the legend from taking the entire plot device space and not displaying the heatmap. The threshold is configurable with <code>show_heatmap_legend=8</code>. New arguments <code>show_gene_legend</code>, <code>show_pathway_legend</code> are <code>logical</code> and are intended to allow hiding the other color legends. A minimalist style is to show only the main enrichment colors, which are used for all other colors anyway.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> was updated so the default dotplot format has properly controlled point sizes, and legend point sizes. Previously the two sizes were independent and required manual adjustment. The current approach ensures the legend point size exactly match the heatmap dot plot point size. An optional parameter <code>cexCellnote</code> will display labels unless <code>cexCellnote=0</code> in which case gene count labels are hidden.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.50.900" id="multienrichjam-0050900">multienrichjam 0.0.50.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0050900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-50-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-50-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_legend.html">mem_legend()</a></code> new argument <code>inset</code> passed to <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend()</a></code>. Also this function uses <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code> to try to pass <code>...</code> arguments, and if they fail it tries again without <code>...</code>. Fun.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.49.900" id="multienrichjam-0049900">multienrichjam 0.0.49.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0049900"></a></h2>
<div class="section level3">
<h3 id="extended-function-help-text-0-0-49-900">extended function help text<a class="anchor" aria-label="anchor" href="#extended-function-help-text-0-0-49-900"></a></h3>
<ul><li><p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> is a drop-in replacement for <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code>, and its options were described in much more detail. In brief:</p></li>
<li><p>it plots nodes vectorized which is substantially faster</p></li>
<li><p>it changes the default to <code>rescale=FALSE</code> and maintains aspect ratio 1:1, so layout coordinates are rendered without distorting the x- and y-axis ranges</p></li>
<li><p>it optionally bundles edge connections, which helps particularly with large bipartite graphs (especially gene-to-pathway graphs.)</p></li>
<li><p>it allows bulk adjustment to node size, label size, and label distance from node center.</p></li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-49-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-49-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new argument <code>edge_bundling="connections"</code> that by default will bundle edges appropriate for Cnet plots. Disable with <code>edge_bundling="none"</code>.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> new argument <code>style="dotplot"</code> will create a dotplot styled heatmap, whose points are sized proportional to the number of genes involved in enrichment. This style is under development and may require additional customization options such as setting a max gene count for point sizes.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-49-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-49-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> fixed bug where enrichment names were mangled by <code>data.frame(...)</code>, avoided by using <code>data.frame(check.names=FALSE, ...)</code>.</li>
</ul><p>Several functions were updated to include proper package prefix for function calls:</p>
<ul><li><code><a href="https://rdrr.io/pkg/matrixStats/man/rowRanges.html" class="external-link">matrixStats::colMins()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/V.html" class="external-link">igraph::V()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/E.html" class="external-link">igraph::E()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/degree.html" class="external-link">igraph::degree()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/components.html" class="external-link">igraph::components()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/gorder.html" class="external-link">igraph::vcount()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/neighbors.html" class="external-link">igraph::neighbors()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/vertex_attr_names.html" class="external-link">igraph::vertex_attr_names()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/graph_attr_names.html" class="external-link">igraph::list.graph.attributes()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/ego.html" class="external-link">igraph::ego()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/set_graph_attr.html" class="external-link">igraph::set_graph_attr()</a></code></li>
<li><code><a href="https://r.igraph.org/reference/graph_attr.html" class="external-link">igraph::graph_attr()</a></code></li>
</ul><p>affecting functions:</p>
<ul><li><code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code></li>
<li><code><a href="../reference/apply_nodeset_spacing.html">apply_nodeset_spacing()</a></code></li>
<li><code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code></li>
<li><code><a href="../reference/removeIgraphSinglets.html">removeIgraphSinglets()</a></code></li>
<li><code><a href="../reference/mem_find_overlap.html">mem_find_overlap()</a></code></li>
<li><code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code></li>
<li><code><a href="../reference/subgraph_jam.html">subgraph_jam()</a></code></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.48.900" id="multienrichjam-0048900">multienrichjam 0.0.48.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0048900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-48-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-48-900"></a></h3>
<ul><li>
<p><code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> was updated to handle edge cases:</p>
<ul><li>
<code>gene_im_weight</code> 0 or 1; <code>enrich_im_weight</code> 0 or 1</li>
<li>user-supplied <code>cluster_rows</code> or <code>cluster_columns</code> with <code>colorize_by_gene</code>
</li>
<li>The <code>colorize_by_gene</code> logic was changed to convert to an integer matrix that refers to colors and labels by factor levels, which helps for user-defined clustering methods, also helps labeling the color legend.</li>
<li>new argument <code>colramp</code> for user-defined color gradient.</li>
<li>
<code>row_title</code> is no longer assigned when user-defined argument is <code>NULL</code>. This workaround helps the edge case with <code>gene_im_weight=1</code> where the <code>row_split</code> is forced to have a limited number of values regardless what <code>row_split</code> integer value is sent, thus causing <code>row_title</code> mismatch in length.</li>
<li>Fixed egregious type in second part of an <code>if</code> statement, only called when user supplies a custom cluster function.</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.47.900" id="multienrichjam-0047900">multienrichjam 0.0.47.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0047900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-47-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-47-900"></a></h3>
<ul><li>
<code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> was not correctly handling multiple <code>sourceColnames</code> values, instead was only using the first value. This bug has been corrected.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-47-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-47-900"></a></h3>
<ul><li><ul><li>
<code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> now return <code>enrichResult</code> when supplied with <code>enrichResult</code>, instead of coercing to <code>data.frame</code> which would then need to be converted back to <code>enrichResult</code>.</li>
</ul></li>
<li>
<code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> argument default <code>sourceColnames</code> was changed to reflect usage with R package <code>msigdbr</code> for MSigDB gene set data, specifically <code>sourceColnames=c("gs_cat", "gs_subcat")</code>. Similarly, default values were removed from <code>curateFrom</code> and <code>curateTo</code>, since these defaults imposed a specific outcome.</li>
<li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> default values for <code>topEnrichCurate*</code> arguments were changed to NULL; default argument values changed to <code>topEnrichSources=c("gs_cat", "gs_subat")</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.46.900" id="multienrichjam-0046900">multienrichjam 0.0.46.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0046900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-46-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-46-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> new argument <code>rotate_heatmap=TRUE</code> will rotate the heatmap layout so pathway names are displayed as rows, and genes are displayed as columns.</li>
</ul><p>I still need example data to use for function document examples, to show utility of rotating the gene-pathway heatmap.</p>
</div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.45.900" id="multienrichjam-0045900">multienrichjam 0.0.45.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0045900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-45-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-45-900"></a></h3>
<ul><li>
<code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code> was implemented twice (smh) so the older function was renamed <code><a href="../reference/color_edges_by_nodes_deprecated.html">color_edges_by_nodes_deprecated()</a></code>. The older function blended colors using a simpler approach with <code><a href="../reference/avg_colors_by_list.html">avg_colors_by_list()</a></code> that took a very fast hue average; while the new function uses <code><a href="https://rdrr.io/pkg/colorjam/man/blend_colors.html" class="external-link">colorjam::blend_colors()</a></code> that uses red-yellow-blue additive color blending model. Honestly the function <code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code> is not used much yet, but is likely to be used more with community detection, and Cnet/community edge bundling. The new <code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code> also applies alpha to the intermediate blended colors, to retain the relative weight of colors during the blending step.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.44.900" id="multienrichjam-0044900">multienrichjam 0.0.44.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0044900"></a></h2>
<p>The edge bundling update!</p>
<p>The new functions are under rapid development, and represent potentially quite useful functions for visualizing complex <code>igraph</code> networks, specifically Cnet plots with Gene and Set node types.</p>
<p>The general technique of bundling edges between two groups of nodes is relatively stable. The details and extent that edges are bundled, including visual display of bundled edges, is under active evaluation and development. So far it doesn’t seem to take much to improve the output figure, compared to using straight edges.</p>
<p>In the near future, Cnet plots may by default enable some form of edge bundling, as Cnet plots were in fact the motivating example.</p>
<p>See pkgdown docs for <code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> for visual examples using the Karate network.</p>
<div class="section level3">
<h3 id="current-issues-in-edge-bundling-0-0-44-900">current issues in edge bundling<a class="anchor" aria-label="anchor" href="#current-issues-in-edge-bundling-0-0-44-900"></a></h3>
<p><code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> is the core function, and it does not yet implement:</p>
<ul><li>edge clipping based upon igraph vertex shape, for example using <code>igraph:::.igraph.shapes[["circle"]]$clip()</code>.</li>
<li>edge arrows, which requires edge clipping for proper usage, otherwise edge arrows will be underneath the node shape itself.</li>
<li>edge labels, which could be implemented, except that bundled edges are by definition much more likely to be too close for effective labels. I rarely use edge labels, so I will target the simplest thing that works.</li>
</ul></div>
<div class="section level3">
<h3 id="new-igraph-edge-bundling-functions-0-0-44-900">new igraph edge bundling functions<a class="anchor" aria-label="anchor" href="#new-igraph-edge-bundling-functions-0-0-44-900"></a></h3>
<ul><li>
<code><a href="../reference/get_bipartite_nodeset.html">get_bipartite_nodeset()</a></code> - is a general use function to return nodes that are grouped by having identical node neighbors. This situation usually happens rarely, except with bipartite graphs where there are often clusters of nodes with the same neighbors, especially common for Cnet plot data.</li>
<li>
<code><a href="../reference/edge_bundle_bipartite.html">edge_bundle_bipartite()</a></code> is the first edge bundling function, it is actually a light wrapper around <code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code>. Bipartite bundling connects a nodeset (defined as having the same neighbor nodes) to each neighbor node.</li>
<li>
<code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> is a general edge bundling technique that bundles edges between node groups. These node groups can be defined by any relevant technique, typically a community detection algorithm such as <code><a href="https://r.igraph.org/reference/cluster_walktrap.html" class="external-link">igraph::cluster_walktrap()</a></code> or any other of several <code>igraph::cluster_*</code> functions.</li>
</ul></div>
<div class="section level3">
<h3 id="new-igraph-functions-0-0-44-900">new igraph functions<a class="anchor" aria-label="anchor" href="#new-igraph-functions-0-0-44-900"></a></h3>
<ul><li>
<code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code> is a simple function that blends the colors of the two nodes involved in each edge, using <code><a href="https://rdrr.io/pkg/colorjam/man/blend_colors.html" class="external-link">colorjam::blend_colors()</a></code> since it uses RYB color blending. It is optimized so it only blends unique combinations of colors.</li>
</ul></div>
<div class="section level3">
<h3 id="new-utility-functions-0-0-44-900">new utility functions<a class="anchor" aria-label="anchor" href="#new-utility-functions-0-0-44-900"></a></h3>
<ul><li>
<code><a href="../reference/deconcat_df2.html">deconcat_df2()</a></code> is a necessary utility function that “expands” a <code>data.frame</code> that has one or more columns with multiple delimited values. It simply expands the rows to represent one individual value per row for those columns. This function will very likely be moved into the <code>"jamba"</code> package for much broader use.</li>
<li>
<code><a href="../reference/handle_igraph_param_list.html">handle_igraph_param_list()</a></code> is a helper function for <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> which is intended to update node and edge attributes in bulk based upon another attribute. For example “make all the Gene nodes small, and all the Set nodes large.” Same with labels, colors, etc.</li>
</ul></div>
<div class="section level3">
<h3 id="updates-to-existing-functions-0-0-44-900">updates to existing functions<a class="anchor" aria-label="anchor" href="#updates-to-existing-functions-0-0-44-900"></a></h3>
<ul><li><p><code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> has new arguments:</p></li>
<li><p><code>edge_bundling</code> - for <code>"nodegroups"</code>, <code>"connections"</code> and <code>"none"</code> This argument will enable edge bundling by calling <code><a href="../reference/edge_bundle_nodegroups.html">edge_bundle_nodegroups()</a></code> and <code><a href="../reference/get_bipartite_nodeset.html">get_bipartite_nodeset()</a></code> when needed. See examples.</p></li>
<li><p><code>render_nodes,render_edges,render_nodelabels,render_nodegroups</code> are options to skip various aspects of <code>igraph</code> plot features, either to save time, or to allow more detailed visual layering.</p></li>
<li><p><code>vectorized_node_shapes</code> toggle the vectorized node shape plotting when there is more than one node shape in the <code>igraph</code> object. Note this feature is <em>substantially</em> faster, but changes the order that nodes are rendered, by design. As a result, nodes are drawn in order of shape, so each render is a bulk operation. For nodes that overlap, or partially overlap, this feature will visibly change the ordering of nodes. In general, speed is still ideal, and reducing node layout overlaps should be a separate step.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.43.900" id="multienrichjam-0043900">multienrichjam 0.0.43.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0043900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-43-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-43-900"></a></h3>
<ul><li>
<code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code> logic was updated for <code>expand</code> which was not properly applying negative values to compress the spacing between nodes in a node set. This use is relatively rare but feasible.</li>
<li>
<code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code> argument <code>set_nodes</code> now optionally allows referring to a nodeset using the name of one node contained in the nodeset, as a convenience.</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-43-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-43-900"></a></h3>
<ul><li>
<code><a href="../reference/apply_nodeset_spacing.html">apply_nodeset_spacing()</a></code> attempts to automate the process of applying <code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code> for each subcluster of nodes in a Cnet plot to enforce a minimum spacing between nodes. The Fruchterman-Reingold layout algorithm might offer a minimum distance threshold, but I could not find it. Incidentally, this new function can also compress node spacing, which might be useful when gene labels are not shown.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.42.900" id="multienrichjam-0042900">multienrichjam 0.0.42.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0042900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-42-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-42-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> has much more detailed help text, describing more details about clustering parameters, and describing the returned objects in detail.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new argument <code>do_plot=TRUE</code> determines whether each plot is rendered, or just returned as a plot object to be reviewed separately.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> the returned data now includes the gene-pathway heatmap caption, which descibes the gene/set filtering criteria, and the row/column distance methods used for clustering. Since these arguments have substantial effect on the pathway clusters, it is helpful to keep this information readily available. Similarly, the <code>cnet</code> plots as <code>igraph</code> objects store the title as a graph attribute, accessible using <code>graph_attr(cnet, "title")</code>.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> argument <code>colorize_by_gene=TRUE</code> now uses <code><a href="https://rdrr.io/pkg/colorjam/man/blend_colors.html" class="external-link">colorjam::blend_colors()</a></code>.</li>
<li>
<code>mem_gene_pathway_heatmap()</code> is tolerant of <code>'...'</code> entries not valid with <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>, in order to allow overloading <code>'...'</code> for other function arguments.</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-42-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-42-900"></a></h3>
<ul><li>
<code><a href="../reference/nudge_igraph_node.html">nudge_igraph_node()</a></code> is intended to help move individual nodes in an <code>igraph</code> layout, useful for adjusting nodes to reduce label overlaps.</li>
<li>
<code><a href="../reference/get_cnet_nodeset.html">get_cnet_nodeset()</a></code> is a helper function to get the nodes in a nodeset, defined as the <code>"Gene"</code> nodes that all connect to the same <code>"Set"</code> nodes. It is helpful when looking at a Cnet plot, and wanting easy access to the <code>"Gene"</code> nodes in a particular cluster of nodes in the plot.</li>
<li>
<code><a href="../reference/adjust_cnet_nodeset.html">adjust_cnet_nodeset()</a></code> is intended to manipulate the layout coordinates for nodes in a nodeset, useful to expand, shift, or rotate nodes to help with visibility.</li>
<li>
<code><a href="../reference/adjust_cnet_set_relayout_gene.html">adjust_cnet_set_relayout_gene()</a></code> is a very useful function with complicated name. It is intended to help move <code>Set</code> nodes in a Cnet <code>igraph</code> layout, then re-positions all the <code>Gene</code> nodes while keeping the <code>Set</code> nodes in fixed positions.</li>
<li>
<code><a href="../reference/rotate_igraph_layout.html">rotate_igraph_layout()</a></code> which allows rotating an <code>igraph</code> layout. It can also reflect layout coordinates across one or more axes. It also calls other helper functions as needed, <code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code> and <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code>.</li>
<li>
<code><a href="../reference/rotate_coordinates.html">rotate_coordinates()</a></code> is the underlying function to rotate coordinates, it operates on a numeric matrix and is called by <code><a href="../reference/rotate_igraph_layout.html">rotate_igraph_layout()</a></code>.</li>
</ul><p>The next version should include <code>plot_cnet_heatmaps()</code> which creates nice Cnet cluster plots where each cluster has a corresponding expression heatmap displayed at the edge of the figure.</p>
</div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.41.900" id="multienrichjam-0041900">multienrichjam 0.0.41.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0041900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-41-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-41-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> returns <code>NULL</code> when there is an error during the Cnet collapse step, and does not report the error. Now it at least reports the error. The underlying cause in this case was ComplexHeatmap not accepting horizontal color legend orientation in R-3.6.1 (grid package version 3.6.1) because of some new unit arithmetic only available in grid 4.0.0+. Hiding the color legend, or using vertical color legend fixed the issue.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.40.900" id="multienrichjam-0040900">multienrichjam 0.0.40.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0040900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-40-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-40-900"></a></h3>
<ul><li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> - fixed error when using <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> on a matrix that had one row or one column.</li>
<li>
<code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code> fixed issue when the Cnet igraph object has no internal layout, it runs <code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code> by default.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-40-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-40-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> now returns <code>clusters_mem</code> in the <code>list</code>, which includes the pathway set names represented in each cluster shown in the gene-pathway incidence matrix heatmap.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.39.900" id="multienrichjam-0039900">multienrichjam 0.0.39.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0039900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-39-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-39-900"></a></h3>
<ul><li>
<code><a href="../reference/cnetplot_internalJam.html">cnetplot_internalJam()</a></code> was updated to include <code>"nodeType"</code> as a node attribute, which helps distinguish <code>"Gene"</code> and <code>"Set"</code> nodes in downstream operations. This change helps address <a href="http://github.com/jmw86069/multienrichjam/issues/5" class="external-link">#5</a> to hide the gene labels on Cnet plots.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.38.900" id="multienrichjam-0038900">multienrichjam 0.0.38.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0038900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-38-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-38-900"></a></h3>
<ul><li>Update to address issue <a href="http://github.com/jmw86069/multienrichjam/issues/4" class="external-link">#4</a> in <code><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code> with new argument <code>descriptionColname</code> which will force the resulting colname to be <code>"Description"</code> to fit expectations of <code>enrichplot:::fortify.internal()</code> which requires <code>df$Description</code>. When <code>descriptionColname</code> is not supplied, or not found in the input <code>enrichDF</code> a warning is issued that describes the problem.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-0-38-900">enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-38-900"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">heatmap_row_order()</a></code> and <code><a href="https://rdrr.io/pkg/jamba/man/heatmap_column_order.html" class="external-link">heatmap_column_order()</a></code> now also work with <code>HeatmapList</code> objects. By default they use the first heatmap in the list, which should be consistent with all other heatmaps.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.37.900" id="multienrichjam-0037900">multienrichjam 0.0.37.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0037900"></a></h2>
<div class="section level3">
<h3 id="bug-fixed-0-0-37-900">bug fixed<a class="anchor" aria-label="anchor" href="#bug-fixed-0-0-37-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> argument <code>subsetSets</code> was never implemented; existing arguments <code>descriptionGrep</code> and <code>nameGrep</code> were used for similar but insufficient purpose. The <code>subsetSets</code> argument defines specific pathway names to retain for analysis, and is implemented through <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> and by proxy <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code>. These functions might better be called <code>subsetEnrichResult()</code> and <code>subsetEnrichList()</code>, but will not rename these functions.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-0-37-900">enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-37-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> includes the number of rows (genes) and columns (pathways) displayed in the gene-pathway incidence matrix heatmap.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.36.900" id="multienrichjam-0036900">multienrichjam 0.0.36.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0036900"></a></h2>
<div class="section level3">
<h3 id="bug-fixed-0-0-36-900">bug fixed<a class="anchor" aria-label="anchor" href="#bug-fixed-0-0-36-900"></a></h3>
<ul><li>
<code><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code> was updated to fix <a href="http://github.com/jmw86069/multienrichjam/issues/3" class="external-link">#3</a>, thanks to <a href="http://github.com/john-lee-johnson" class="external-link">@john-lee-johnson</a> for reporting. Issue arose because <code><a href="https://rdrr.io/pkg/enrichplot/man/cnetplot.html" class="external-link">enrichplot::cnetplot()</a></code> expected enrichResult rownames to be equal to values in the <code>"ID"</code> column of the enrichment <code>data.frame</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-36-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-36-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> new argument <code>min_count</code> requires a pathway to contain at least <code>min_count</code> genes in order to be considered a “hit”. This filter is mostly important when used with <code>topEnrichN</code> to use the top pathways – it will only sort pathways then take the top <code>topEnrichN</code> number of pathways that also contain at least <code>min_count</code> genes.</li>
<li>
<code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> new arguments <code>min_count</code>, <code>p_cutoff</code> require pathways to contain at least <code>min_count</code> genes, and have no higher than <code>p_cutoff</code> enrichment P-Value. Previously these functions only took the top pathways, regardless of these filters (which were applied later). This change allows the filters to be applied before taking the top <code>topEnrichN</code> pathways, which mostly helps when <code>min_count</code> is greater than 1 – sometimes pathways with only one gene involved in enrichment have statistically significant P-value, but are not biologically relevant for interpretation or follow-up experiments. For <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> the filter is applied to each enrichment in the list, and any pathways meeting the criteria are taken for all enrichment lists. So a pathway must be present in the top <code>topEnrichN</code> entries which meet both the <code>p_cutoff</code> and <code>min_count</code> criteria to be retained by these functions.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.35.900" id="multienrichjam-0035900">multienrichjam 0.0.35.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0035900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-35-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-35-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> was updated to fix a small issue with <code>min_set_ct_each</code> which requires at least one enrichment to have <code>min_set_ct_each</code> genes. However, this filter was not applied alongside the <code>p_cutoff</code> – therefore some pathways with enough genes which were not significantly enriched were fulfilling these criteria, as along as another enrichment was significant. The new behavior (as expected) is to requires an pathway to meet both the <code>min_set_ct_each</code> and <code>p_cutoff</code> thresholds in the same enrichment in order to be retained in the gene-pathway incidence matrix.</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> fixed edge case where genes present in multiple enrichments counted more toward <code>min_set_ct_each</code>, but should only count once per gene.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-35-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-35-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> new arguments <code>column_title</code>, and <code>row_title</code> allow custom cluster names, which are also carried to Cnet cluster names as needed.</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> was updated to handle <code>row_split</code> and <code>column_split</code> arguments more intuitively, and to allow <code>row_split</code> values <code>FALSE</code>,<code>0</code>,<code>1</code> to inactivate the split completely. Previously it was not possible to turn off split.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> argument was renamed from <code>pathway_row_split</code> to <code>gene_row_split</code> to reflect the intent of this argument more accurately. This change is early in the function lifecycle and not in broader use yet – better to change it now. Otherwise, future argument name changes will not occur without some type of backward compatibility.</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>, <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> and <code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new arguments <code>row_cex</code> and <code>column_cex</code> used to adjust row and column heatmap labels, which is helpful when used with auto-sized axis labels to make minor adjustments.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> was updated to make the color ramp more consistent with <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>, so the color scale atop the gene-pathway heatmap more accurately reflects the color scale used in the enrichment heatmap itself.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.34.900" id="multienrichjam-0034900">multienrichjam 0.0.34.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0034900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-34-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-34-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> new argument <code>colorize_by_gene=TRUE</code> will color the heatmap body using blended colors from the <code>geneIMcolors</code> which represents the enrichments in which the gene is involved. The default <code>colorize_by_gene=FALSE</code> instead colors the heatmap body by the number of enrichments, which can be confusing if one of the enrichment colors is also red. The goal is to make it visually apparent when a gene is involved in one enrichment, by using the color from that enrichment. This feature is still in development and testing.</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> changed argument name from <code>enrich_gene_weight</code> to <code>enrich_im_weight</code>, before this argument is in wider use. Added new argument <code>gene_im_weight</code>. These arguments more accurately reflect the relative weight between enrichment and incidence matrix for <code>enrich_im_weight</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.33.900" id="multienrichjam-0033900">multienrichjam 0.0.33.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0033900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-33-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-33-900"></a></h3>
<ul><li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> was updated with new argument <code>cluster_color_min_fraction</code> to help filter the enrichment colors to include in each resulting cnet cluster. The intent is not to represent colors where the number of significant pathways is below this threshold. For example, a cluster of 10 pathways may have only one significant pathway for a given enrichment set – therefore this enrichment color would not be included in the cnet cluster colors.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.32.900" id="multienrichjam-0032900">multienrichjam 0.0.32.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0032900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-32-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-32-900"></a></h3>
<ul><li>
<p><code>mem_gene_pathway_heatmap()</code> cleaned up the heatmap overall:</p>
<ul><li>left and top annotations have zero gap between columns and rows</li>
<li>left and top annotation legends have discrete color bars; for left it is always <code>c(0,1)</code>; for the top it uses -log10 integer steps.</li>
<li>top annotation legend appends <code>"-log10P"</code> to the label, to indicate that the color values are based upon <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10()</a></code> transform of the enrichment P-value.</li>
<li>the color legend has discrete color bar steps, indicating the number of enrichments where each gene is involved</li>
</ul></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.31.900" id="multienrichjam-0031900">multienrichjam 0.0.31.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0031900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-31-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-31-900"></a></h3>
<ul><li>
<code>mem_gene_pathway_heatmap()</code> new argument <code>enrich_gene_weight</code> used to adjust the relative influence of the enrichment <code>-log10 P-value</code> and the gene incidence matrix on the column clustering. The effect is to adjust how much the enrichment P-values, or the gene content, affects the clusters. In principle both should have similar effects, but sometimes it helps to favor gene incidence or pathway enrichment.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.30.900" id="multienrichjam-0030900">multienrichjam 0.0.30.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0030900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-30-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-30-900"></a></h3>
<ul><li>
<code>mem_gene_pathway_heatmap()</code> was altered to allow filtering pathways for a minimum number of genes represented by at least one enrichment result. For example, a pathway may be required to have at least 4 genes, despite having a statistically significant enrichment P-value. The new argument <code>min_set_ct_each</code> tests each enrichment to see if any one has enough genes per pathway. There are two main effects of this filter: The gene-pathway heatmap will display fewer pathways; and any resulting Cnet plots will have the same pathways removed.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.29.900" id="multienrichjam-0029900">multienrichjam 0.0.29.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0029900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-29-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-29-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new argument <code>byCols</code> which is passed along to <code><a href="../reference/rank_mem_clusters.html">rank_mem_clusters()</a></code>, and is used to sort the pathway names within each Cnet cluster. The default uses <code>"composite_rank"</code>, which sorts by the <code>floor(-log10(pvalue))</code> then by the highest number of genes per pathway. The <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor()</a></code> function effectively sorts by the order of magnitude of the enrichment P-value, dropping the details. The obvious alternative is <code>"minp_rank"</code> which uses the <code>-log10(pvalue)</code> directly, which therefore does not effectively sort by gene count since enrichment P-values rarely tie. In our experience, between two pathways with reasonably similar enrichment P-value (within one order of magnitude such as 2.4e-5 and 3.5e-5) the pathway with more genes was usually the more interesting/relevant biological pathway.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.28.900" id="multienrichjam-0028900">multienrichjam 0.0.28.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0028900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-28-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-28-900"></a></h3>
<p><code><a href="../reference/im2list.html">im2list()</a></code> and <code><a href="../reference/imSigned2list.html">imSigned2list()</a></code> are the reciprocal functions to <code><a href="../reference/list2im.html">list2im()</a></code> and <code><a href="../reference/list2imSigned.html">list2imSigned()</a></code>. The new functions convert incidence matrix to list, or signed incidence matrix to list, respectively. They’re notable because they’re blazing fast in our testing, thanks to efficient methods from the <code>arules</code> R package for interconverting list to compressed logical matrix, and vice versa.</p>
</div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-28-900">changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-28-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> was modified to use <code>p_floor</code> as the ceiling for the row hierarchical clustering, previously it used <code>ceiling=3</code> which caused the dendrogram to have <code>height=0</code> when all enrichment results were lower than 0.001.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> was modified to calculate its own matrix colors when <code>color_by_column=TRUE</code>, until the <code><a href="https://rdrr.io/pkg/colorjam/man/matrix2heatColors.html" class="external-link">colorjam::matrix2heatColors()</a></code> can be updated to the improved method.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> now correctly honors <code>p_floor</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.27.900" id="multienrichjam-0027900">multienrichjam 0.0.27.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0027900"></a></h2>
<p>Added a new TODO.md file to track some new feature ideas.</p>
<div class="section level3">
<h3 id="new-functions-0-0-27-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-27-900"></a></h3>
<ul><li>
<code><a href="../reference/colors_from_list.html">colors_from_list()</a></code> infers the proper order of colors from a list of color vectors. It is called by <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> where attributes <code>"pie.color"</code> and <code>"coloredrect.color"</code> contain subsets of colors, but in the proper order. This function returns all colors in their proper order.</li>
<li>
<code><a href="../reference/colors_from_list.html">colors_from_list()</a></code> takes a list of colors, and returns the unique colors, ordered by the overall order inferred from the list. It is internally called by <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> when argument <code>colorV</code> is not suppleid, since the attribute <code>"pie.color"</code> can be used to infer the correct order of colors.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-27-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-27-900"></a></h3>
<ul><li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> now uses <code>"; "</code> as delimiter for the <code>"set_names"</code> attribute, to make it easier to distinguish individual pathway names.</li>
<li>
<code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> was refactored to handle specific color order defined either by argument <code>colorV</code> or by inferring the correct order of colors from attributes such as <code>"pie.color"</code>. This change should help order node colors more consistent to the original input colors to <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>, specifically the argument <code>colorV</code>.</li>
<li>
<code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> now has an example that shows the effects of ordering pie nodes by color.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.26.900" id="multienrichjam-0026900">multienrichjam 0.0.26.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0026900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-26-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-26-900"></a></h3>
<ul><li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> now includes the cluster name by default with the <code>set_labels</code> which are used to display the top <code>n</code> pathway names for each collapsed Cnet node. For example <code>"Cluster A: Aryl Hydrocarbons; Granzyme Signaling"</code>.</li>
<li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> arguments <code>max_labels</code> and <code>max_char_labels</code> accept multiple values, which are recycled and applied to filter each cluster. For example <code>max_labels=c(5,2)</code> will filter the first cluster to display up to 2 labels, and the second cluster to display up to 5 labels.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.25.900" id="multienrichjam-0025900">multienrichjam 0.0.25.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0025900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-25-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-25-900"></a></h3>
<ul><li>Thanks to <code>simang5c</code> the function calls to <code><a href="https://rdrr.io/pkg/jamba/man/renameColumn.html" class="external-link">renameColumn()</a></code> were corrected to <code><a href="https://rdrr.io/pkg/jamba/man/renameColumn.html" class="external-link">jamba::renameColumn()</a></code>, to resolve issue <a href="http://github.com/jmw86069/multienrichjam/issues/1" class="external-link">#1</a>. Also fixed several other references to <code>jamba</code> functions: <code><a href="https://rdrr.io/pkg/jamba/man/nameVector.html" class="external-link">nameVector()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/nameVectorN.html" class="external-link">nameVectorN()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/makeNames.html" class="external-link">makeNames()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/printDebug.html" class="external-link">printDebug()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/mixedSortDF.html" class="external-link">mixedSortDF()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/cPaste.html" class="external-link">cPaste()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/igrepHas.html" class="external-link">igrepHas()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/provigrep.html" class="external-link">provigrep()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/vigrep.html" class="external-link">vigrep()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/unvigrep.html" class="external-link">unvigrep()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/rbindList.html" class="external-link">rbindList()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/noiseFloor.html" class="external-link">noiseFloor()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/rmNA.html" class="external-link">rmNA()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/rmNULL.html" class="external-link">rmNULL()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/normScale.html" class="external-link">normScale()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/getColorRamp.html" class="external-link">getColorRamp()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/deg2rad.html" class="external-link">deg2rad()</a></code>. Omg! There were so many more cases than I thought! (Package-building options to import functions from packages seem to go too far, the imported functions appear to be contained in the new package which seems misleading… Ah well.)</li>
<li>Also made several small changes to handle single-enrichment input to multiEnrichMap(). It still provides some useful graphical benefits even with only one enrichment input.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.24.900" id="multienrichjam-0024900">multienrichjam 0.0.24.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0024900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-24-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-24-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> was updated to enable analysis with only one enrichment result. Testing whether the downstream capabilities are useful in the context of one enrichment result.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.23.900" id="multienrichjam-0023900">multienrichjam 0.0.23.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0023900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-23-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-23-900"></a></h3>
<ul><li>Several functions have additional <code><a href="https://rdrr.io/pkg/jamba/man/printDebug.html" class="external-link">jamba::printDebug()</a></code> output when <code>verbose=TRUE</code>.</li>
<li>
<code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code> and <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> new argument <code>use_shadowText=TRUE</code> will enable <code><a href="https://rdrr.io/pkg/jamba/man/shadowText.html" class="external-link">jamba::shadowText()</a></code> to replace <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">graphics::text()</a></code> for igraph text, which affects node and edge labels. The goal is to make labels more widely legible when they are placed on top of light and dark colors, common when using dark colored nodes on a white background.</li>
<li>
<code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> now tries harder to respect a pre-defined xlim and ylim, before using the range of layout coordinates</li>
<li>
<code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> slightly adjusted the number of pathway clusters to use based upon the number of columns in the gene-pathway matrix, slightly increasing the number for low number of columns.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new argument pathway_column_split allows setting a specific number of pathway clusters.</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> argument <code>do_which</code> allows creating only the requested plots from the full sequence of plots. This function is likely to become the core part of the analysis workflow:</li>
</ul><blockquote>
<p>gene-pathway heatmap -&gt; pathway clusters -&gt; Cnet using pathway clusters</p>
</blockquote>
</div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.22.900" id="multienrichjam-0022900">multienrichjam 0.0.22.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0022900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-22-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-22-900"></a></h3>
<ul><li>
<code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code> provides a new <code>igraph</code> vertex shape <code>"jampie"</code>. It is a complete clone to the default <code>igraph</code> shape <code>"pie"</code> except that it offers vectorized plotting, which can be substantially faster for large <code>igraph</code> objects that use <code>"pie"</code> nodes.</li>
<li>
<code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code> is a similar clone to <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph()</a></code> except that it uses vectorized plotting specifically when there are multiple shapes in the same <code>igraph</code> object. Formerly, each node is drawn individually which is substantially slower, especially for <code>igraph</code> objects with more than 100 nodes. It also by default converts shape <code>"pie"</code> to <code>"jampie"</code> in order to use vectorized plotting via <code><a href="../reference/shape.jampie.plot.html">shape.jampie.plot()</a></code> above.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-22-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-22-900"></a></h3>
<ul><li>
<code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> new argument <code>plot_function</code> allows use of custom plot function, specifically to use <code><a href="../reference/jam_plot_igraph.html">jam_plot_igraph()</a></code>.</li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-0-0-22-900">Other changes<a class="anchor" aria-label="anchor" href="#other-changes-0-0-22-900"></a></h3>
<ul><li>Functions for igraph vertex shapes were moved into a new .R file, and into a new function family <code>"jam igraph shapes"</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.21.900" id="multienrichjam-0021900">multienrichjam 0.0.21.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0021900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-21-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-21-900"></a></h3>
<ul><li>
<code><a href="../reference/grid_with_title.html">grid_with_title()</a></code> draws a grid object with title and optional subtitle, allowing for grid objects such as <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap</a></code> objects, or even multiple heatmaps. That said, any grid <code>"gTree"</code> object should work.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.20.900" id="multienrichjam-0020900">multienrichjam 0.0.20.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0020900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-20-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-20-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> is a new function that creates the current recommended folio of multienrichment plots:</li>
</ul><ol style="list-style-type: decimal"><li>Enrichment P-value heatmap</li>
<li>Gene-pathway heatmap – importantly with pathway clustering</li>
<li>Cnet using the pathway clusters, collapsed by cluster</li>
<li>Cnet using the pathway clusters, exemplar pathways per cluster</li>
<li>Cnet using each individual pathway cluster</li>
</ol></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-20-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-20-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> now includes <code>p_cutoff</code> in the output, which represents the enrichment P-value threshold used for the analysis. This cutoff is useful in making other color gradients respect the same threshold required for significant enrichment results, so P-values that do not meet this threshold can be colored white (or the background color.)</li>
<li>
<code><a href="../reference/mem_plot_folio.html">mem_plot_folio()</a></code> new argument (minor release) <code>do_which</code> to help produce selected plot pages from a folio of plots.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.19.900" id="multienrichjam-0019900">multienrichjam 0.0.19.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0019900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-19-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-19-900"></a></h3>
<ul><li>
<code><a href="../reference/collapse_mem_clusters.html">collapse_mem_clusters()</a></code> is an intriguing new method of simplifying the numerous pathways, by using each pathway cluster from <code>mem_gene_pathway_heatmap()</code>. Each cluster is condensed to one result, combining all genes in each cluster. The results are surprisingly insightful, especially when numerous pathways are present per cluster. This function also calls <code><a href="../reference/rank_mem_clusters.html">rank_mem_clusters()</a></code>, so it’s possible to pick a handful of the top pathways per cluster, as relevant.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.18.900" id="multienrichjam-0018900">multienrichjam 0.0.18.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0018900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-18-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-18-900"></a></h3>
<ul><li>
<code><a href="../reference/rank_mem_clusters.html">rank_mem_clusters()</a></code> is a convenience function which ranks pathways/sets within clusters, useful with a list of clusters following <code>mem_gene_pathway_heatmap()</code>. It makes it easier to rank pathways within a cluster, potentially choosing one exemplar pathway to represent each cluster. This function is part of more effort to streamline the overall analysis workflow.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-18-900">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-18-900"></a></h3>
<ul><li>Fixed small issue with <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code> which was properly applying <code>min_gene_ct</code> and <code>min_path_ct</code> however it did not check the resulting data to remove empty columns and rows. This change has been made.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.17.900" id="multienrichjam-0017900">multienrichjam 0.0.17.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0017900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-17-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-17-900"></a></h3>
<ul><li>
<code><a href="../reference/color_edges_by_nodes.html">color_edges_by_nodes()</a></code> takes an igraph, determines a color for each node based upon the shape (using <code>avg_colors_from_list()</code> for shape <code>"pie"</code> and <code>"coloredrectangle"</code>), then creates an average color between two nodes, and uses that as the edge color.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-17-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-17-900"></a></h3>
<ul><li>
<code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> has more configurable arguments, in the form of named lists. The driving example is <code>label_factor_l=list(nodeType=c(Gene=0.01, Set=1))</code>, that will apply <code>label.cex*0.01</code> to “Gene” nodes, and <code>label.cex*1.5</code> to “Set” nodes. Similar arguments: <code>node_factor_l</code> to apply to node size, and <code>label_dist_factor_l</code> to apply to label distance from node center.</li>
<li>
<code><a href="../reference/shape.coloredrectangle.plot.html">shape.coloredrectangle.plot()</a></code> was updated to fix a small bug in order of rendering colored rectangles, it was somehow drawing the frame after the fill colors, which caused the frames to overlap each other and appear transparent.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.16.900" id="multienrichjam-0016900">multienrichjam 0.0.16.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0016900"></a></h2>
<p>The vignette was updated to use the new functions, for a much cleaner overall workflow.</p>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-16-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-16-900"></a></h3>
<ul><li>
<code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> uses new function <code><a href="../reference/avg_colors_by_list.html">avg_colors_by_list()</a></code> to create one color to represent each node, then <code><a href="https://rdrr.io/pkg/colorjam/man/sort_colors.html" class="external-link">sort_colors()</a></code> to sort nodes by color hue, instead of previous behavior which sorted by the hex color string. This change affects attributes <code>"pie.color"</code>, <code>"coloredrect.color"</code> and <code>"color"</code>. Recall that this function <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code> is intended to help visually organize groups of nodes by their colors, to make it easier to tell how many nodes are each color.</li>
<li>
<code><a href="../reference/avg_colors_by_list.html">avg_colors_by_list()</a></code> now uses <code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean()</a></code> based upon the <code>"c"</code> channel (chroma, color saturation) in order to down-weight the effect of grey colors, which really should have no hue. The default weight for grey is 0.1, while the maximum value for fully saturated colors is 100. Blending <code>"green"</code> with <code>"grey30"</code> yields slightly less saturated green, as expected.</li>
<li>
<code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code> now includes convenience calls to <code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code>, <code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code>, <code><a href="../reference/reorderIgraphNodes.html">reorderIgraphNodes()</a></code>, and <code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code>. In almost all cases, creating a subset of a Cnet necessitates a new layout, which therefore requires new node ordering (sorting groups of equivalent nodes by color), and then label orientation (the angle used to offset the node label from the center of each node).</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-16-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-16-900"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/pkg/colorjam/man/sort_colors.html" class="external-link">sort_colors()</a></code> and <code><a href="../reference/order_colors.html">order_colors()</a></code> uses the <code><a href="https://farver.data-imaginist.com/reference/encode_colour.html" class="external-link">farver::encode_colour()</a></code> function to convert colors to HCL, then sorts by hue, and returns the original sorted vector or corresponding order, respectively. For sorting colors inside a <code>data.frame</code>, convert colors to a factor whose levels are <code>sort_colors(unique(colors))</code>, in order to maintain ties during multi-column sorting.</li>
<li>
<code>apply_color_cap()</code> imposes a numeric range onto a color channel for a vector or list of colors, using <code><a href="https://rdrr.io/pkg/jamba/man/noiseFloor.html" class="external-link">jamba::noiseFloor()</a></code>. Values outside the allowed range are forced to the range.</li>
<li>
<code><a href="../reference/subgraph_jam.html">subgraph_jam()</a></code> is a custom version of <code><a href="https://r.igraph.org/reference/subgraph.html" class="external-link">igraph::induced_subgraph()</a></code>, that correctly handles subsetting the graph layout when the graph itself is subsetted.</li>
<li>
<code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> is a custom <code>igraph::plot()</code> with proper sizing when <code>rescale=FALSE</code>, allowing better aspect ratios for certain network layout coordinates.</li>
<li>
<code><a href="../reference/with_qfr.html">with_qfr()</a></code> is a wrapper to <code><a href="../reference/layout_with_qfr.html">layout_with_qfr()</a></code> that returns a layout specification object, for use with <code><a href="https://r.igraph.org/reference/add_layout_.html" class="external-link">igraph::add_layout_()</a></code> in a more confusing workflow pattern than I expected.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.15.900" id="multienrichjam-0015900">multienrichjam 0.0.15.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0015900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-15-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-15-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> several updates to improve robustness in the overall workflow.</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-15-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-15-900"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">heatmap_row_order()</a></code> and <code><a href="https://rdrr.io/pkg/jamba/man/heatmap_column_order.html" class="external-link">heatmap_column_order()</a></code> provide enhanced output from <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/row_order-dispatch.html" class="external-link">ComplexHeatmap::row_order()</a></code>, mainly that they return the actual rownames and colnames of data in the heatmap. Very useful when the data used for the heatmap has been filtered internal to the function.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.14.900" id="multienrichjam-0014900">multienrichjam 0.0.14.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0014900"></a></h2>
<div class="section level3">
<h3 id="changes-to-existing-functions-0-0-14-900">Changes to existing functions<a class="anchor" aria-label="anchor" href="#changes-to-existing-functions-0-0-14-900"></a></h3>
<ul><li>
<code><a href="../reference/list2im.html">list2im()</a></code> removed argument <code>makeUnique</code> because the underlying conversion to matrix no longer requires that step, and it was a performance hit for extremely large lists. The argument <code>keepCounts</code> is the only requirement to maintain the count of each entry per list.</li>
<li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> now subsets the <code>geneIM</code> gene incidence matrix to match the genes after <code>topEnrichN</code> filtering is applied.</li>
<li>
<code><a href="../reference/layout_with_qfr.html">layout_with_qfr()</a></code> now by default will use edge attribute <code>"weight"</code> as the <code>weights</code> argument when calling <code><a href="https://rdrr.io/pkg/qgraph/man/qgraph.layout.fruchtermanreingold.html" class="external-link">qgraph::qgraph.layout.fruchtermanreingold()</a></code>.</li>
<li>
<code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code> was enhanced for more robust import conditions, specifically for different variations of missing IPA enrichment results. Also, empty colnames are removed, to help recognize the proper identifier in each scenario.</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-14-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-14-900"></a></h3>
<ul><li>
<code><a href="../reference/enrichList2geneHitList.html">enrichList2geneHitList()</a></code> takes a list of <code>enrichResult</code> and returns the list of genes represented in each <code>enrichResult</code>. Intended mainly for internal use by <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.13.900" id="multienrichjam-0013900">multienrichjam 0.0.13.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0013900"></a></h2>
<div class="section level3">
<h3 id="new-plotting-functions-0-0-13-900">New plotting functions<a class="anchor" aria-label="anchor" href="#new-plotting-functions-0-0-13-900"></a></h3>
<ul><li>
<code><a href="../reference/mem_multienrichplot.html">mem_multienrichplot()</a></code> allows customized enrichMap-style plotting of igraph objects. Notably, you can filter by Jaccard overlap, or by overlap count – the number of genes involved in the overlap. There are otherwise a lot of overlaps that involve only one gene, which is not the best way to build this type of network.</li>
<li>
<code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code> is a light extension of <code><a href="../reference/layout_with_qfr.html">layout_with_qfr()</a></code>, but adds default calls to <code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code>, and <code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code> to help things look pretty.</li>
<li>
<code><a href="../reference/mem_legend.html">mem_legend()</a></code> draws a color legend in the corner of a figure, using the colors defined in the <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> output.</li>
</ul></div>
<div class="section level3">
<h3 id="other-new-functions-0-0-13-900">Other new functions<a class="anchor" aria-label="anchor" href="#other-new-functions-0-0-13-900"></a></h3>
<ul><li>
<code><a href="../reference/subset_igraph_components.html">subset_igraph_components()</a></code> subsets an igraph based upon connected components – i.e. distinct subclusters.</li>
<li>
<code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> takes the pathway-gene incidence matrix and produces a Cnet plot <code>igraph</code> object. If given the output from <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> it will also color nodes using the gene and enrichment incidence matrix colors.</li>
<li>
<code><a href="../reference/avg_colors_by_list.html">avg_colors_by_list()</a></code> and <code><a href="../reference/avg_angles.html">avg_angles()</a></code> are intended for very rapid color blending.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.11.900" id="multienrichjam-0011900">multienrichjam 0.0.11.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0011900"></a></h2>
<div class="section level3">
<h3 id="bug-fixed-0-0-11-900">Bug fixed<a class="anchor" aria-label="anchor" href="#bug-fixed-0-0-11-900"></a></h3>
<ul><li>
<code>subsetCnetGraph()</code> was fixed to handle rare cases where pathway set name is identical to one or more genes, which happens with IPA pathway analysis, in the “Upstream Regulators” output.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.10.900" id="multienrichjam-0010900">multienrichjam 0.0.10.900<a class="anchor" aria-label="anchor" href="#multienrichjam-0010900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-10-900">New functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-10-900"></a></h3>
<ul><li>
<code>mem_gene_pathway_heatmap()</code> is a wrapper to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> which takes output from <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> and produces a heatmap styled similar to a pathway-gene incidence matrix. It includes row and column annotations to help interpret the results.</li>
<li>
<code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> produces a heatmap of the pathways and enrichment P-values for each comparison.</li>
<li>
<code><a href="../reference/spread_igraph_labels.html">spread_igraph_labels()</a></code> is a general use function for igraph objects, it takes an igraph network and associated layout, and arranges igraph nodes at an angel opposite the majority of edges from each node. The result arranges labels around the outside of the network, and typically away from other nodes. It isn’t perfect, but is visually a big step in the right direction.</li>
<li>
<code><a href="../reference/removeIgraphSinglets.html">removeIgraphSinglets()</a></code> is a simple function that removes nodes that have no edges. I found myself doing it manually enough times I wanted something quick and easy.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-0-10-900">enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-10-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> now includes two new edge attributes on MultiEnrichMap igraphs: overlap_count which contains the number of shared genes between two sets, and overlap_max_pct which contains the max percent overlap between two sets – based upon the # overlapped divided by the smaller of the two sets. The overlap_count is useful as an optional edge label, to show how many genes are involved.</li>
<li>
<code><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code> now forces <code>"setSize"</code> to contain integer values, useful when pathway size is inferred from something like gene ratio.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-0-10-900">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-10-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> was not properly assigning <code>colnames(memIM)</code>, although they were inferred from the <code>rownames(enrichIM)</code>. The bug was because <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> removes names from a character vector, and the conversion was done to enforce proper handling by <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code> which gives unexpected results when the list may contain a factor.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.9.900" id="multienrichjam-009900">multienrichjam 0.0.9.900<a class="anchor" aria-label="anchor" href="#multienrichjam-009900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-9-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-9-900"></a></h3>
<ul><li>
<code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code> no longer calls commandline <code>grep</code> to remove blank rows, for now it uses <code><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines()</a></code> and <code><a href="https://rdrr.io/pkg/jamba/man/vigrep.html" class="external-link">jamba::vigrep()</a></code> to select rows with at least one character.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.8.900" id="multienrichjam-008900">multienrichjam 0.0.8.900<a class="anchor" aria-label="anchor" href="#multienrichjam-008900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-8-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-8-900"></a></h3>
<ul><li>Fixed several calls to <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code> that failed when sent factors, which only happens when R <code>options("stringsAsFactors"=TRUE)</code> which is the default in base R. Now all calls to <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code> enforce <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> unless character type has already been enforced.</li>
<li>Added numerous package prefixes to functions, to avoid importing all package dependencies.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.7.900" id="multienrichjam-007900">multienrichjam 0.0.7.900<a class="anchor" aria-label="anchor" href="#multienrichjam-007900"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-7-900">bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-7-900"></a></h3>
<ul><li>
<code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> were updated to handle more default colnames for P-values, now including the default colnames for <code>enrichResult</code> objects <code>c("pvalue","padjust")</code>. When no sort columns are found, a warning message is printed.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-0-0-7-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-7-900"></a></h3>
<ul><li>Added documentation for <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> and other functions.</li>
<li>Added vignette describing the workflow starting with Ingenuity IPA enrichment results.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.6.900" id="multienrichjam-006900">multienrichjam 0.0.6.900<a class="anchor" aria-label="anchor" href="#multienrichjam-006900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-6-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-6-900"></a></h3>
<ul><li>
<code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code> imports Ingenuity IPA enrichment results, by default splitting each enrichment table into its own <code>data.frame</code>. It curates colnames to be consistent with downstream analyses.</li>
<li>
<code><a href="../reference/curateIPAcolnames.html">curateIPAcolnames()</a></code> will curate the colnames of IPA data, and ensures the values in the gene column are consistently delimited.</li>
<li>
<code><a href="https://rdrr.io/pkg/jamba/man/gsubs.html" class="external-link">gsubs()</a></code> is similar to <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">base::gsub()</a></code> except that it applies a vector of pattern-replacement operations in order. This function may be moved to the <code>"jamba"</code> package.</li>
<li>
<code><a href="../reference/find_colname.html">find_colname()</a></code> is a helper function to find a colname given a vector of expected values, which is matched directly, then case-insensitively, then as a vector of patterns to match the start, end, then any part of the colnames. By default the first matching value from the first successful method is returned. Good for matching c(“P-Value”, “pvalue”, “Pval”)</li>
<li>
<code><a href="../reference/topEnrichBySource.html">topEnrichBySource()</a></code> and <code><a href="../reference/topEnrichBySource.html">topEnrichListBySource()</a></code> subset the input pathway enrichment results by taking the top <code>n</code> result, then making sure the overall selected pathways are retained for all enrichment tables.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.5.900" id="multienrichjam-005900">multienrichjam 0.0.5.900<a class="anchor" aria-label="anchor" href="#multienrichjam-005900"></a></h2>
<div class="section level3">
<h3 id="changes-0-0-5-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-5-900"></a></h3>
<ul><li>
<code><a href="../reference/list2imSigned.html">list2imSigned()</a></code> is no longer dependent upon the input list <code>x</code> having names, nor having unique names.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-0-5-900">enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-5-900"></a></h3>
<ul><li>
<code><a href="../reference/isColorBlank.html">isColorBlank()</a></code> now handles list input, which is helpful when applied to igraph objects where <code>"pie"</code> colors are accessed as a list.</li>
<li>
<code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> was updated to use vectorized logic for <code>"pie"</code> vertex attributes.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.4.900" id="multienrichjam-004900">multienrichjam 0.0.4.900<a class="anchor" aria-label="anchor" href="#multienrichjam-004900"></a></h2>
<div class="section level3">
<h3 id="bug-fixed-0-0-4-900">bug fixed<a class="anchor" aria-label="anchor" href="#bug-fixed-0-0-4-900"></a></h3>
<ul><li>Fixed small issues with <code><a href="../reference/fixSetLabels.html">fixSetLabels()</a></code>.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-0-0-4-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-4-900"></a></h3>
<ul><li>Updated <code><a href="../reference/fixSetLabels.html">fixSetLabels()</a></code> to handle words the should be kept uppercase, with some defaults pre-configured, e.g. “mRNA”.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.3.900" id="multienrichjam-003900">multienrichjam 0.0.3.900<a class="anchor" aria-label="anchor" href="#multienrichjam-003900"></a></h2>
<div class="section level3">
<h3 id="changes-0-0-3-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-3-900"></a></h3>
<ul><li>removed <code><a href="https://rdrr.io/pkg/jamba/man/mergeAllXY.html" class="external-link">mergeAllXY()</a></code> and <code><a href="https://rdrr.io/pkg/jamba/man/unnestList.html" class="external-link">unnestList()</a></code> and moved them to the <code>jamba</code> package. Added corresponding version requirement on jamba.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.2.900" id="multienrichjam-002900">multienrichjam 0.0.2.900<a class="anchor" aria-label="anchor" href="#multienrichjam-002900"></a></h2>
<div class="section level3">
<h3 id="changes-0-0-2-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-2-900"></a></h3>
<ul><li>
<code><a href="../reference/fixSetLabels.html">fixSetLabels()</a></code> was updated to include a wider set of canonical pathway prefixes used in MsigDB v6.1.</li>
</ul></div>
<div class="section level3">
<h3 id="new-functions-0-0-2-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-2-900"></a></h3>
<ul><li>
<code><a href="../reference/cnet2im.html">cnet2im()</a></code> and <code><a href="../reference/cnet2df.html">cnet2df()</a></code> are helper functions used to convert a Cnet igraph to either a incidence matrix, or a table summary useful for extracting subsets of pathways using various network descriptors.</li>
<li>
<code><a href="../reference/drawEllipse.html">drawEllipse()</a></code> and <code><a href="../reference/shape.ellipse.plot.html">shape.ellipse.plot()</a></code> add an igraph vertex shape “ellipse” whose shape is controlled by vertex.ellipse.ratio, where <code>1</code> creates a circular node.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="page-header" data-toc-text="0.0.1.900" id="multienrichjam-001900">multienrichjam 0.0.1.900<a class="anchor" aria-label="anchor" href="#multienrichjam-001900"></a></h2>
<div class="section level3">
<h3 id="new-functions-0-0-1-900">new functions<a class="anchor" aria-label="anchor" href="#new-functions-0-0-1-900"></a></h3>
<ul><li>
<code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> the workhorse core function, implementing the full workflow to pre-process the results for later inspection.</li>
<li>
<code><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code> converts a data.frame into an <code>enrichResult</code> object as used in <code>clusterProfiler</code> and <code>DOSE</code>.</li>
<li>
<code><a href="../reference/cnetplotJam.html">cnetplotJam()</a></code> custom function to create a cnet plot igraph object.</li>
<li>
<code><a href="https://rdrr.io/pkg/jamba/man/mergeAllXY.html" class="external-link">mergeAllXY()</a></code> which merges a list of data.frames while keeping all rows.</li>
<li>
<code><a href="https://rdrr.io/pkg/jamba/man/unnestList.html" class="external-link">unnestList()</a></code> which un-nests a list of lists, resulting in a flattened list. It directly supports <code><a href="https://rdrr.io/pkg/jamba/man/mergeAllXY.html" class="external-link">mergeAllXY()</a></code> in order to provide a simple list of data.frame objects from potentially nested list of lists of data.frame objects.</li>
<li>
<code><a href="../reference/enrichList2IM.html">enrichList2IM()</a></code> converts a list of enrichResult objects (or data.frames) into an indidence matrix of gene rows and pathway columns.</li>
<li>
<code><a href="../reference/enrichList2df.html">enrichList2df()</a></code> combines a list of enrichResult objects (or data.frames) into a single data.frame, using the union of genes, and the best P-value.</li>
<li>
<code><a href="../reference/fixSetLabels.html">fixSetLabels()</a></code> to update pathway/gene set labels using some small set of logic.</li>
<li>
<code><a href="../reference/isColorBlank.html">isColorBlank()</a></code> checks if a color is a blank color, either by comparison to known colors, or transparency, or saturation/brightness.</li>
<li>
<code><a href="../reference/igraph2pieGraph.html">igraph2pieGraph()</a></code> converts an igraph into one with pie node shapes, optionally coloredrectangle node shapes.</li>
<li>
<code><a href="../reference/layout_with_qfrf.html">layout_with_qfrf()</a></code> is an extension to <code><a href="../reference/layout_with_qfr.html">layout_with_qfr()</a></code> that returns a function, therefore convenient to use in <code>igraph::plot()</code> with custom arguments.</li>
<li>
<code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> removes blank colors in either pie or coloredrectangle node shapes, thereby making non-blank colors easier to see in plots.</li>
<li>
<code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code> takes an igraph with Set and Gene nodeType, and subsets based upon a fixed list of Set or Gene nodes, removing singlet disconnected nodes from the output.</li>
</ul></div>
<div class="section level3">
<h3 id="changes-0-0-1-900">changes<a class="anchor" aria-label="anchor" href="#changes-0-0-1-900"></a></h3>
<ul><li>added <code>dplyr</code> to package dependencies.</li>
<li>added <code>DOSE</code> to package dependencies.</li>
</ul></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

