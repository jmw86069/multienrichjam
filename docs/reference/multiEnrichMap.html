<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prepare MultiEnrichMap data from enrichList — multiEnrichMap • multienrichjam</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare MultiEnrichMap data from enrichList — multiEnrichMap"><meta property="og:description" content="Prepare MultiEnrichMap data from enrichList"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multienrichjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.68.910</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/multienrichjam/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare MultiEnrichMap data from enrichList</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/R/jamenrich-base.r" class="external-link"><code>R/jamenrich-base.r</code></a></small>
    <div class="hidden name"><code>multiEnrichMap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare MultiEnrichMap data from enrichList</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">multiEnrichMap</span><span class="op">(</span>
  <span class="va">enrichList</span>,
  geneHitList <span class="op">=</span> <span class="cn">NULL</span>,
  geneHitIM <span class="op">=</span> <span class="cn">NULL</span>,
  colorV <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="cn">NULL</span>,
  ncol <span class="op">=</span> <span class="cn">NULL</span>,
  byrow <span class="op">=</span> <span class="cn">FALSE</span>,
  enrichLabels <span class="op">=</span> <span class="cn">NULL</span>,
  subsetSets <span class="op">=</span> <span class="cn">NULL</span>,
  overlapThreshold <span class="op">=</span> <span class="fl">0.1</span>,
  cutoffRowMinP <span class="op">=</span> <span class="fl">0.05</span>,
  enrichBaseline <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">cutoffRowMinP</span><span class="op">)</span>,
  enrichLens <span class="op">=</span> <span class="fl">0</span>,
  enrichNumLimit <span class="op">=</span> <span class="fl">4</span>,
  nEM <span class="op">=</span> <span class="fl">500</span>,
  min_count <span class="op">=</span> <span class="fl">1</span>,
  topEnrichN <span class="op">=</span> <span class="fl">20</span>,
  topEnrichSources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gs_cat"</span>, <span class="st">"gs_subat"</span><span class="op">)</span>,
  topEnrichCurateFrom <span class="op">=</span> <span class="cn">NULL</span>,
  topEnrichCurateTo <span class="op">=</span> <span class="cn">NULL</span>,
  topEnrichSourceSubset <span class="op">=</span> <span class="cn">NULL</span>,
  topEnrichDescriptionGrep <span class="op">=</span> <span class="cn">NULL</span>,
  topEnrichNameGrep <span class="op">=</span> <span class="cn">NULL</span>,
  keyColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Name"</span>, <span class="st">"pathway"</span>, <span class="st">"itemsetID"</span>, <span class="st">"Description"</span><span class="op">)</span>,
  nameColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"pathway"</span>, <span class="st">"Description"</span>, <span class="st">"itemsetID"</span>, <span class="st">"ID"</span><span class="op">)</span>,
  geneColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneID"</span>, <span class="st">"geneNames"</span>, <span class="st">"Genes"</span><span class="op">)</span>,
  countColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_count"</span>, <span class="st">"count"</span>, <span class="st">"geneHits"</span><span class="op">)</span>,
  pvalueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"padjust"</span>, <span class="st">"p.adjust"</span>, <span class="st">"adjp"</span>, <span class="st">"padj"</span>, <span class="st">"qvalue"</span>, <span class="st">"qval"</span>, <span class="st">"q.value"</span>,
    <span class="st">"pvalue"</span>, <span class="st">"p.value"</span>, <span class="st">"pval"</span>, <span class="st">"FDR"</span><span class="op">)</span>,
  descriptionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Description"</span>, <span class="st">"Name"</span>, <span class="st">"Pathway"</span>, <span class="st">"ID"</span><span class="op">)</span>,
  descriptionCurateFrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^Genes annotated by the GO term "</span><span class="op">)</span>,
  descriptionCurateTo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,
  directionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"activation.z.{0,1}score"</span>, <span class="st">"z.{0,1}score"</span><span class="op">)</span>,
  direction_cutoff <span class="op">=</span> <span class="fl">0</span>,
  pathGenes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"setSize"</span>, <span class="st">"pathGenes"</span>, <span class="st">"Count"</span><span class="op">)</span>,
  geneHits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Count"</span>, <span class="st">"geneHits"</span>, <span class="st">"gene_count"</span><span class="op">)</span>,
  geneDelim <span class="op">=</span> <span class="st">"[,/ ]+"</span>,
  GmtTname <span class="op">=</span> <span class="cn">NULL</span>,
  msigdbGmtT <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>enrichList</dt>
<dd><p><code>list</code> of <code>enrichResult</code> objects, whose
names are used in subsequent derived results.</p></dd>
<dt>geneHitList</dt>
<dd><p><code>list</code> of character vectors, or <code>NULL</code>. When
<code>NULL</code> the gene hit list for each enrichment result is inferred
from the enrichment results themselves. Therefore, if a gene
does not appear in any enrichment result, it will not be
used in this function.</p></dd>
<dt>colorV</dt>
<dd><p><code>character</code> vector of colors, length
equal to <code>length(enrichList)</code>,
used to assign specific colors to each enrichment result.</p></dd>
<dt>nrow, ncol, byrow</dt>
<dd><p>optional arguments used to customize
<code>igraph</code> node shape <code>"coloredrectangle"</code>, useful when the
number of <code>enrichList</code> results is larger than around 4. It
defines the number of columns and rows used for each node,
to display enrichment result colors, and whether to fill
colors by row when <code>byrow=TRUE</code>, or by column when <code>byrow=FALSE</code>.</p></dd>
<dt>enrichLabels</dt>
<dd><p><code>character</code> vector of enrichment labels to use,
as an optional alternative to <code>names(enrichList)</code>.</p></dd>
<dt>subsetSets</dt>
<dd><p><code>character</code> vector of optional set names to
use in the analysis, useful to analyze only a specific subset
of known pathways.</p></dd>
<dt>overlapThreshold</dt>
<dd><p><code>numeric</code> value between 0 and 1, indicating
the Jaccard overlap score above which two pathways will be linked
in the EnrichMap <code>igraph</code> network. By default, pathways whose
genes overlap more than <code>0.1</code> will be connected, which is roughly
equivalent to about a 10% overlap. Note that the Jaccard coefficient
is adversely affected when pathway sets differ in size by more than
about 5-fold.</p></dd>
<dt>cutoffRowMinP</dt>
<dd><p><code>numeric</code> value between 0 and 1, indicating the
enrichment P-value required by at least one enrichment result, to
be retained in downstream analyses. This P-value can be confirmed
in the returned list element <code>"enrichIM"</code>, which is a matrix of
P-values by pathway and enrichment.</p></dd>
<dt>enrichBaseline</dt>
<dd><p><code>numeric</code> value indicating the <code>-log10(P-value)</code>
at which colors are defined as non-blank in color gradients.
This value is typically derived from <code>cutoffRowMinP</code> to ensure
that colors are only applied when a pathway meets this significance
threshold.</p></dd>
<dt>enrichLens</dt>
<dd><p><code>numeric</code> value indicating the "lens" to apply to
color gradients, where numbers above 0 make the color ramp more
compressed, so colors are more vivid at lower numeric values.</p></dd>
<dt>enrichNumLimit</dt>
<dd><p><code>numeric</code> value indicating the <code>-log10(P-value)</code>
above which each color gradient is considered the maximum color,
useful to apply a fixed threshold for each color gradient.</p></dd>
<dt>nEM</dt>
<dd><p><code>integer</code> number, to define the maximum number of pathway
nodes to include in the EnrichMap <code>igraph</code> network. This argument
is passed to <code><a href="enrichMapJam.html">enrichMapJam()</a></code>.</p></dd>
<dt>topEnrichN</dt>
<dd><p><code>integer</code> value with the maximum rows to retain
from each <code>enrichList</code> table, by source. Set <code>topEnrichN=0</code> or
<code>topEnrichN=NULL</code> to disable subsetting for the top rows.</p></dd>
<dt>topEnrichSources, topEnrichCurateFrom, topEnrichCurateTo, topEnrichSourceSubset, topEnrichDescriptionGrep, topEnrichNameGrep</dt>
<dd><p>arguments passed to <code><a href="topEnrichBySource.html">topEnrichListBySource()</a></code> when <code>topEnrichN</code>
is greater than <code>0</code>. The default values are used only when
input data matches these patterns.</p></dd>
<dt>keyColname, nameColname, geneColname, pvalueColname, descriptionColname</dt>
<dd><p><code>character</code> vector in each case indicating the colnames
for <code>key</code>, <code>name</code>, <code>gene</code>, <code>pvalue</code>, and <code>description</code>,
respectively. Each vector is passed to <code><a href="find_colname.html">find_colname()</a></code> to find
a suitable matching colname for each <code>data.frame</code> in
<code>enrichList</code>.</p></dd>
<dt>descriptionCurateFrom, descriptionCurateTo</dt>
<dd><p><code>character</code> vectors
with patterns and replacements, passed to <code><a href="gsubs.html">gsubs()</a></code>, intended to
help curate common descriptions to shorter, perhaps more
user-friendly labels. One example is removing the prefix
<code>"Genes annotated by the GO term "</code> from Gene Ontology pathways.
These label can be manually curated later, but it is often
more convenient to curate them upfront in order to keep the
different result objects consistent.</p></dd>
<dt>pathGenes, geneHits</dt>
<dd><p><code>character</code> values indicating the colnames
that contain the number of pathway genes, and the number of gene
hits, respectively.</p></dd>
<dt>geneDelim</dt>
<dd><p><code>character</code> pattern used with <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code> to
split multiple gene values into a list of vectors. The default
for <code>enrichResult</code> objects is <code>"/"</code>, but the default for other
sources is often <code>","</code>. The default pattern <code>"[,/ ]+"</code> splits
by either <code>"/"</code>, <code>","</code>, or whitespace <code>" "</code>.</p></dd>
<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.
For <code>verbose</code> to cascade to internal functions, use <code>verbose=2</code>.</p></dd>
<dt>...</dt>
<dd><p>additional arguments are passed to various internal
functions.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>list</code> object containing various result formats:</p><ul><li><p>colorV: named vector of colors assigned to each enrichment,
where names match the names of each enrichment in <code>enrichList</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function performs most of the work of comparing multiple
enrichment results. It takes a list of <code>enrichResult</code> objects,
generates an overall pathway-gene incidence matrix, assembles
a pathway-to-Pvalue matrix, creates EnrichMap <code>igraph</code> network
objects, and CnetPlot <code>igraph</code> network objects. It also applies
node shapes and colors consistent with the colors used for
each enrichment result.</p>
<p>By default, each enrichment result table is subsetted for the
top <code>n=20</code> pathways sorted by pathway source, defined by
colnames <code>c("Source", "Category")</code>. For data without a source
column, the overall enrichment results are sorted to take the
top 20. Once the top 20 from each enrichment table are selected,
the overall set of pathways are used to retain these pathways
from all enrichment tables. In this way, a significant enrichment
result from one table will still be compared to a non-significant
result from another table.</p>
<p>The default values for <code>topEnrichN</code> and related arguments
are intended when using enrichment results from <code>MSigDB</code>,
which has colnames <code>c("Source","Category")</code> and represents
100 or more combinations of sources and categories. The
default values will select the top 20 entries from the
canonical pathways, after curating the canonical pathway
categories to one <code>"CP"</code> source value.</p>
<p>To disable the top pathway filtering, set <code>topEnrichN=0</code>.</p>
<p>Colors can be defined for each enrichment result using the
argument <code>colorV</code>, otherwise colors are assigned using
<code><a href="https://rdrr.io/pkg/colorjam/man/rainbowJam.html" class="external-link">colorjam::rainbowJam()</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam enrichment functions: 
<code><a href="topEnrichBySource.html">topEnrichBySource</a>()</code></p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## See the Vignette for a full walkthrough example</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

