<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MultiEnrichment Heatmap of Genes and Pathways — mem_gene_path_heatmap • multienrichjam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MultiEnrichment Heatmap of Genes and Pathways — mem_gene_path_heatmap"><meta name="description" content="MultiEnrichment Heatmap of Genes and Pathways"><meta property="og:description" content="MultiEnrichment Heatmap of Genes and Pathways"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multienrichjam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.100.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/jmw86069/multienrichjam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MultiEnrichment Heatmap of Genes and Pathways</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/R/jamenrich-plot.R" class="external-link"><code>R/jamenrich-plot.R</code></a></small>
      <div class="d-none name"><code>mem_gene_path_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>MultiEnrichment Heatmap of Genes and Pathways</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mem_gene_path_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">mem</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_gene_ct <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_set_ct <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_set_ct_each <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  column_fontsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_fontsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_method <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  column_method <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  enrich_im_weight <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  gene_im_weight <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  gene_annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"im"</span>, <span class="st">"direction"</span><span class="op">)</span>,</span>
<span>  annotation_suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>im <span class="op">=</span> <span class="st">"hit"</span>, direction <span class="op">=</span> <span class="st">"dir"</span><span class="op">)</span>,</span>
<span>  simple_anno_size <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_row_slices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cluster_column_slices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="va">mem</span><span class="op">$</span><span class="va">p_cutoff</span>,</span>
<span>  p_floor <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  row_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  auto_split <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  column_title <span class="op">=</span> <span class="va">LETTERS</span>,</span>
<span>  row_title <span class="op">=</span> <span class="va">letters</span>,</span>
<span>  row_title_rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colorize_by_gene <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na_col <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  rotate_heatmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colramp <span class="op">=</span> <span class="st">"Reds"</span>,</span>
<span>  column_names_max_height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">180</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  column_names_rot <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  show_gene_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_pathway_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_heatmap_legend <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mem">mem<a class="anchor" aria-label="anchor" href="#arg-mem"></a></dt>
<dd><p><code>list</code> object created by <code><a href="multiEnrichMap.html">multiEnrichMap()</a></code>. Specifically
the object is expected to contain <code>colorV</code>, <code>enrichIM</code>,
<code>memIM</code>, <code>geneIM</code>.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>character vector of genes to include in the heatmap,
all other genes will be excluded.</p></dd>


<dt id="arg-sets">sets<a class="anchor" aria-label="anchor" href="#arg-sets"></a></dt>
<dd><p>character vector of sets (pathways) to include in the heatmap,
all other sets will be excluded.</p></dd>


<dt id="arg-min-gene-ct">min_gene_ct<a class="anchor" aria-label="anchor" href="#arg-min-gene-ct"></a></dt>
<dd><p>minimum number of occurrences of each gene
across the pathways, all other genes are excluded.</p></dd>


<dt id="arg-min-set-ct">min_set_ct<a class="anchor" aria-label="anchor" href="#arg-min-set-ct"></a></dt>
<dd><p>minimum number of genes required for each set,
all other sets are excluded.</p></dd>


<dt id="arg-min-set-ct-each">min_set_ct_each<a class="anchor" aria-label="anchor" href="#arg-min-set-ct-each"></a></dt>
<dd><p>minimum number of genes required for each set,
required for at least one enrichment test.</p></dd>


<dt id="arg-column-fontsize-row-fontsize">column_fontsize, row_fontsize<a class="anchor" aria-label="anchor" href="#arg-column-fontsize-row-fontsize"></a></dt>
<dd><p><code>numeric</code>
passed as <code>fontsize</code> to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
to define a specific fontsize for column and row labels. When
<code>NULL</code> the nrow/ncol of the heatmap are used to infer a reasonable
starting point fontsize, which can be adjusted with <code>column_cex</code>
and <code>row_cex</code>.</p></dd>


<dt id="arg-row-method-column-method">row_method, column_method<a class="anchor" aria-label="anchor" href="#arg-row-method-column-method"></a></dt>
<dd><p>character string of the distance method
to use for row and column clustering. The clustering is performed
by <code><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">amap::hcluster()</a></code>.</p></dd>


<dt id="arg-enrich-im-weight">enrich_im_weight<a class="anchor" aria-label="anchor" href="#arg-enrich-im-weight"></a></dt>
<dd><p><code>numeric</code> value between 0 and 1 (default 0.3),
the relative weight of enrichment <code>-log10 P-value</code> and overall
gene-pathway incidence matrix when clustering pathways.</p><ul><li><p>When <code>enrich_im_weight=0</code> then only the gene-pathway incidence
matrix is used for pathway clustering.</p></li>
<li><p>When <code>enrich_im_weight=1</code> then only the pathway significance
(<code>-log10 P-value</code>) is used for pathway clustering.</p></li>
<li><p>The default <code>enrich_im_weight=0.3</code> balances the combination
of the enrichment P-value matrix, with the gene-pathway incidence
matrix.</p></li>
</ul></dd>


<dt id="arg-gene-im-weight">gene_im_weight<a class="anchor" aria-label="anchor" href="#arg-gene-im-weight"></a></dt>
<dd><p><code>numeric</code> value between 0 and 1 (default 0.5),
the relative weight of the <code>mem$geneIM</code> gene incidence matrix,
and overall gene-pathway incidence matrix when clustering genes.</p><ul><li><p>When <code>gene_im_weight=0</code> then only the gene-pathway incidence
matrix is used for gene clustering.</p></li>
<li><p>When <code>gene_im_weight=1</code> then only the gene incidence matrix
(<code>mem$geneIM</code>) is used for gene clustering.</p></li>
<li><p>The default <code>_im_weight=0.5</code> balances the gene incidence matrix
with the gene-pathway incidence matrix, giving each matrix equal weight
(since values are typically all <code>(0, 1)</code>.</p></li>
</ul></dd>


<dt id="arg-gene-annotations">gene_annotations<a class="anchor" aria-label="anchor" href="#arg-gene-annotations"></a></dt>
<dd><p><code>character</code> string indicating which annotation(s)
to display alongside the gene axis of the heatmap.
By default it uses <code>"im", "direction"</code>, and <code>"direction"</code> is removed
when <code>mem$geneIMdirection</code> is not available.</p><ul><li><p><code>"im"</code> displays the gene incidence matrix <code>mem$geneIM</code> using
categorical colors defined by <code>mem$colorV</code>.</p></li>
<li><p><code>"direction"</code> displays the gene directionality <code>mem$geneIMdirection</code>
using colors defined by <code>colorjam::col_div_xf(1.2)</code>.</p></li>
<li><p>When no values are given, the gene annotation is not displayed.</p></li>
<li><p>When two values are given, the annotations are displayed in the
order they are provided.</p></li>
</ul></dd>


<dt id="arg-annotation-suffix">annotation_suffix<a class="anchor" aria-label="anchor" href="#arg-annotation-suffix"></a></dt>
<dd><p><code>character</code> vector named by values permitted
by <code>gene_annotations</code>, with optional suffix to add to the annotation
labels. For example it may be helpful to add "hit" or "dir" to
distinguish the enrichment labels.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>character value passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>,
used as a label above the heatmap color legend.</p></dd>


<dt id="arg-p-cutoff">p_cutoff<a class="anchor" aria-label="anchor" href="#arg-p-cutoff"></a></dt>
<dd><p>numeric value of the enrichment P-value cutoff,
above which P-values are not colored, and are therefore white.
The enrichment P-values are displayed as an annotated heatmap
at the top of the main heatmap. Any cell that has a color meets
at least the minimum P-value threshold. This value by default
is taken from input <code>mem</code>, using <code>mem$p_cutoff</code>, for
consistency with the input multienrichment analysis.</p></dd>


<dt id="arg-column-split-row-split">column_split, row_split<a class="anchor" aria-label="anchor" href="#arg-column-split-row-split"></a></dt>
<dd><p>optional arguments passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> to split the heatmap by columns
or rows, respectively.</p><ul><li><p>when <code>row_split</code> is <code>NULL</code>
and <code>auto_split=TRUE</code>, it will determine an appropriate number
of clusters based upon the number of rows. To turn off row <code>split</code>,
use <code>row_split=NULL</code> or <code>row_split=0</code> or <code>row_split=1</code>;
likewise for <code>column_split</code>.</p></li>
<li><p>when <code>row_split</code> or <code>column_split</code> are supplied as a named
vector, the names are aligned with <code>sets</code> to be displayed
in the heatmap, and will use the <code><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect()</a></code> of the two.
When data is clustered, <code>cluster_row_slices=FALSE</code> and
<code>cluster_column_slices=FALSE</code> such that the dendrogram will
be broken into separate pieces.</p></li>
</ul></dd>


<dt id="arg-column-title">column_title<a class="anchor" aria-label="anchor" href="#arg-column-title"></a></dt>
<dd><p>optional character string with title to display
above the heatmap.</p></dd>


<dt id="arg-row-title">row_title<a class="anchor" aria-label="anchor" href="#arg-row-title"></a></dt>
<dd><p>optional character string with title to display
beside the heatmap. Note when <code>row_split</code> is defined, the
<code>row_title</code> is applied to each heatmap section.</p></dd>


<dt id="arg-row-title-rot">row_title_rot<a class="anchor" aria-label="anchor" href="#arg-row-title-rot"></a></dt>
<dd><p><code>numeric</code> value indicating the rotation of
<code>row_title</code> text, where <code>0</code> is not rotated, and <code>90</code> is rotated
90 degrees.</p></dd>


<dt id="arg-colorize-by-gene">colorize_by_gene<a class="anchor" aria-label="anchor" href="#arg-colorize-by-gene"></a></dt>
<dd><p><code>logical</code> indicating whether to color the
main heatmap body using the colors from <code>geneIM</code> which represents
each enrichment in which a given gene is involved. Colors are
blended using <code><a href="https://jmw86069.github.io/colorjam/reference/blend_colors.html" class="external-link">colorjam::blend_colors()</a></code>, using colors from
<code>mem$colorV</code>, applied to <code>mem$geneIM</code>.</p></dd>


<dt id="arg-na-col">na_col<a class="anchor" aria-label="anchor" href="#arg-na-col"></a></dt>
<dd><p><code>character</code> string indicating the color to use for
NA or missing values. Typically this argument is only used
when <code>colorize_by_gene=TRUE</code>, where entries with no color are
recognized as <code>NA</code> by <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>.</p></dd>


<dt id="arg-rotate-heatmap">rotate_heatmap<a class="anchor" aria-label="anchor" href="#arg-rotate-heatmap"></a></dt>
<dd><p><code>logical</code> indicating whether the entire heatmap
should be rotated so that pathway names are displayed as rows,
and genes as columns.
When enabled, arguments referring to columns and rows are flipped,
so "column" arguments will continue to affect pathways/sets,
and "row" arguments will continue to affect genes.
This includes <code>column_method</code> and <code>row_method</code> as of 0.0.90.900.</p><ul><li><p>Exceptions:</p></li>
<li><p><code>row_title_rot</code> is only applied to rows, due to its purpose.</p></li>
<li><p><code>column_names_rot</code> is only applied to columns, also due to
its purpose.</p></li>
</ul></dd>


<dt id="arg-colramp">colramp<a class="anchor" aria-label="anchor" href="#arg-colramp"></a></dt>
<dd><p><code>character</code> name of color, color gradient, or a
vector of colors, anything compatible with input to
<code><a href="https://jmw86069.github.io/jamba/reference/getColorRamp.html" class="external-link">jamba::getColorRamp()</a></code>.</p></dd>


<dt id="arg-column-names-max-height">column_names_max_height<a class="anchor" aria-label="anchor" href="#arg-column-names-max-height"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">grid::unit</a></code> passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>. When supplied as <code>numeric</code> it is
converted to units in "mm".</p></dd>


<dt id="arg-column-names-rot">column_names_rot<a class="anchor" aria-label="anchor" href="#arg-column-names-rot"></a></dt>
<dd><p><code>numeric</code> passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>.</p></dd>


<dt id="arg-show-gene-legend-show-pathway-legend">show_gene_legend, show_pathway_legend<a class="anchor" aria-label="anchor" href="#arg-show-gene-legend-show-pathway-legend"></a></dt>
<dd><p><code>logical</code> whether to show
the gene IM and pathway IM legends, respectively.</p><ul><li><p>The gene IM legend is <code>FALSE</code> by default, since it only describes the
color used for each column, and is somewhat redundant with the pathway
IM legend.</p></li>
<li><p>The pathway IM legend displays the color scale including the range
of enrichment P-values colorized.</p></li>
</ul></dd>


<dt id="arg-show-heatmap-legend">show_heatmap_legend<a class="anchor" aria-label="anchor" href="#arg-show-heatmap-legend"></a></dt>
<dd><p><code>numeric</code> or <code>logical</code>, (default 8)
with the maximum number of labels to use for the heatmap color legend.
The heatmap color legend includes all the
the possible blended colors based upon the gene IM data.</p><ul><li><p>When <code>logical</code>, <code>TRUE</code> is converted to <code>8</code> by default.</p></li>
<li><p>When there are more legend items than than <code>show_heatmap_legend</code>
the color legend will only display singlet colors.</p></li>
</ul></dd>


<dt id="arg-use-raster">use_raster<a class="anchor" aria-label="anchor" href="#arg-use-raster"></a></dt>
<dd><p><code>logical</code> passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>,
(default TRUE), indicating whether to rasterize the heatmap body.
If the heatmap appears too blurry, use <code>FALSE</code> which will render each
heatmap cell individually. For very large heatmaps this can create
a very large PDF file size, and may introduce visual artifacts
if the output dimensions are smaller than 1 cell per pixel.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p><code>numeric</code> value passed to <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> to define a
reproducible random seed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
for customization. However, if <code>...</code> causes an error, the same
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> function is called without <code>...</code>,
which is intended to allow overloading <code>...</code> for different
functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>Heatmap</code> object defined in <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>, with
additional attributes:</p><ul><li><p><code>"caption"</code> - a <code>character</code> string with caption that described
the data dimensions and clustering parameters.</p></li>
<li><p><code>"caption_legendlist"</code> - a <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legends.html" class="external-link">ComplexHeatmap::Legends</a></code> object suitable
to be included with Heatmap legends using
<code>draw(hm, annotation_legend_list=caption_legendlist)</code>, or
drawn with <code>grid::grid.draw(caption_legendlist)</code>.</p></li>
<li><p><code>"draw_caption"</code> - a <code>function</code> that will draw the caption in the
bottom-left corner of the heatmap by default, to be called
with <code>attr(hm, "draw_caption")()</code> or <code>draw_caption()</code>.</p></li>
</ul><p>In addition, the returned object can be interrogated with two helper
functions that help define the row and column clusters, and the
exact order of labels as they appear in the heatmap.</p><ol><li><p><code><a href="https://jmw86069.github.io/jamba/reference/heatmap_row_order.html" class="external-link">jamba::heatmap_row_order()</a></code> - returns a <code>list</code> of vectors of
rownames in the order they appear in the heatmap, with list names
defined by row split.</p></li>
<li><p><code><a href="https://jmw86069.github.io/jamba/reference/heatmap_column_order.html" class="external-link">jamba::heatmap_column_order()</a></code> - returns a <code>list</code> of vectors of
colnames in the order they appear in the heatmap, with list names
defined by row split.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function takes the <code>mem</code> list output from
<code><a href="multiEnrichMap.html">multiEnrichMap()</a></code> and creates a gene-by-pathway incidence
matrix heatmap, using <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>.
It uses three basic sources of data to annotate the heatmap:</p><ol><li><p><code>mem$memIM</code> the gene-set incidence matrix</p></li>
<li><p><code>mem$geneIM</code> the gene incidence matrix by dataset</p></li>
<li><p><code>mem$enrichIM</code> the pathway enrichment P-value matrix by dataset</p></li>
</ol><p>It will try to estimate a reasonable number of column and row
splits in the dendrogram, based solely upon the number of
columns and rows. These guesses can be controlled with argument
<code>column_split</code> and <code>row_split</code>, respectively.</p>
<p>When pathways are filtered by <code>min_gene_ct</code>, <code>min_set_ct</code>,
and <code>min_set_ct_each</code>, the order of operations is as follows:</p><ol><li><p><code>min_set_ct_each</code>, <code>min_set_ct</code> - these filters are applied
before filtering genes, in order to ensure all genes are present
from the start.</p></li>
<li><p><code>min_gene_ct</code> - genes are filtered after pathway filtering,
in order to remove pathways which were not deemed "significant"
based upon the required number of genes. Only after those pathways
are removed can the number of occurrences of each gene be judged
appropriately.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam plot functions:
<code><a href="adjust_polygon_border.html">adjust_polygon_border</a>()</code>,
<code><a href="grid_with_title.html">grid_with_title</a>()</code>,
<code><a href="jam_igraph.html">jam_igraph</a>()</code>,
<code><a href="mem_enrichment_heatmap.html">mem_enrichment_heatmap</a>()</code>,
<code><a href="mem_legend.html">mem_legend</a>()</code>,
<code><a href="mem_multienrichplot.html">mem_multienrichplot</a>()</code>,
<code><a href="mem_plot_folio.html">mem_plot_folio</a>()</code>,
<code><a href="plot_layout_scale.html">plot_layout_scale</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

