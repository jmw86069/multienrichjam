<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Subset enrichResult for top enrichment results by source — topEnrichBySource • multienrichjam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subset enrichResult for top enrichment results by source — topEnrichBySource"><meta name="description" content="Subset enrichResult for top enrichment results by source
Subset list of enrichResult for top enrichment results by source"><meta property="og:description" content="Subset enrichResult for top enrichment results by source
Subset list of enrichResult for top enrichment results by source"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multienrichjam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.100.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/jmw86069/multienrichjam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Subset enrichResult for top enrichment results by source</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/R/jamenrich-topenrich.R" class="external-link"><code>R/jamenrich-topenrich.R</code></a></small>
      <div class="d-none name"><code>topEnrichBySource.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Subset enrichResult for top enrichment results by source</p>
<p>Subset list of enrichResult for top enrichment results by source</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">topEnrichBySource</span><span class="op">(</span></span>
<span>  <span class="va">enrichDF</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  min_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sourceColnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gs_cat"</span>, <span class="st">"gs_subcat"</span><span class="op">)</span>,</span>
<span>  sortColname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  countColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_count"</span>, <span class="st">"count"</span>, <span class="st">"geneHits"</span><span class="op">)</span>,</span>
<span>  pvalueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P.Value"</span>, <span class="st">"pvalue"</span>, <span class="st">"FDR"</span>, <span class="st">"adj.P.Val"</span>, <span class="st">"qvalue"</span><span class="op">)</span>,</span>
<span>  directionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"activation.z.{0,1}score"</span>, <span class="st">"z.{0,1}score"</span><span class="op">)</span>,</span>
<span>  direction_cutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  newColname <span class="op">=</span> <span class="st">"EnrichGroup"</span>,</span>
<span>  curateFrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curateTo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sourceSubset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sourceSep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  subsetSets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  descriptionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Description"</span>, <span class="st">"Name"</span>, <span class="st">"Pathway"</span><span class="op">)</span>,</span>
<span>  nameColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Name"</span><span class="op">)</span>,</span>
<span>  descriptionGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nameGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">topEnrichListBySource</span><span class="op">(</span></span>
<span>  <span class="va">enrichList</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  min_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sourceColnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gs_cat"</span>, <span class="st">"gs_subcat"</span><span class="op">)</span>,</span>
<span>  sortColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pvalueColname</span>, <span class="st">"P-value"</span>, <span class="st">"pvalue"</span>, <span class="st">"qvalue"</span>, <span class="st">"padjust"</span>, <span class="st">"-GeneRatio"</span>,</span>
<span>    <span class="st">"-Count"</span>, <span class="st">"-geneHits"</span><span class="op">)</span>,</span>
<span>  countColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_count"</span>, <span class="st">"count"</span>, <span class="st">"geneHits"</span><span class="op">)</span>,</span>
<span>  pvalueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P.Value"</span>, <span class="st">"pvalue"</span>, <span class="st">"FDR"</span>, <span class="st">"adj.P.Val"</span>, <span class="st">"qvalue"</span><span class="op">)</span>,</span>
<span>  directionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"activation.z.{0,1}score"</span>, <span class="st">"z.{0,1}score"</span><span class="op">)</span>,</span>
<span>  direction_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  newColname <span class="op">=</span> <span class="st">"EnrichGroup"</span>,</span>
<span>  curateFrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curateTo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sourceSubset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sourceSep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  subsetSets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  descriptionColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Description"</span>, <span class="st">"Name"</span>, <span class="st">"Pathway"</span><span class="op">)</span>,</span>
<span>  nameColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Name"</span><span class="op">)</span>,</span>
<span>  descriptionGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nameGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-enrichdf">enrichDF<a class="anchor" aria-label="anchor" href="#arg-enrichdf"></a></dt>
<dd><p><code>enrichResult</code> or <code>data.frame</code> with enrichment results.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>integer</code> maximum number of pathways to retain,
after applying <code>min_count</code> and <code>p_cutoff</code> thresholds
if relevant.</p></dd>


<dt id="arg-min-count">min_count<a class="anchor" aria-label="anchor" href="#arg-min-count"></a></dt>
<dd><p><code>integer</code> minimum number of genes involved
in an enrichment result to be retained, based upon values
in <code>countColname</code>.</p></dd>


<dt id="arg-p-cutoff">p_cutoff<a class="anchor" aria-label="anchor" href="#arg-p-cutoff"></a></dt>
<dd><p><code>numeric</code> value indicating the enrichment
P-value threshold, pathways with enrichment P-value at
or below this threshold are retained, based upon values
in <code>pvalueColname</code>.</p></dd>


<dt id="arg-sourcecolnames">sourceColnames<a class="anchor" aria-label="anchor" href="#arg-sourcecolnames"></a></dt>
<dd><p><code>character</code> vector of colnames in
<code>enrichDF</code> to consider as the <code>"Source"</code>. Multiple
columns will be combined using delimiter argument
<code>sourceSep</code>. When <code>sourceColnames</code> is NULL or
contains no <code>colnames(enrichDF)</code>, then data
is considered <code>"All"</code>.</p></dd>


<dt id="arg-sortcolname">sortColname<a class="anchor" aria-label="anchor" href="#arg-sortcolname"></a></dt>
<dd><p><code>character</code> vector, default <code>NULL</code>,
indicating the colnames to sort/prioritize the enrichment
data rows. Please use <code>NULL</code>.</p><ul><li><p>Default <code>NULL</code> will use <code>pvalueColname</code> and the
reverse of <code>countColname</code>, to prioritize lowest P-value,
then highest gene count.</p></li>
<li><p>When <code>FALSE</code> it will not perform any sorting, and will
use the input data as-is.</p></li>
<li><p>When <code>character</code> vector is provided, its values must
exactly match the intended colnames, with optional
prefix <code>"-"</code> to indicate reverse sort for a particular
colname. These values are passed to <code><a href="https://jmw86069.github.io/jamba/reference/mixedSortDF.html" class="external-link">jamba::mixedSortDF()</a></code>
argument <code>byCols</code>.</p></li>
</ul></dd>


<dt id="arg-countcolname">countColname<a class="anchor" aria-label="anchor" href="#arg-countcolname"></a></dt>
<dd><p><code>character</code> vector of possible colnames
in <code>enrichDF</code> that should contain the <code>integer</code> number
of genes involved in enrichment. This vector is
passed to <code><a href="find_colname.html">find_colname()</a></code> to find an appropriate
matching colname in <code>enrichDF</code>.</p></dd>


<dt id="arg-pvaluecolname">pvalueColname<a class="anchor" aria-label="anchor" href="#arg-pvaluecolname"></a></dt>
<dd><p><code>character</code> vector of possible colnames
in <code>enrichDF</code> that should contain the enrichment P-value
used for filtering by <code>p_cutoff</code>.</p></dd>


<dt id="arg-directioncolname">directionColname<a class="anchor" aria-label="anchor" href="#arg-directioncolname"></a></dt>
<dd><p><code>character</code> vector of possible colnames
in <code>enrichDF</code> which may contain directional z-score, or
other metric used to indicate directionality. It is assumed
to be symmetric around zero, where zero indicates no
directional bias.</p></dd>


<dt id="arg-direction-cutoff">direction_cutoff<a class="anchor" aria-label="anchor" href="#arg-direction-cutoff"></a></dt>
<dd><p><code>numeric</code> threshold (default <code>0</code>) to subset
enriched sets, filtering by magnitude of the absolute value
of the <code>directionColname</code>.</p></dd>


<dt id="arg-newcolname">newColname<a class="anchor" aria-label="anchor" href="#arg-newcolname"></a></dt>
<dd><p><code>character</code> string with new column name
when <code>sourceColname</code> matches multiple colnames in <code>enrichDF</code>.
Values for each row are combined using <code><a href="https://jmw86069.github.io/jamba/reference/pasteByRow.html" class="external-link">jamba::pasteByRow()</a></code>.</p></dd>


<dt id="arg-curatefrom-curateto">curateFrom, curateTo<a class="anchor" aria-label="anchor" href="#arg-curatefrom-curateto"></a></dt>
<dd><p><code>character</code> vectors with
pattern,replacement values, passed to <code>gsubs()</code>
to allow some editing of values. The default values
convert MSigDB canonical pathways from the prefix <code>"CP:"</code>
to use <code>"CP"</code> which has the effect of combining all
canonical pathways before selecting the top <code>n</code> results.</p></dd>


<dt id="arg-sourcesubset">sourceSubset<a class="anchor" aria-label="anchor" href="#arg-sourcesubset"></a></dt>
<dd><p><code>character</code> vector with a subset of
sources to retain. If there are multiple colnames in
<code>sourceColnames</code>, then column values are combined
using <code><a href="https://jmw86069.github.io/jamba/reference/pasteByRow.html" class="external-link">jamba::pasteByRow()</a></code> and delimiter <code>sourceSep</code>,
prior to filtering.</p></dd>


<dt id="arg-sourcesep">sourceSep<a class="anchor" aria-label="anchor" href="#arg-sourcesep"></a></dt>
<dd><p><code>character</code> string used as a delimiter
when <code>sourceColnames</code> contains multiple colnames.</p></dd>


<dt id="arg-subsetsets">subsetSets<a class="anchor" aria-label="anchor" href="#arg-subsetsets"></a></dt>
<dd><p><code>character</code> optional set names to include
by exact match.</p></dd>


<dt id="arg-descriptioncolname-namecolname">descriptionColname, nameColname<a class="anchor" aria-label="anchor" href="#arg-descriptioncolname-namecolname"></a></dt>
<dd><p>character vectors
indicating the colnames to consider description and name,
as returned from <code><a href="find_colname.html">find_colname()</a></code>. These arguments are
used only when <code>descriptionGrep</code> or <code>nameGrep</code> are
supplied.</p></dd>


<dt id="arg-descriptiongrep-namegrep">descriptionGrep, nameGrep<a class="anchor" aria-label="anchor" href="#arg-descriptiongrep-namegrep"></a></dt>
<dd><p><code>character</code> vector of
regular expression patterns, intended to subset pathways
to include only those matching these patterns.
The <code>descriptionGrep</code> argument searches only <code>descriptionColname</code>.
The <code>nameGrep</code> argument searches only <code>nameColname</code>.
Note that the sets are combined with OR logic, such that
any pathways matched by <code>descriptionGrep</code> OR <code>nameGrep</code>
or <code>subsetSets</code> will be included in the output.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are ignored.</p></dd>


<dt id="arg-enrichlist">enrichList<a class="anchor" aria-label="anchor" href="#arg-enrichlist"></a></dt>
<dd><p><code>list</code> of <code>enrichDF</code> entries, each passed
to <code>topEnrichBySource()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>data.frame</code> subset up to <code>topEnrichN</code> rows, after
applying optional <code>min_count</code> and <code>p_cutoff</code> filters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function takes one <code>enrichResult</code> object, or
a <code>data.frame</code> of enrichment results, and determines the
top <code>n</code> number of pathways sorted by P-values, within
each pathway source. This function may optionally require
<code>min_count</code> genes in each pathway, and <code>p_cutoff</code> maximum
enrichment P-value, prior to taking the top <code>topEnrichN</code>
entries. The default arguments do not apply filters
to <code>min_count</code> and <code>p_cutoff</code>.</p>
<p>When the enrichment data represents pathways from multiple
sources, the filtering and sorting is applied to each source
independently. The intent is to retain the top entries from
each source, as a method of representing each source
consistently even when one source may contain many more
pathways, and importantly where the range of enrichment P-values
may be very different for each source. For example, a database
of small canonical pathways would generally provide less
statistically significant P-values than a database of
dysregulated genes from gene expression experiments, where
each set contains a large number of genes.</p>
<p>This function can optionally apply basic curation of pathway
source names, and can optionally be applied to multiple
source columns. This feature is intended for sources like
MSigDB (see http://software.broadinstitute.org/gsea/msigdb/index.jsp)
which contains columns <code>"Source"</code> and <code>"Category"</code>,
and where canonical pathways are either represented with <code>"CP"</code>
or a prefix <code>"CP:"</code>. The default parameters recognize this
case and curates all prefix <code>"CP:.*"</code> down to just <code>"CP"</code>
so that all canonical pathways are considered to be the
same source. For MSigDB there are also numerous other sources,
which are each independently filtered and sorted to the
top <code>topEnrichN</code> entries.</p>
<p>Finally, this function is useful to subset enrichment results
by name, using <code>descriptionGrep</code>, <code>nameGrep</code>, or <code>subsetSets</code>.</p>
<p><code>topEnrichListBySource()</code> extends <code>topEnrichBySource()</code> by applying
filters to each <code>enrichList</code> entry, then keeping pathways
across all <code>enrichList</code> that match the filter criteria in any
one <code>enrichList</code>. It is most useful in the context of
<code><a href="multiEnrichMap.html">multiEnrichMap()</a></code> where a pathway must meet all criteria
in at least one enrichment, and that pathway should then
be included for all enrichments for the purpose of
comparative analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam enrichment functions:
<code><a href="add_pathway_direction.html">add_pathway_direction</a>()</code>,
<code><a href="multiEnrichMap.html">multiEnrichMap</a>()</code>,
<code><a href="multienrichjam.html">multienrichjam</a>()</code></p>
<p>Other jam enrichment functions:
<code><a href="add_pathway_direction.html">add_pathway_direction</a>()</code>,
<code><a href="multiEnrichMap.html">multiEnrichMap</a>()</code>,
<code><a href="multienrichjam.html">multienrichjam</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

