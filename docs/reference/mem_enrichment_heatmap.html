<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MultiEnrichment Heatmap of enrichment P-values — mem_enrichment_heatmap • multienrichjam</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MultiEnrichment Heatmap of enrichment P-values — mem_enrichment_heatmap"><meta property="og:description" content="MultiEnrichment Heatmap of enrichment P-values"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multienrichjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.87.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/multienrichjam/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MultiEnrichment Heatmap of enrichment P-values</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/R/jamenrich-plot.R" class="external-link"><code>R/jamenrich-plot.R</code></a></small>
    <div class="hidden name"><code>mem_enrichment_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>MultiEnrichment Heatmap of enrichment P-values</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mem_enrichment_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">mem</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dotplot"</span>, <span class="st">"heatmap"</span><span class="op">)</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="va">mem</span><span class="op">$</span><span class="va">p_cutoff</span>,</span>
<span>  min_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p_floor <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  point_size_factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  point_size_max <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  point_size_min <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  row_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  column_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"-log10P"</span>,</span>
<span>  row_dend_reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row_dend_width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">30</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  row_fontsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  column_fontsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_by_column <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.axis <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lens <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cexCellnote <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  column_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_names_max_width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">30</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>  column_names_max_height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">30</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>  heatmap_legend_param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>  legend_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  apply_direction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  direction_cutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  gene_count_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  do_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mem</dt>
<dd><p><code>list</code> object created by <code><a href="multiEnrichMap.html">multiEnrichMap()</a></code>. Specifically
the object is expected to contain <code>enrichIM</code>.</p></dd>


<dt>style</dt>
<dd><p><code>character</code> string indicating the style of heatmap:
<code>"heatmap"</code> produces a regular heatmap, shaded by <code>log10(Pvalue)</code>;
<code>"dotplot"</code> produces a dotplot, where the dot size is proportional
to the number of genes. See function description for details on
how to include the point size legend beside the heatmap.
The main benefit of using "dotplot" style is that it also indicates
the relative number of genes involved in the enrichment.</p></dd>


<dt>p_cutoff</dt>
<dd><p><code>numeric</code> value of the enrichment P-value cutoff,
by default this value is obtained from <code>mem$p_cutoff</code> to be
consistent with the original <code><a href="multiEnrichMap.html">multiEnrichMap()</a></code> analysis.
P-values above <code>p_cutoff</code> are not colored, and are therefore white.
This behavior is intended to indicate pathways with P-value above
this threshold did not meet the threshold, instead of
pathways with similar P-values displaying with similar color.</p></dd>


<dt>min_count</dt>
<dd><p><code>numeric</code> number of genes required for a pathway
to be considered dysregulated.</p></dd>


<dt>p_floor</dt>
<dd><p><code>numeric</code> minimum P-value used for the color gradient.
P-values below this floor are colored with the maximum color gradient.
This value is intended to be used in cases where one enrichment
P-value is very low (e.g. 1e-36) to prevent all other P-values from
being colored pale red-white and not be noticeable.</p></dd>


<dt>point_size_factor</dt>
<dd><p><code>numeric</code> used to adjust the legend point size,
since the heatmap point size is dependent upon the number of rows,
the legend may require some manual adjustment to make sure the
legend matches the heatmap.</p></dd>


<dt>point_size_min, point_size_max</dt>
<dd><p><code>numeric</code> values which define
the minimum and maximum point sizes, effectively defining the range
permitted when <code>style="dotplot"</code>.</p></dd>


<dt>row_method</dt>
<dd><p><code>character</code> string of the distance method
to use for row and column clustering. The clustering is performed
by <code><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">amap::hcluster()</a></code>.</p></dd>


<dt>name</dt>
<dd><p><code>character</code> value passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>,
used as a label above the heatmap color legend.</p></dd>


<dt>row_dend_reorder</dt>
<dd><p><code>logical</code> indicating whether to reorder the
row dendrogram using the method described in
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>. The end result is minor reshuffling of
leaf nodes on the dendrogram based upon mean signal in each row,
which can sometimes look cleaner.</p></dd>


<dt>row_fontsize, column_fontsize</dt>
<dd><p>optional <code>numeric</code> arguments passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> to size row and column labels.</p></dd>


<dt>cluster_columns</dt>
<dd><p><code>logical</code> indicating whether to cluster heatmap
columns, by default columns are not clustered.</p></dd>


<dt>sets</dt>
<dd><p><code>character</code> vector of sets (pathways) to include in the heatmap,
all other sets will be excluded.</p></dd>


<dt>color_by_column</dt>
<dd><p><code>logical</code> indicating whether to colorize the
heatmap using <code>mem$colorV</code> as defined for each comparison. This
option is currently experimental, and produces a base R heatmap
using <code><a href="https://rdrr.io/pkg/jamba/man/imageByColors.html" class="external-link">jamba::imageByColors()</a></code>.</p></dd>


<dt>cex.axis</dt>
<dd><p><code>numeric</code> adjustment for axis labels, passed to
<code><a href="https://rdrr.io/pkg/jamba/man/imageByColors.html" class="external-link">jamba::imageByColors()</a></code> only when <code>color_by_column=TRUE</code>.</p></dd>


<dt>lens</dt>
<dd><p><code>numeric</code> value used in color gradients, defining the extent
the color gradient is enhanced in the mid-ranges (positive <code>lens</code>),
or diminished in the mid-ranges (negative <code>lens</code>). There is no
quantitative standard measure for color gradient changes, so this
option is intended to help adjust and improve the visual perception
of the current data.</p></dd>


<dt>cexCellnote</dt>
<dd><p><code>numeric</code> character expansion value used only
when <code>color_by_column=TRUE</code>, used to adjust the P-value label size
inside each heatmap cell.</p></dd>


<dt>column_title</dt>
<dd><p>optional <code>character</code> string with title to display
above the heatmap.</p></dd>


<dt>row_names_max_width, column_names_max_height, heatmap_legend_param</dt>
<dd><p>arguments passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> and provided here
for convenience.</p></dd>


<dt>top_annotation</dt>
<dd><p><code>HeatmapAnnotation</code> as produced by
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">ComplexHeatmap::HeatmapAnnotation()</a></code> or <code>NULL</code>, used to display
customized annotation at the top of the heatmap. The order of
columns must match the order of columns in the data displayed
in the heatmap.</p></dd>


<dt>use_raster</dt>
<dd><p><code>logical</code> passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
indicating whether to rasterize the heatmap output, used when
<code>style="heatmap"</code>. Rasterization is not relevant to dotplot output
since dotplot is drawn using an individual circle in each heatmap cell.</p></dd>


<dt>do_plot</dt>
<dd><p><code>logical</code> indicating whether to display the plot with
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">ComplexHeatmap::draw()</a></code> or <code><a href="https://rdrr.io/pkg/jamba/man/imageByColors.html" class="external-link">jamba::imageByColors()</a></code> as relevant.
The underlying data is returned invisibly.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
for customization.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is a lightweight wrapper to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
intended to visualize the enrichment P-values from multiple
enrichment results. The P-value threshold is used to colorize
every cell whose P-value meets the threshold, while all other
cells are therefore white.</p>
<p>The <code>style</code> argument controls whether a heatmap or dotplot is
created. When <code>style="dotplot"</code> the cells are colored as usual
but are drawn as circles sized proportional to the number of
genes involved in enrichment. Because <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
is used for this step, a separate point legend is returned
as an attribute of the heatmap object.</p>
<p>To draw the dotplot heatmap including the point legend,
use this form:</p>
<p></p><div class="sourceCode R"><pre><code><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm</span>,</span>
<span>   annotation_legend_list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm</span>, <span class="st">"annotation_legend_list"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Note that this function may be more easily applied through the
wrapper function with the format <code>mem_plot_folio(mem, do_which=1, ...)</code>.
The wrapper function <code><a href="mem_plot_folio.html">mem_plot_folio()</a></code> performs hierarchical
clustering of the underlying gene-pathway incidence matrix, which
informs the clustering of enrichment results shown
in this function <code>mem_enrichment_heatmap()</code>. Otherwise, this
function will cluster pathways using only the enrichment
P-values transformed with <code>-log10(p)</code>. Generally, the clustering
using the gene-pathway incidence matrix is more effective at
representing biologically-driven pathway clusters.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam plot functions: 
<code><a href="adjust_polygon_border.html">adjust_polygon_border</a>()</code>,
<code><a href="grid_with_title.html">grid_with_title</a>()</code>,
<code><a href="jam_igraph.html">jam_igraph</a>()</code>,
<code><a href="mem_gene_path_heatmap.html">mem_gene_path_heatmap</a>()</code>,
<code><a href="mem_legend.html">mem_legend</a>()</code>,
<code><a href="mem_multienrichplot.html">mem_multienrichplot</a>()</code>,
<code><a href="mem_plot_folio.html">mem_plot_folio</a>()</code>,
<code><a href="plot_layout_scale.html">plot_layout_scale</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

