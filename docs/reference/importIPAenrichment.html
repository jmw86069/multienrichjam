<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import Ingenuity Pathway Analysis 'IPA' results — importIPAenrichment • multienrichjam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import Ingenuity Pathway Analysis 'IPA' results — importIPAenrichment"><meta name="description" content="Import Ingenuity Pathway Analysis 'IPA' results, by default
reverting IPA symbols to input values"><meta property="og:description" content="Import Ingenuity Pathway Analysis 'IPA' results, by default
reverting IPA symbols to input values"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multienrichjam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.106.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/importClusterProfiler.html">Multienrichment with clusterProfiler</a></li>
    <li><a class="dropdown-item" href="../articles/importIPA.html">How to use Ingenuity IPA enrichment results</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Explanation</h6></li>
    <li><a class="dropdown-item" href="../articles/MemPlotConcepts.html">Mem Plot Concepts</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/jmw86069/multienrichjam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Import Ingenuity Pathway Analysis 'IPA' results</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/multienrichjam/blob/HEAD/R/jamenrich-import.R" class="external-link"><code>R/jamenrich-import.R</code></a></small>
      <div class="d-none name"><code>importIPAenrichment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import Ingenuity Pathway Analysis 'IPA' results, by default
reverting IPA symbols to input values</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">importIPAenrichment</span><span class="op">(</span></span>
<span>  <span class="va">ipaFile</span>,</span>
<span>  headerGrep <span class="op">=</span></span>
<span>    <span class="st">"(^|\t)((expr.|-log.|)p-value|Pvalue|Score($|\t)|Symbol($|\t)|Ratio($|\t)|Consistency.Score|Master.Regulator($|\t))"</span>,</span>
<span>  ipaNameGrep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pathway"</span>, <span class="st">"Regulator$"</span>, <span class="st">"Regulators"</span>, <span class="st">"Regulator"</span>, <span class="st">"Disease"</span>,</span>
<span>    <span class="st">"Toxicity"</span>, <span class="st">"Category"</span>, <span class="st">"Categories"</span>, <span class="st">"Function"</span>, <span class="st">"Symbol$"</span>, <span class="st">"^ID$"</span>,</span>
<span>    <span class="st">"My.(Lists|Pathways)"</span><span class="op">)</span>,</span>
<span>  geneGrep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Molecules in Network"</span>, <span class="st">"Target molecules"</span>, <span class="st">"Molecules"</span>, <span class="st">"Symbol"</span><span class="op">)</span>,</span>
<span>  geneCurateFrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[ ]*[(](complex|includes others)[)][ ]*"</span>, <span class="st">"^[, ]+|[, ]+$"</span><span class="op">)</span>,</span>
<span>  geneCurateTo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  signColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Expr Fold Change"</span>, <span class="st">"fold.*change"</span>, <span class="st">"log.*ratio"</span>, <span class="st">"log.*fold"</span>,</span>
<span>    <span class="st">"log.*fc"</span>, <span class="st">"lfc"</span>, <span class="st">"ratio"</span>, <span class="st">"fold"</span>, <span class="st">"fc"</span><span class="op">)</span>,</span>
<span>  signThreshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  xlsxMultiSheet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  useXlsxSheetNames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  remove_blank_colnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  convert_ipa_slash <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ipa_slash_sep <span class="op">=</span> <span class="st">":"</span>,</span>
<span>  revert_ipa_xref <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ipafile">ipaFile<a class="anchor" aria-label="anchor" href="#arg-ipafile"></a></dt>
<dd><p>one of the four input types described above:
a character vector of text file names; a character vector of
Excel <code>.xlsx</code> file names; a list of <code>data.frame</code> objects.</p></dd>


<dt id="arg-headergrep">headerGrep<a class="anchor" aria-label="anchor" href="#arg-headergrep"></a></dt>
<dd><p>regular expression pattern used to
recognize header columns found in Ingenuity IPA enrichment data.</p></dd>


<dt id="arg-ipanamegrep">ipaNameGrep<a class="anchor" aria-label="anchor" href="#arg-ipanamegrep"></a></dt>
<dd><p>vector of regular expression patterns
used to recognize the name of the enriched entity,
for example the biological pathway, or network, or
disease category, etc.</p></dd>


<dt id="arg-genegrep">geneGrep<a class="anchor" aria-label="anchor" href="#arg-genegrep"></a></dt>
<dd><p>regular expression pattern used to recognize
the column containing genes, or the molecules tested for
enrichment which were found in the enriched entity.</p></dd>


<dt id="arg-genecuratefrom-genecurateto">geneCurateFrom, geneCurateTo<a class="anchor" aria-label="anchor" href="#arg-genecuratefrom-genecurateto"></a></dt>
<dd><p>vector of patterns and
replacements, respectively, used to curate values in
the gene column. These replacement rules are used to
ensure that genes are delimited consistently, with no
leading or trailing delimiters.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>integer value indicating the method used to
import data from a text file, where: <code>method=1</code> uses
<code>data.table::read.table()</code> and the <code>textConnection</code> argument;
<code>method=2</code> uses <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_tsv()</a></code>. The motivation to use
<code>data.table::read.table()</code> is it performed better in the
presence of UTF-8 characters such as the alpha symbol.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>integer value used only when <code>ipaFile</code> is
a vector of Excel <code>.xlsx</code> files, and when the Excel
format includes multiple worksheets. This value will
extract enrichment data only from one worksheet from
each Excel file.</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>character string used when <code>ipaFile</code> is a vector
of text files, to split fields into columns. The default
will split fields by the tab character.</p></dd>


<dt id="arg-xlsxmultisheet">xlsxMultiSheet<a class="anchor" aria-label="anchor" href="#arg-xlsxmultisheet"></a></dt>
<dd><p>logical indicating whether input
Excel <code>.xlsx</code> files contain multiple worksheets.</p></dd>


<dt id="arg-usexlsxsheetnames">useXlsxSheetNames<a class="anchor" aria-label="anchor" href="#arg-usexlsxsheetnames"></a></dt>
<dd><p>logicl indicating whether to use the
Excel worksheet name for each imported enrichment table,
when importing from <code>.xlsx</code> files, and when
<code>xlsxMultiSheet=FALSE</code>. When <code>xlsxMultiSheet=TRUE</code> the
name is derived from the value matched using <code>ipaNameGrep</code>,
because in this case, there are expected to me multiple
enrichment tables in one worksheet.</p></dd>


<dt id="arg-remove-blank-colnames">remove_blank_colnames<a class="anchor" aria-label="anchor" href="#arg-remove-blank-colnames"></a></dt>
<dd><p><code>logical</code> indicating whether to drop
<code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code> where all values are contained in <code>c(NA, "")</code>.
This option may be preferable <code>remove_blank_colnames=FALSE</code>
when all values in some column like <code>zScore</code> are <code>NA</code>, but
you would still like to retain the column for consistency
with other data. We found that IPA does not report <code>zScore</code>
values when there are only 4 or fewer genes involved in
each enrichment result.</p></dd>


<dt id="arg-convert-ipa-slash">convert_ipa_slash<a class="anchor" aria-label="anchor" href="#arg-convert-ipa-slash"></a></dt>
<dd><p><code>logical</code> indicating whether to convert
IPA gene naming conventions, currently some genes are considered
one entity in the IPA system, for example <code>"HSPA1A/HSPA1B"</code> is
considered one gene, even though two Entrez gene entries
<code>"HSPA1A"</code> and <code>"HSPA1B"</code> can be represented. Regardless whether
one or both genes are provided to IPA, it considers it one
entity for the purpose of pathway enrichment hypergeometric testing.
Unfortunately, the forward slash <code>"/"</code> is also used by
<code>clusterProfiler</code> object <code>enrichResult</code> as gene delimiter, and
is hard-coded and cannot be changed. So it will automatically
consider <code>"HSPA1A/HSPA1B"</code> as two genes, causing a mismatch with
the IPA results.
When <code>convert_ipa_slash=TRUE</code> by default, it converts the
forward slash <code>"/"</code> to the value of argument <code>ipa_slash_sep</code>.</p></dd>


<dt id="arg-ipa-slash-sep">ipa_slash_sep<a class="anchor" aria-label="anchor" href="#arg-ipa-slash-sep"></a></dt>
<dd><p><code>character</code> string used as a delimited when
<code>convert_ipa_slash=TRUE</code>, used to replace genes that contain
forward slash <code>"/"</code> to use another character.</p></dd>


<dt id="arg-revert-ipa-xref">revert_ipa_xref<a class="anchor" aria-label="anchor" href="#arg-revert-ipa-xref"></a></dt>
<dd><p><code>logical</code> indicating whether to revert the
IPA gene symbols reported, which requires that the IPA data
contains a section <code>"Analysis Ready Molecules"</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether to print verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>list</code> of <code>data.frame</code> objects, where each <code>data.frame</code>
contains enrichment data for one of the Ingenuity IPA
enrichment tests.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function parses Ingenuity Pathway Analysis ('IPA')
enrichment data into a <code>list</code> of <code>data.frame</code>
objects for downstream analysis.
Each <code>data.frame</code> represents the results of one Ingenuity IPA test,
however not all sections contain gene set enrichment results.</p><div class="section">
<h3 id="batch-processing">Batch processing<a class="anchor" aria-label="anchor" href="#batch-processing"></a></h3>


<p>When importing multiple files, argument <code>ipaFile</code> can be a vector
of '.xlsx' or '.txt' files. This workflow also calls
<code><a href="IPAlist_to_hits.html">IPAlist_to_hits()</a></code> to generate a gene hit matrix, stored
as <code>attr(ipalist, "geneHitIM")</code> to use in <code><a href="multiEnrichMap.html">multiEnrichMap()</a></code>.</p>
</div>

<div class="section">
<h3 id="ipa-gene-xref-data">IPA Gene Xref Data<a class="anchor" aria-label="anchor" href="#ipa-gene-xref-data"></a></h3>


<p>By default, the argument <code>revert_ipa_xref=TRUE</code> will convert the
IPA gene symbol values back to the original identifier.
In most cases* this behavior is desirable, with caveats:</p><ul><li><p>When using platform data which
use a non-gene identifier, including microarray probesets, or
RefSeq transcript ID, or protein "UniProt" accession numbers,
it is recommended to use <code>revert_ipa_xref=FALSE</code>.
In these cases, the IPA gene symbol is expected to be
more user-friendly, and therefore more useful.</p><ul><li><p>This option would be helpful to view the IPA gene symbols
as they appear in the IPA report - even if the symbols
sometimes do not match the input row identifiers.</p></li>
</ul></li>
<li><p>It is helpful to use <code>revert_ipa_xref=TRUE</code> when the identifier
will also be used to compare to the source data, for example
if trying to make an expression heatmap of the genes involved
in enrichment results.</p><ul><li><p>This option would convert IPA gene symbol back to Affymetrix
probeset ID, for example, if the probeset ID values were
used as the primary identifier for each measurement.
The probeset ID might be convenient to align with the input
data matrix.</p></li>
<li><p>The primary reason for this option is when providing
gene symbols as input to IPA, some will be renamed to IPA
preferred gene symbols, which would therefore be difficult
to match with the gene symbols provided to IPA.</p></li>
</ul></li>
</ul><p>In any case, the output <code>list</code> should contain an entry
"Analysis Ready Molecules" with the full IPA data table used
for the analysis. This <code>data.frame</code> will also contain any
statistical columns, if provided to IPA upfront.</p>
<p>See <code><a href="IPAlist_to_hits.html">IPAlist_to_hits()</a></code> for an automated way to create a gene hit
matrix from the 'Analysis Ready Molecules' returned by IPA.</p>
</div>

<div class="section">
<h3 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a></h3>

<ol><li><p>Separate multiple IPA enrichment tables.</p></li>
<li><p>Rename colnames to be consistent, compatible with
<code><a href="enrichDF2enrichResult.html">enrichDF2enrichResult()</a></code>.</p></li>
<li><p>Revert IPA gene aliases to original user input, default but optional.</p></li>
<li><p>Generate <code>geneHitIM</code> hit matrix when processing multiple files.</p></li>
</ol></div>

<div class="section">
<h3 id="input-format">Input format<a class="anchor" aria-label="anchor" href="#input-format"></a></h3>

<ol><li><p><code>ipaFile</code> can be one or more text <code>.txt</code> files,
where the text file contains all IPA enrichment data in
tall format. This format is most common.</p></li>
<li><p><code>ipaFile</code> can be one or more Excel <code>.xlsx</code> files,
which contains all IPA enrichment data in
one tall worksheet tab.</p></li>
<li><p><code>ipaFile</code> can be one or more Excel <code>.xlsx</code> files,
where each type of IPA enrichment appears on a separate
Excel worksheet tab.</p></li>
<li><p><code>ipaFile</code> can be a list of <code>data.frame</code> objects.
This option is intended when the IPA data has already
been imported into R as separate <code>data.frame</code> objects.</p></li>
</ol></div>

<div class="section">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h3>


<p>When using <code>"Export All"</code> from 'IPA', the default text format
includes multiple enrichment tables concatenated together in one
file. Each enrichment table contains its own unique column
headers, with descriptive text in the line preceding the
column headers. This function is intended to separate the
enrichment tables into a list of <code>data.frame</code> objects, and
retain the descriptive text as names of the list.</p>
</div>

<div class="section">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a></h3>

<ul><li><p>A common error occurs when reverting IPA gene symbols
to the original user-supplied identifier, by default
<code>revert_ipa_xref=TRUE</code>.
For errors during this step, consider <code>revert_ipa_xref=FALSE</code>
which will retain the gene symbol as recognized by IPA.
The downside of this approach is that it may be more difficult
to equate to the input identifier.
In that case look at the "Analysis Ready Molecules" <code>data.frame</code>
which should contain the
user-provided values as "ID"; the IPA recognized symbol as "Name",
and optionally a column "Symbol" which is edited by multienrichjam.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam import functions:
<code><a href="IPAlist_to_hits.html">IPAlist_to_hits</a>()</code>,
<code><a href="enrichDF2enrichResult.html">enrichDF2enrichResult</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ipaFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"multienrichjam"</span>, <span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Newborns-IPA.txt"</span>, <span class="st">"OlderChildren-IPA.txt"</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">ipalist</span> <span class="op">&lt;-</span> <span class="fu">importIPAenrichment</span><span class="op">(</span><span class="va">ipaFile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

