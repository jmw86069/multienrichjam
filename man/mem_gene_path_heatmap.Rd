% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jamenrich-plot.R
\name{mem_gene_path_heatmap}
\alias{mem_gene_path_heatmap}
\title{MultiEnrichment Heatmap of Genes and Pathways}
\usage{
mem_gene_path_heatmap(
  mem,
  genes = NULL,
  sets = NULL,
  min_gene_ct = 1,
  min_set_ct = 1,
  min_set_ct_each = 4,
  column_fontsize = NULL,
  column_cex = 1,
  row_fontsize = NULL,
  row_cex = 1,
  row_method = "binary",
  column_method = "binary",
  enrich_im_weight = 0.3,
  gene_im_weight = 0.5,
  cluster_columns = NULL,
  cluster_rows = NULL,
  cluster_row_slices = TRUE,
  cluster_column_slices = TRUE,
  name = NULL,
  p_cutoff = mem$p_cutoff,
  p_floor = 1e-06,
  row_split = NULL,
  column_split = NULL,
  auto_split = TRUE,
  column_title = LETTERS,
  row_title = letters,
  row_title_rot = 0,
  colorize_by_gene = TRUE,
  na_col = "white",
  rotate_heatmap = FALSE,
  colramp = "Reds",
  column_names_max_height = grid::unit(18, "cm"),
  column_names_rot = 90,
  show_gene_legend = FALSE,
  show_pathway_legend = TRUE,
  show_heatmap_legend = 8,
  use_raster = FALSE,
  seed = 123,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{mem}{\code{list} object created by \code{multiEnrichMap()}. Specifically
the object is expected to contain \code{colorV}, \code{enrichIM},
\code{memIM}, \code{geneIM}.}

\item{genes}{character vector of genes to include in the heatmap,
all other genes will be excluded.}

\item{sets}{character vector of sets (pathways) to include in the heatmap,
all other sets will be excluded.}

\item{min_gene_ct}{minimum number of occurrences of each gene
across the pathways, all other genes are excluded.}

\item{min_set_ct}{minimum number of genes required for each set,
all other sets are excluded.}

\item{min_set_ct_each}{minimum number of genes required for each set,
required for at least one enrichment test.}

\item{column_fontsize, row_fontsize}{\code{numeric}
passed as \code{fontsize} to \code{ComplexHeatmap::Heatmap()}
to define a specific fontsize for column and row labels. When
\code{NULL} the nrow/ncol of the heatmap are used to infer a reasonable
starting point fontsize, which can be adjusted with \code{column_cex}
and \code{row_cex}.}

\item{row_method, column_method}{character string of the distance method
to use for row and column clustering. The clustering is performed
by \code{amap::hcluster()}.}

\item{enrich_im_weight}{\code{numeric} value between 0 and 1 indicating
the relative weight of enrichment \verb{-log10 P-value} and gene
incidence matrix when combined prior to clustering the columns
in the resulting heatmap. When \code{enrich_im_weight=0} then
the data is scaled using zero weight for enrichment and therefore
only uses the gene incidence matrix; when \code{enrich_im_weight=1}
the gene incidence matrix is scaled using zero weight and
therefore clustering only uses the \verb{-log10 P-value} values.}

\item{name}{character value passed to \code{ComplexHeatmap::Heatmap()},
used as a label above the heatmap color legend.}

\item{p_cutoff}{numeric value of the enrichment P-value cutoff,
above which P-values are not colored, and are therefore white.
The enrichment P-values are displayed as an annotated heatmap
at the top of the main heatmap. Any cell that has a color meets
at least the minimum P-value threshold. This value by default
is taken from input \code{mem}, using \code{mem$p_cutoff}, for
consistency with the input multienrichment analysis.}

\item{column_split, row_split}{optional arguments passed to
\code{ComplexHeatmap::Heatmap()} to split the heatmap by columns
or rows, respectively.
\itemize{
\item when \code{row_split} is \code{NULL}
and \code{auto_split=TRUE}, it will determine an appropriate number
of clusters based upon the number of rows. To turn off row \code{split},
use \code{row_split=NULL} or \code{row_split=0} or \code{row_split=1};
likewise for \code{column_split}.
\item when \code{row_split} or \code{column_split} are supplied as a named
vector, the names are aligned with \code{sets} to be displayed
in the heatmap, and will use the \code{intersect()} of the two.
When data is clustered, \code{cluster_row_slices=FALSE} and
\code{cluster_column_slices=FALSE} such that the dendrogram will
be broken into separate pieces.
}}

\item{column_title}{optional character string with title to display
above the heatmap.}

\item{row_title}{optional character string with title to display
beside the heatmap. Note when \code{row_split} is defined, the
\code{row_title} is applied to each heatmap section.}

\item{row_title_rot}{\code{numeric} value indicating the rotation of
\code{row_title} text, where \code{0} is not rotated, and \code{90} is rotated
90 degrees.}

\item{colorize_by_gene}{\code{logical} indicating whether to color the
main heatmap body using the colors from \code{geneIM} which represents
each enrichment in which a given gene is involved. Colors are
blended using \code{colorjam::blend_colors()}, using colors from
\code{mem$colorV}, applied to \code{mem$geneIM}.}

\item{na_col}{\code{character} string indicating the color to use for
NA or missing values. Typically this argument is only used
when \code{colorize_by_gene=TRUE}, where entries with no color are
recognized as \code{NA} by \code{ComplexHeatmap::Heatmap()}.}

\item{rotate_heatmap}{\code{logical} indicating whether the entire heatmap
should be rotated so that pathway names are displayed as rows,
and genes as columns. Notes on how arguments are applied to rows
and columns:
\itemize{
\item Column arguments applied to rows:
\code{column_split}, \code{column_title}, \code{cluster_columns},
\code{column_fontsize}, \code{column_cex}
are applied to rows since they refer to pathway data;
\item Row arguments applied to columns:
\code{row_split}, \code{row_title}, \code{cluster_rows}, \code{row_fontsize}, \code{row_cex}
are applied to columns since they refer to gene data;
\item Arguments applied directly to columns:
\code{column_method}, \code{column_title_rot}
are applied directly to heatmap columns since they
refer to the output heatmap options.
\item Arguments applied directly to rows:
\code{row_method}, \code{row_title_rot}
are applied directly to heatmap rows since they
refer to the output heatmap options.
}}

\item{colramp}{\code{character} name of color, color gradient, or a
vector of colors, anything compatible with input to
\code{jamba::getColorRamp()}.}

\item{seed}{\code{numeric} value passed to \code{set.seed()} to allow
reproducible results, typically with clustering operations.}

\item{verbose}{\code{logical} indicating whether to print verbose output.}

\item{...}{additional arguments are passed to \code{ComplexHeatmap::Heatmap()}
for customization. However, if \code{...} causes an error, the same
\code{ComplexHeatmap::Heatmap()} function is called without \code{...},
which is intended to allow overloading \code{...} for different
functions.}
}
\value{
\code{Heatmap} object defined in \code{ComplexHeatmap::Heatmap()}, with
two additional attributes:
\itemize{
\item \code{"caption"} - a \code{character} string with important clustering settings.
\item \code{"draw_caption"} - a \code{function} that will draw the caption in the
bottom-left corner of the heatmap, calling
\code{ComplexHeatmap::grid.textbox()}. This function should be called
with no parameters, for example:\if{html}{\out{<div class="sourceCode R">}}\preformatted{attr(hm, "draw_caption")()
}\if{html}{\out{</div>}}
}

In addition, the returned object can be interrogated with two helper
functions that help define the row and column clusters, and the
exact order of labels as they appear in the heatmap.
\enumerate{
\item \code{jamba::heatmap_row_order()} - returns a \code{list} of vectors of
rownames in the order they appear in the heatmap, with list names
defined by row split.
\item \code{jamba::heatmap_column_order()} - returns a \code{list} of vectors of
colnames in the order they appear in the heatmap, with list names
defined by row split.
}
}
\description{
MultiEnrichment Heatmap of Genes and Pathways
}
\details{
This function takes the \code{mem} list output from
\code{multiEnrichMap()} and creates a gene-by-pathway incidence
matrix heatmap, using \code{ComplexHeatmap::Heatmap()}.
It uses three basic sources of data to annotate the heatmap:
\enumerate{
\item \code{mem$memIM} the gene-set incidence matrix
\item \code{mem$geneIM} the gene incidence matrix by dataset
\item \code{mem$enrichIM} the pathway enrichment P-value matrix by dataset
}

It will try to estimate a reasonable number of column and row
splits in the dendrogram, based solely upon the number of
columns and rows. These guesses can be controlled with argument
\code{column_split} and \code{row_split}, respectively.

When pathways are filtered by \code{min_gene_ct}, \code{min_set_ct},
and \code{min_set_ct_each}, the order of operations is as follows:
\enumerate{
\item \code{min_set_ct_each}, \code{min_set_ct} - these filters are applied
before filtering genes, in order to ensure all genes are present
from the start.
\item \code{min_gene_ct} - genes are filtered after pathway filtering,
in order to remove pathways which were not deemed "significant"
based upon the required number of genes. Only after those pathways
are removed can the number of occurrences of each gene be judged
appropriately.
}
}
\seealso{
Other jam plot functions: 
\code{\link{adjust_polygon_border}()},
\code{\link{grid_with_title}()},
\code{\link{jam_igraph}()},
\code{\link{mem_enrichment_heatmap}()},
\code{\link{mem_legend}()},
\code{\link{mem_multienrichplot}()},
\code{\link{mem_plot_folio}()},
\code{\link{plot_layout_scale}()}
}
\concept{jam plot functions}
